2025-05-03 10:27:47,132 - INFO - DataFrame created with shape: (27389, 136)
2025-05-03 10:27:47,132 - INFO - Original class counts:
2025-05-03 10:27:47,136 - INFO - acs_mu_class
1    25462
2     1926
3        1
2025-05-03 10:27:47,138 - INFO - Number of fake detections (class 3): 1
2025-05-03 10:27:47,153 - INFO - After dropping fakes and mapping classes (0: Galaxy, 1: Star):
2025-05-03 10:27:47,153 - INFO - acs_mu_class
0    25462
1     1926
2025-05-03 10:27:53,065 - INFO - Starting HPO loop for groups: ['group_1', 'group_2', 'group_3', 'group_4', 'group_5', 'group_6', 'group_7']
2025-05-03 10:27:53,227 - INFO - 
============================== Running HPO for Group: group_1 ==============================
2025-05-03 10:27:53,227 - INFO - [group_1] Cleaning data...
2025-05-03 10:27:53,227 - INFO - Original dataset size: (27388, 136)
2025-05-03 10:27:53,227 - INFO - Dataset size after dropping NaNs: (27388, 11)
2025-05-03 10:27:53,227 - INFO - Value counts for target:
1 (Star): 1926
0 (Galaxy): 25462
2025-05-03 10:27:53,242 - INFO - [group_1] Splitting data (Train/Val only for HPO)...
2025-05-03 10:27:53,242 - INFO - Splitting data using 'stratified' strategy...
2025-05-03 10:27:53,242 - INFO - Target split ratios: Train=0.60, Val=0.10, Test=0.20, Cal=0.10
2025-05-03 10:27:53,242 - INFO - Train set shape: (16432, 10)
2025-05-03 10:27:53,242 - INFO - Validation set shape: (2738, 10)
2025-05-03 10:27:53,242 - INFO - Test set shape: (5478, 10)
2025-05-03 10:27:53,242 - INFO - Calibration set shape: (2740, 10)
2025-05-03 10:27:53,242 - INFO - Split lengths verification successful.
2025-05-03 10:27:53,242 - INFO - Data splitting complete.
2025-05-03 10:27:53,242 - INFO - Train target distribution:
acs_mu_class
0    0.929649
1    0.070351
Name: count, dtype: float64
2025-05-03 10:27:53,242 - INFO - Train target counts:
acs_mu_class
0    15276
1     1156
Name: count, dtype: int64
2025-05-03 10:27:53,242 - INFO - Validation target distribution:
acs_mu_class
0    0.929876
1    0.070124
Name: count, dtype: float64
2025-05-03 10:27:53,242 - INFO - Validation target counts:
acs_mu_class
0    2546
1     192
Name: count, dtype: int64
2025-05-03 10:27:53,242 - INFO - Test target distribution:
acs_mu_class
0    0.929719
1    0.070281
Name: count, dtype: float64
2025-05-03 10:27:53,242 - INFO - Test target counts:
acs_mu_class
0    5093
1     385
Name: count, dtype: int64
2025-05-03 10:27:53,242 - INFO - Calibration target distribution:
acs_mu_class
0    0.929562
1    0.070438
Name: count, dtype: float64
2025-05-03 10:27:53,242 - INFO - Calibration target counts:
acs_mu_class
0    2547
1     193
Name: count, dtype: int64
2025-05-03 10:27:53,242 - INFO - [group_1] Applying feature scaling (for SVM HPO)...
2025-05-03 10:27:53,242 - INFO - Applying StandardScaler to features...
2025-05-03 10:27:53,262 - INFO - Feature scaling complete.
2025-05-03 10:27:53,262 - INFO - --- [group_1] Running SVM HPO ---
2025-05-03 10:27:53,264 - INFO - --- [SVM] Running Hyperband HPO ---
2025-05-03 10:27:53,264 - INFO - --- Starting Hyperband HPO ---
2025-05-03 10:27:53,264 - INFO - Model: SVC
2025-05-03 10:27:53,264 - INFO - Resource Type: data_fraction
2025-05-03 10:27:53,264 - INFO - Resource Range: [0.1, 1.0]
2025-05-03 10:27:53,264 - INFO - Eta: 3
2025-05-03 10:27:53,264 - INFO - Max Brackets (s_max): 2
2025-05-03 10:27:53,264 - INFO - Approx. Budget (B): 3.00
2025-05-03 10:27:53,264 - INFO - Scoring: f1_score
2025-05-03 10:27:53,267 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=0.11
2025-05-03 10:27:53,279 - INFO -   -- Round i=0: Evaluating 9 configs with resource=0.11 --
2025-05-03 10:27:57,884 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 10:27:57,884 - INFO -   -- Round i=1: Evaluating 3 configs with resource=0.33 --
2025-05-03 10:27:59,568 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:27:59,568 - INFO -   -- Round i=2: Evaluating 1 configs with resource=1.00 --
2025-05-03 10:28:02,071 - INFO -   ** New Best Found (Score: 0.5526) at max resource ** Params: {'C': 0.0024259612444969317, 'coef0': 1.7431902751987698, 'degree': 2, 'gamma': 0.6681682093919618, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:28:02,071 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:28:02,071 - INFO -   Bracket s=2 final best score: 0.5526
2025-05-03 10:28:02,079 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=0.33
2025-05-03 10:28:02,085 - INFO -   -- Round i=0: Evaluating 3 configs with resource=0.33 --
2025-05-03 10:28:04,271 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:28:04,273 - INFO -   -- Round i=1: Evaluating 1 configs with resource=1.00 --
2025-05-03 10:28:11,271 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:28:11,271 - INFO -   Bracket s=1 final best score: 0.5248
2025-05-03 10:28:11,279 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=1.00
2025-05-03 10:28:11,284 - INFO -   -- Round i=0: Evaluating 3 configs with resource=1.00 --
2025-05-03 10:40:42,308 - INFO -   ** New Best Found (Score: 0.6391) at max resource ** Params: {'C': 0.0014475396101653174, 'coef0': 1.4521650217106972, 'degree': 5, 'gamma': 0.0005672717728733488, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:40:42,310 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:40:42,310 - INFO -   Bracket s=0 final best score: 0.6391
2025-05-03 10:40:42,313 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 10:40:42,313 - INFO - Total configurations evaluated (approx): 20
2025-05-03 10:40:42,313 - INFO - Best Overall Score (f1_score): 0.6391
2025-05-03 10:40:42,314 - INFO - Best Params: {'C': 0.0014475396101653174, 'coef0': 1.4521650217106972, 'degree': 5, 'gamma': 0.0005672717728733488, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:40:42,314 - INFO - [group_1] SVM Best Params: {'C': 0.0014475396101653174, 'coef0': 1.4521650217106972, 'degree': 5, 'gamma': 0.0005672717728733488, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.6391
2025-05-03 10:40:42,314 - INFO - --- [group_1] Running CART HPO ---
2025-05-03 10:40:42,315 - INFO - --- [CART] Running Hyperband HPO ---
2025-05-03 10:40:42,315 - INFO - --- Starting Hyperband HPO ---
2025-05-03 10:40:42,315 - INFO - Model: DecisionTreeClassifier
2025-05-03 10:40:42,315 - INFO - Resource Type: data_fraction
2025-05-03 10:40:42,315 - INFO - Resource Range: [0.1, 1.0]
2025-05-03 10:40:42,315 - INFO - Eta: 3
2025-05-03 10:40:42,315 - INFO - Max Brackets (s_max): 2
2025-05-03 10:40:42,315 - INFO - Approx. Budget (B): 3.00
2025-05-03 10:40:42,315 - INFO - Scoring: f1_score
2025-05-03 10:40:42,319 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=0.11
2025-05-03 10:40:42,324 - INFO -   -- Round i=0: Evaluating 9 configs with resource=0.11 --
2025-05-03 10:40:42,404 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 10:40:42,405 - INFO -   -- Round i=1: Evaluating 3 configs with resource=0.33 --
2025-05-03 10:40:42,439 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:40:42,446 - INFO -   -- Round i=2: Evaluating 1 configs with resource=1.00 --
2025-05-03 10:40:42,471 - INFO -   ** New Best Found (Score: 0.5967) at max resource ** Params: {'ccp_alpha': 0.08048701329482862, 'criterion': 'log_loss', 'max_depth': 18, 'max_features': None, 'min_samples_leaf': 14, 'min_samples_split': 35, 'splitter': 'random', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:40:42,472 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:40:42,472 - INFO -   Bracket s=2 final best score: 0.5967
2025-05-03 10:40:42,475 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=0.33
2025-05-03 10:40:42,482 - INFO -   -- Round i=0: Evaluating 3 configs with resource=0.33 --
2025-05-03 10:40:42,513 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:40:42,514 - INFO -   -- Round i=1: Evaluating 1 configs with resource=1.00 --
2025-05-03 10:40:42,532 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:40:42,533 - INFO -   Bracket s=1 final best score: 0.3603
2025-05-03 10:40:42,535 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=1.00
2025-05-03 10:40:42,536 - INFO -   -- Round i=0: Evaluating 3 configs with resource=1.00 --
2025-05-03 10:40:42,622 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:40:42,623 - INFO -   Bracket s=0 final best score: 0.5347
2025-05-03 10:40:42,626 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 10:40:42,626 - INFO - Total configurations evaluated (approx): 20
2025-05-03 10:40:42,626 - INFO - Best Overall Score (f1_score): 0.5967
2025-05-03 10:40:42,626 - INFO - Best Params: {'ccp_alpha': 0.08048701329482862, 'criterion': 'log_loss', 'max_depth': 18, 'max_features': None, 'min_samples_leaf': 14, 'min_samples_split': 35, 'splitter': 'random', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:40:42,626 - INFO - [group_1] CART Best Params: {'ccp_alpha': 0.08048701329482862, 'criterion': 'log_loss', 'max_depth': 18, 'max_features': None, 'min_samples_leaf': 14, 'min_samples_split': 35, 'splitter': 'random', 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.5967
2025-05-03 10:40:42,626 - INFO - --- [group_1] Running Random Forest HPO ---
2025-05-03 10:40:42,628 - INFO - --- [Random_Forest] Running Hyperband HPO ---
2025-05-03 10:40:42,628 - INFO - --- Starting Hyperband HPO ---
2025-05-03 10:40:42,628 - INFO - Model: RandomForestClassifier
2025-05-03 10:40:42,628 - INFO - Resource Type: iterations
2025-05-03 10:40:42,628 - INFO - Resource Range: [20, 300]
2025-05-03 10:40:42,628 - INFO - Eta: 3
2025-05-03 10:40:42,628 - INFO - Max Brackets (s_max): 2
2025-05-03 10:40:42,628 - INFO - Approx. Budget (B): 900.00
2025-05-03 10:40:42,628 - INFO - Scoring: f1_score
2025-05-03 10:40:42,629 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=33.33
2025-05-03 10:40:42,633 - INFO -   -- Round i=0: Evaluating 9 configs with resource=33.33 --
2025-05-03 10:40:55,530 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 10:40:55,535 - INFO -   -- Round i=1: Evaluating 3 configs with resource=100.00 --
2025-05-03 10:41:10,466 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:41:10,468 - INFO -   -- Round i=2: Evaluating 1 configs with resource=300.00 --
2025-05-03 10:41:27,438 - INFO -   ** New Best Found (Score: 0.6260) at max resource ** Params: {'bootstrap': True, 'ccp_alpha': 1.7554339785672196e-06, 'criterion': 'gini', 'max_depth': 21, 'max_features': None, 'min_samples_leaf': 12, 'min_samples_split': 30, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:41:27,439 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:41:27,439 - INFO -   Bracket s=2 final best score: 0.6260
2025-05-03 10:41:27,439 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=100.00
2025-05-03 10:41:27,447 - INFO -   -- Round i=0: Evaluating 3 configs with resource=100.00 --
2025-05-03 10:41:46,056 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:41:46,062 - INFO -   -- Round i=1: Evaluating 1 configs with resource=300.00 --
2025-05-03 10:42:04,082 - INFO -   ** New Best Found (Score: 0.6667) at max resource ** Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:42:04,084 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:42:04,084 - INFO -   Bracket s=1 final best score: 0.6667
2025-05-03 10:42:04,088 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=300.00
2025-05-03 10:42:04,092 - INFO -   -- Round i=0: Evaluating 3 configs with resource=300.00 --
2025-05-03 10:42:25,247 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:42:25,247 - INFO -   Bracket s=0 final best score: 0.6310
2025-05-03 10:42:25,251 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 10:42:25,251 - INFO - Total configurations evaluated (approx): 20
2025-05-03 10:42:25,251 - INFO - Best Overall Score (f1_score): 0.6667
2025-05-03 10:42:25,251 - INFO - Best Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:42:25,251 - INFO - [group_1] RF Best Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.6667
2025-05-03 10:42:25,251 - INFO - --- [group_1] Running XGBoost HPO ---
2025-05-03 10:42:25,254 - INFO - --- [XGBoost] Running Hyperband HPO ---
2025-05-03 10:42:25,254 - INFO - --- Starting Hyperband HPO ---
2025-05-03 10:42:25,254 - INFO - Model: XGBClassifier
2025-05-03 10:42:25,254 - INFO - Resource Type: iterations
2025-05-03 10:42:25,254 - INFO - Resource Range: [30, 500]
2025-05-03 10:42:25,254 - INFO - Eta: 3
2025-05-03 10:42:25,254 - INFO - Max Brackets (s_max): 2
2025-05-03 10:42:25,254 - INFO - Approx. Budget (B): 1500.00
2025-05-03 10:42:25,254 - INFO - Scoring: f1_score
2025-05-03 10:42:25,255 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=55.56
2025-05-03 10:42:25,263 - INFO -   -- Round i=0: Evaluating 9 configs with resource=55.56 --
2025-05-03 10:42:26,525 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 10:42:26,527 - INFO -   -- Round i=1: Evaluating 3 configs with resource=166.67 --
2025-05-03 10:42:27,473 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:42:27,473 - INFO -   -- Round i=2: Evaluating 1 configs with resource=500.00 --
2025-05-03 10:42:28,140 - INFO -   ** New Best Found (Score: 0.6605) at max resource ** Params: {'colsample_bytree': 0.9945318117251694, 'eval_metric': 'logloss', 'gamma': 0.000747225366266352, 'learning_rate': 0.18840199781437414, 'max_depth': 10, 'min_child_weight': 1.3986421814568597, 'objective': 'binary:logistic', 'reg_alpha': 0.37218805533904253, 'reg_lambda': 0.1423466853015628, 'subsample': 0.9249775685156074, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 10:42:28,140 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:42:28,140 - INFO -   Bracket s=2 final best score: 0.6605
2025-05-03 10:42:28,148 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=166.67
2025-05-03 10:42:28,153 - INFO -   -- Round i=0: Evaluating 3 configs with resource=166.67 --
2025-05-03 10:42:28,828 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:42:28,831 - INFO -   -- Round i=1: Evaluating 1 configs with resource=500.00 --
2025-05-03 10:42:29,446 - INFO -   ** New Best Found (Score: 0.6687) at max resource ** Params: {'colsample_bytree': 0.9132556652096665, 'eval_metric': 'logloss', 'gamma': 0.0018907401035942594, 'learning_rate': 0.08409252270878798, 'max_depth': 8, 'min_child_weight': 1.6359148524463065, 'objective': 'binary:logistic', 'reg_alpha': 0.01094604245722785, 'reg_lambda': 0.01873923604998429, 'subsample': 0.9307345917693841, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 10:42:29,448 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:42:29,448 - INFO -   Bracket s=1 final best score: 0.6687
2025-05-03 10:42:29,451 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=500.00
2025-05-03 10:42:29,455 - INFO -   -- Round i=0: Evaluating 3 configs with resource=500.00 --
2025-05-03 10:42:30,954 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:42:30,954 - INFO -   Bracket s=0 final best score: 0.6647
2025-05-03 10:42:30,957 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 10:42:30,957 - INFO - Total configurations evaluated (approx): 20
2025-05-03 10:42:30,957 - INFO - Best Overall Score (f1_score): 0.6687
2025-05-03 10:42:30,957 - INFO - Best Params: {'colsample_bytree': 0.9132556652096665, 'eval_metric': 'logloss', 'gamma': 0.0018907401035942594, 'learning_rate': 0.08409252270878798, 'max_depth': 8, 'min_child_weight': 1.6359148524463065, 'objective': 'binary:logistic', 'reg_alpha': 0.01094604245722785, 'reg_lambda': 0.01873923604998429, 'subsample': 0.9307345917693841, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 10:42:30,957 - INFO - [group_1] XGB Best Params: {'colsample_bytree': 0.9132556652096665, 'eval_metric': 'logloss', 'gamma': 0.0018907401035942594, 'learning_rate': 0.08409252270878798, 'max_depth': 8, 'min_child_weight': 1.6359148524463065, 'objective': 'binary:logistic', 'reg_alpha': 0.01094604245722785, 'reg_lambda': 0.01873923604998429, 'subsample': 0.9307345917693841, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}, Score: 0.6687
2025-05-03 10:42:30,957 - INFO - --- [group_1] Running LightGBM HPO ---
2025-05-03 10:42:30,958 - INFO - --- [LightGBM] Running Hyperband HPO ---
2025-05-03 10:42:30,958 - INFO - --- Starting Hyperband HPO ---
2025-05-03 10:42:30,958 - INFO - Model: LGBMClassifier
2025-05-03 10:42:30,958 - INFO - Resource Type: iterations
2025-05-03 10:42:30,958 - INFO - Resource Range: [30, 500]
2025-05-03 10:42:30,958 - INFO - Eta: 3
2025-05-03 10:42:30,958 - INFO - Max Brackets (s_max): 2
2025-05-03 10:42:30,958 - INFO - Approx. Budget (B): 1500.00
2025-05-03 10:42:30,958 - INFO - Scoring: f1_score
2025-05-03 10:42:30,964 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=55.56
2025-05-03 10:42:30,972 - INFO -   -- Round i=0: Evaluating 9 configs with resource=55.56 --
2025-05-03 10:42:31,692 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 10:42:31,692 - INFO -   -- Round i=1: Evaluating 3 configs with resource=166.67 --
2025-05-03 10:42:32,106 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:42:32,109 - INFO -   -- Round i=2: Evaluating 1 configs with resource=500.00 --
2025-05-03 10:42:32,540 - INFO -   ** New Best Found (Score: 0.6534) at max resource ** Params: {'colsample_bytree': 0.587568255527738, 'learning_rate': 0.04025491647638509, 'max_depth': 10, 'metric': 'logloss', 'min_child_samples': 59, 'num_leaves': 115, 'objective': 'binary', 'reg_alpha': 0.04521012452572427, 'reg_lambda': 0.07784122133813023, 'subsample': 0.7102534887199938, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 10:42:32,547 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:42:32,547 - INFO -   Bracket s=2 final best score: 0.6534
2025-05-03 10:42:32,552 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=166.67
2025-05-03 10:42:32,557 - INFO -   -- Round i=0: Evaluating 3 configs with resource=166.67 --
2025-05-03 10:42:33,109 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:42:33,111 - INFO -   -- Round i=1: Evaluating 1 configs with resource=500.00 --
2025-05-03 10:42:33,849 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:42:33,850 - INFO -   Bracket s=1 final best score: 0.6498
2025-05-03 10:42:33,854 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=500.00
2025-05-03 10:42:33,855 - INFO -   -- Round i=0: Evaluating 3 configs with resource=500.00 --
2025-05-03 10:42:34,647 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:42:34,647 - INFO -   Bracket s=0 final best score: 0.6528
2025-05-03 10:42:34,650 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 10:42:34,650 - INFO - Total configurations evaluated (approx): 20
2025-05-03 10:42:34,650 - INFO - Best Overall Score (f1_score): 0.6534
2025-05-03 10:42:34,650 - INFO - Best Params: {'colsample_bytree': 0.587568255527738, 'learning_rate': 0.04025491647638509, 'max_depth': 10, 'metric': 'logloss', 'min_child_samples': 59, 'num_leaves': 115, 'objective': 'binary', 'reg_alpha': 0.04521012452572427, 'reg_lambda': 0.07784122133813023, 'subsample': 0.7102534887199938, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 10:42:34,651 - INFO - [group_1] LGBM Best Params: {'colsample_bytree': 0.587568255527738, 'learning_rate': 0.04025491647638509, 'max_depth': 10, 'metric': 'logloss', 'min_child_samples': 59, 'num_leaves': 115, 'objective': 'binary', 'reg_alpha': 0.04521012452572427, 'reg_lambda': 0.07784122133813023, 'subsample': 0.7102534887199938, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}, Score: 0.6534
2025-05-03 10:42:34,652 - INFO - [group_1] Successfully saved best parameters to best_params\group_1_best_params.json
2025-05-03 10:42:34,652 - INFO - --- Finished HPO for Group: group_1 in 881.42 seconds ---
2025-05-03 10:42:34,653 - INFO - 
============================== Running HPO for Group: group_2 ==============================
2025-05-03 10:42:34,653 - INFO - [group_2] Cleaning data...
2025-05-03 10:42:34,653 - INFO - Original dataset size: (27388, 136)
2025-05-03 10:42:34,655 - INFO - Dataset size after dropping NaNs: (27388, 25)
2025-05-03 10:42:34,661 - INFO - Value counts for target:
1 (Star): 1926
0 (Galaxy): 25462
2025-05-03 10:42:34,662 - INFO - [group_2] Splitting data (Train/Val only for HPO)...
2025-05-03 10:42:34,662 - INFO - Splitting data using 'stratified' strategy...
2025-05-03 10:42:34,663 - INFO - Target split ratios: Train=0.60, Val=0.10, Test=0.20, Cal=0.10
2025-05-03 10:42:34,674 - INFO - Train set shape: (16432, 24)
2025-05-03 10:42:34,679 - INFO - Validation set shape: (2738, 24)
2025-05-03 10:42:34,682 - INFO - Test set shape: (5478, 24)
2025-05-03 10:42:34,682 - INFO - Calibration set shape: (2740, 24)
2025-05-03 10:42:34,683 - INFO - Split lengths verification successful.
2025-05-03 10:42:34,683 - INFO - Data splitting complete.
2025-05-03 10:42:34,684 - INFO - Train target distribution:
acs_mu_class
0    0.929649
1    0.070351
Name: count, dtype: float64
2025-05-03 10:42:34,684 - INFO - Train target counts:
acs_mu_class
0    15276
1     1156
Name: count, dtype: int64
2025-05-03 10:42:34,685 - INFO - Validation target distribution:
acs_mu_class
0    0.929876
1    0.070124
Name: count, dtype: float64
2025-05-03 10:42:34,685 - INFO - Validation target counts:
acs_mu_class
0    2546
1     192
Name: count, dtype: int64
2025-05-03 10:42:34,686 - INFO - Test target distribution:
acs_mu_class
0    0.929719
1    0.070281
Name: count, dtype: float64
2025-05-03 10:42:34,686 - INFO - Test target counts:
acs_mu_class
0    5093
1     385
Name: count, dtype: int64
2025-05-03 10:42:34,686 - INFO - Calibration target distribution:
acs_mu_class
0    0.929562
1    0.070438
Name: count, dtype: float64
2025-05-03 10:42:34,686 - INFO - Calibration target counts:
acs_mu_class
0    2547
1     193
Name: count, dtype: int64
2025-05-03 10:42:34,687 - INFO - [group_2] Applying feature scaling (for SVM HPO)...
2025-05-03 10:42:34,688 - INFO - Applying StandardScaler to features...
2025-05-03 10:42:34,693 - INFO - Feature scaling complete.
2025-05-03 10:42:34,693 - INFO - --- [group_2] Running SVM HPO ---
2025-05-03 10:42:34,695 - INFO - --- [SVM] Running Hyperband HPO ---
2025-05-03 10:42:34,695 - INFO - --- Starting Hyperband HPO ---
2025-05-03 10:42:34,695 - INFO - Model: SVC
2025-05-03 10:42:34,695 - INFO - Resource Type: data_fraction
2025-05-03 10:42:34,696 - INFO - Resource Range: [0.1, 1.0]
2025-05-03 10:42:34,696 - INFO - Eta: 3
2025-05-03 10:42:34,696 - INFO - Max Brackets (s_max): 2
2025-05-03 10:42:34,696 - INFO - Approx. Budget (B): 3.00
2025-05-03 10:42:34,696 - INFO - Scoring: f1_score
2025-05-03 10:42:34,700 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=0.11
2025-05-03 10:42:34,706 - INFO -   -- Round i=0: Evaluating 9 configs with resource=0.11 --
2025-05-03 10:42:43,207 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 10:42:43,210 - INFO -   -- Round i=1: Evaluating 3 configs with resource=0.33 --
2025-05-03 10:42:45,697 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:42:45,697 - INFO -   -- Round i=2: Evaluating 1 configs with resource=1.00 --
2025-05-03 10:42:49,402 - INFO -   ** New Best Found (Score: 0.2950) at max resource ** Params: {'C': 0.0024259612444969317, 'coef0': 1.7431902751987698, 'degree': 2, 'gamma': 0.6681682093919618, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:42:49,403 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:42:49,404 - INFO -   Bracket s=2 final best score: 0.2950
2025-05-03 10:42:49,409 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=0.33
2025-05-03 10:42:49,416 - INFO -   -- Round i=0: Evaluating 3 configs with resource=0.33 --
2025-05-03 10:42:52,412 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:42:52,412 - INFO -   -- Round i=1: Evaluating 1 configs with resource=1.00 --
2025-05-03 10:43:08,696 - INFO -   ** New Best Found (Score: 0.4418) at max resource ** Params: {'C': 72.00503817038027, 'coef0': 1.2536223012228445, 'degree': 2, 'gamma': 0.03461859944484052, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:43:08,696 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:43:08,696 - INFO -   Bracket s=1 final best score: 0.4418
2025-05-03 10:43:08,703 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=1.00
2025-05-03 10:43:08,708 - INFO -   -- Round i=0: Evaluating 3 configs with resource=1.00 --
2025-05-03 10:48:59,720 - INFO -   ** New Best Found (Score: 0.4832) at max resource ** Params: {'C': 0.03097852707196491, 'coef0': 0.3499262631523865, 'degree': 4, 'gamma': 2.7850890691622254, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:48:59,722 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:48:59,722 - INFO -   Bracket s=0 final best score: 0.4832
2025-05-03 10:48:59,726 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 10:48:59,726 - INFO - Total configurations evaluated (approx): 20
2025-05-03 10:48:59,726 - INFO - Best Overall Score (f1_score): 0.4832
2025-05-03 10:48:59,726 - INFO - Best Params: {'C': 0.03097852707196491, 'coef0': 0.3499262631523865, 'degree': 4, 'gamma': 2.7850890691622254, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:48:59,726 - INFO - [group_2] SVM Best Params: {'C': 0.03097852707196491, 'coef0': 0.3499262631523865, 'degree': 4, 'gamma': 2.7850890691622254, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.4832
2025-05-03 10:48:59,726 - INFO - --- [group_2] Running CART HPO ---
2025-05-03 10:48:59,727 - INFO - --- [CART] Running Hyperband HPO ---
2025-05-03 10:48:59,727 - INFO - --- Starting Hyperband HPO ---
2025-05-03 10:48:59,727 - INFO - Model: DecisionTreeClassifier
2025-05-03 10:48:59,727 - INFO - Resource Type: data_fraction
2025-05-03 10:48:59,727 - INFO - Resource Range: [0.1, 1.0]
2025-05-03 10:48:59,727 - INFO - Eta: 3
2025-05-03 10:48:59,727 - INFO - Max Brackets (s_max): 2
2025-05-03 10:48:59,727 - INFO - Approx. Budget (B): 3.00
2025-05-03 10:48:59,727 - INFO - Scoring: f1_score
2025-05-03 10:48:59,727 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=0.11
2025-05-03 10:48:59,734 - INFO -   -- Round i=0: Evaluating 9 configs with resource=0.11 --
2025-05-03 10:48:59,816 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 10:48:59,817 - INFO -   -- Round i=1: Evaluating 3 configs with resource=0.33 --
2025-05-03 10:48:59,872 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:48:59,872 - INFO -   -- Round i=2: Evaluating 1 configs with resource=1.00 --
2025-05-03 10:48:59,914 - INFO -   ** New Best Found (Score: 0.3346) at max resource ** Params: {'ccp_alpha': 1.685787245621472e-05, 'criterion': 'entropy', 'max_depth': 38, 'max_features': None, 'min_samples_leaf': 5, 'min_samples_split': 31, 'splitter': 'random', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:48:59,914 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:48:59,914 - INFO -   Bracket s=2 final best score: 0.3346
2025-05-03 10:48:59,923 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=0.33
2025-05-03 10:48:59,927 - INFO -   -- Round i=0: Evaluating 3 configs with resource=0.33 --
2025-05-03 10:48:59,966 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:48:59,967 - INFO -   -- Round i=1: Evaluating 1 configs with resource=1.00 --
2025-05-03 10:48:59,995 - INFO -   ** New Best Found (Score: 0.3653) at max resource ** Params: {'ccp_alpha': 3.2185620345457748e-06, 'criterion': 'log_loss', 'max_depth': 31, 'max_features': None, 'min_samples_leaf': 7, 'min_samples_split': 22, 'splitter': 'random', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:48:59,997 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:48:59,997 - INFO -   Bracket s=1 final best score: 0.3653
2025-05-03 10:48:59,999 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=1.00
2025-05-03 10:48:59,999 - INFO -   -- Round i=0: Evaluating 3 configs with resource=1.00 --
2025-05-03 10:49:00,181 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:49:00,181 - INFO -   Bracket s=0 final best score: 0.3493
2025-05-03 10:49:00,190 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 10:49:00,190 - INFO - Total configurations evaluated (approx): 20
2025-05-03 10:49:00,190 - INFO - Best Overall Score (f1_score): 0.3653
2025-05-03 10:49:00,191 - INFO - Best Params: {'ccp_alpha': 3.2185620345457748e-06, 'criterion': 'log_loss', 'max_depth': 31, 'max_features': None, 'min_samples_leaf': 7, 'min_samples_split': 22, 'splitter': 'random', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:49:00,191 - INFO - [group_2] CART Best Params: {'ccp_alpha': 3.2185620345457748e-06, 'criterion': 'log_loss', 'max_depth': 31, 'max_features': None, 'min_samples_leaf': 7, 'min_samples_split': 22, 'splitter': 'random', 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.3653
2025-05-03 10:49:00,191 - INFO - --- [group_2] Running Random Forest HPO ---
2025-05-03 10:49:00,193 - INFO - --- [Random_Forest] Running Hyperband HPO ---
2025-05-03 10:49:00,193 - INFO - --- Starting Hyperband HPO ---
2025-05-03 10:49:00,193 - INFO - Model: RandomForestClassifier
2025-05-03 10:49:00,193 - INFO - Resource Type: iterations
2025-05-03 10:49:00,193 - INFO - Resource Range: [20, 300]
2025-05-03 10:49:00,194 - INFO - Eta: 3
2025-05-03 10:49:00,194 - INFO - Max Brackets (s_max): 2
2025-05-03 10:49:00,194 - INFO - Approx. Budget (B): 900.00
2025-05-03 10:49:00,194 - INFO - Scoring: f1_score
2025-05-03 10:49:00,198 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=33.33
2025-05-03 10:49:00,206 - INFO -   -- Round i=0: Evaluating 9 configs with resource=33.33 --
2025-05-03 10:49:33,835 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 10:49:33,835 - INFO -   -- Round i=1: Evaluating 3 configs with resource=100.00 --
2025-05-03 10:50:22,029 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:50:22,034 - INFO -   -- Round i=2: Evaluating 1 configs with resource=300.00 --
2025-05-03 10:51:09,968 - INFO -   ** New Best Found (Score: 0.6177) at max resource ** Params: {'bootstrap': True, 'ccp_alpha': 1.7554339785672196e-06, 'criterion': 'gini', 'max_depth': 21, 'max_features': None, 'min_samples_leaf': 12, 'min_samples_split': 30, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:51:09,970 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:51:09,970 - INFO -   Bracket s=2 final best score: 0.6177
2025-05-03 10:51:09,972 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=100.00
2025-05-03 10:51:09,972 - INFO -   -- Round i=0: Evaluating 3 configs with resource=100.00 --
2025-05-03 10:52:02,235 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:52:02,237 - INFO -   -- Round i=1: Evaluating 1 configs with resource=300.00 --
2025-05-03 10:52:51,944 - INFO -   ** New Best Found (Score: 0.6433) at max resource ** Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:52:51,946 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:52:51,946 - INFO -   Bracket s=1 final best score: 0.6433
2025-05-03 10:52:51,950 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=300.00
2025-05-03 10:52:51,952 - INFO -   -- Round i=0: Evaluating 3 configs with resource=300.00 --
2025-05-03 10:53:25,716 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:53:25,716 - INFO -   Bracket s=0 final best score: 0.5947
2025-05-03 10:53:25,724 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 10:53:25,724 - INFO - Total configurations evaluated (approx): 20
2025-05-03 10:53:25,724 - INFO - Best Overall Score (f1_score): 0.6433
2025-05-03 10:53:25,725 - INFO - Best Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:53:25,725 - INFO - [group_2] RF Best Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.6433
2025-05-03 10:53:25,725 - INFO - --- [group_2] Running XGBoost HPO ---
2025-05-03 10:53:25,728 - INFO - --- [XGBoost] Running Hyperband HPO ---
2025-05-03 10:53:25,728 - INFO - --- Starting Hyperband HPO ---
2025-05-03 10:53:25,728 - INFO - Model: XGBClassifier
2025-05-03 10:53:25,728 - INFO - Resource Type: iterations
2025-05-03 10:53:25,728 - INFO - Resource Range: [30, 500]
2025-05-03 10:53:25,728 - INFO - Eta: 3
2025-05-03 10:53:25,728 - INFO - Max Brackets (s_max): 2
2025-05-03 10:53:25,728 - INFO - Approx. Budget (B): 1500.00
2025-05-03 10:53:25,728 - INFO - Scoring: f1_score
2025-05-03 10:53:25,730 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=55.56
2025-05-03 10:53:25,738 - INFO -   -- Round i=0: Evaluating 9 configs with resource=55.56 --
2025-05-03 10:53:27,365 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 10:53:27,368 - INFO -   -- Round i=1: Evaluating 3 configs with resource=166.67 --
2025-05-03 10:53:29,152 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:53:29,152 - INFO -   -- Round i=2: Evaluating 1 configs with resource=500.00 --
2025-05-03 10:53:30,188 - INFO -   ** New Best Found (Score: 0.7083) at max resource ** Params: {'colsample_bytree': 0.9945318117251694, 'eval_metric': 'logloss', 'gamma': 0.000747225366266352, 'learning_rate': 0.18840199781437414, 'max_depth': 10, 'min_child_weight': 1.3986421814568597, 'objective': 'binary:logistic', 'reg_alpha': 0.37218805533904253, 'reg_lambda': 0.1423466853015628, 'subsample': 0.9249775685156074, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 10:53:30,189 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:53:30,190 - INFO -   Bracket s=2 final best score: 0.7083
2025-05-03 10:53:30,193 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=166.67
2025-05-03 10:53:30,202 - INFO -   -- Round i=0: Evaluating 3 configs with resource=166.67 --
2025-05-03 10:53:31,346 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:53:31,348 - INFO -   -- Round i=1: Evaluating 1 configs with resource=500.00 --
2025-05-03 10:53:32,296 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:53:32,296 - INFO -   Bracket s=1 final best score: 0.7048
2025-05-03 10:53:32,297 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=500.00
2025-05-03 10:53:32,305 - INFO -   -- Round i=0: Evaluating 3 configs with resource=500.00 --
2025-05-03 10:53:34,715 - INFO -   ** New Best Found (Score: 0.7122) at max resource ** Params: {'colsample_bytree': 0.9399063351767167, 'eval_metric': 'logloss', 'gamma': 0.0001335978952467058, 'learning_rate': 0.0760037620756919, 'max_depth': 10, 'min_child_weight': 1.624776257487987, 'objective': 'binary:logistic', 'reg_alpha': 0.00024991242947225575, 'reg_lambda': 0.02544659616528781, 'subsample': 0.5818175813025477, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 10:53:34,721 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:53:34,721 - INFO -   Bracket s=0 final best score: 0.7122
2025-05-03 10:53:34,724 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 10:53:34,724 - INFO - Total configurations evaluated (approx): 20
2025-05-03 10:53:34,724 - INFO - Best Overall Score (f1_score): 0.7122
2025-05-03 10:53:34,725 - INFO - Best Params: {'colsample_bytree': 0.9399063351767167, 'eval_metric': 'logloss', 'gamma': 0.0001335978952467058, 'learning_rate': 0.0760037620756919, 'max_depth': 10, 'min_child_weight': 1.624776257487987, 'objective': 'binary:logistic', 'reg_alpha': 0.00024991242947225575, 'reg_lambda': 0.02544659616528781, 'subsample': 0.5818175813025477, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 10:53:34,725 - INFO - [group_2] XGB Best Params: {'colsample_bytree': 0.9399063351767167, 'eval_metric': 'logloss', 'gamma': 0.0001335978952467058, 'learning_rate': 0.0760037620756919, 'max_depth': 10, 'min_child_weight': 1.624776257487987, 'objective': 'binary:logistic', 'reg_alpha': 0.00024991242947225575, 'reg_lambda': 0.02544659616528781, 'subsample': 0.5818175813025477, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}, Score: 0.7122
2025-05-03 10:53:34,725 - INFO - --- [group_2] Running LightGBM HPO ---
2025-05-03 10:53:34,728 - INFO - --- [LightGBM] Running Hyperband HPO ---
2025-05-03 10:53:34,728 - INFO - --- Starting Hyperband HPO ---
2025-05-03 10:53:34,728 - INFO - Model: LGBMClassifier
2025-05-03 10:53:34,728 - INFO - Resource Type: iterations
2025-05-03 10:53:34,728 - INFO - Resource Range: [30, 500]
2025-05-03 10:53:34,728 - INFO - Eta: 3
2025-05-03 10:53:34,728 - INFO - Max Brackets (s_max): 2
2025-05-03 10:53:34,728 - INFO - Approx. Budget (B): 1500.00
2025-05-03 10:53:34,728 - INFO - Scoring: f1_score
2025-05-03 10:53:34,728 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=55.56
2025-05-03 10:53:34,739 - INFO -   -- Round i=0: Evaluating 9 configs with resource=55.56 --
2025-05-03 10:53:35,493 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 10:53:35,497 - INFO -   -- Round i=1: Evaluating 3 configs with resource=166.67 --
2025-05-03 10:53:36,037 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:53:36,037 - INFO -   -- Round i=2: Evaluating 1 configs with resource=500.00 --
2025-05-03 10:53:36,473 - INFO -   ** New Best Found (Score: 0.6923) at max resource ** Params: {'colsample_bytree': 0.587568255527738, 'learning_rate': 0.04025491647638509, 'max_depth': 10, 'metric': 'logloss', 'min_child_samples': 59, 'num_leaves': 115, 'objective': 'binary', 'reg_alpha': 0.04521012452572427, 'reg_lambda': 0.07784122133813023, 'subsample': 0.7102534887199938, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 10:53:36,576 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:53:36,576 - INFO -   Bracket s=2 final best score: 0.6923
2025-05-03 10:53:36,582 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=166.67
2025-05-03 10:53:36,582 - INFO -   -- Round i=0: Evaluating 3 configs with resource=166.67 --
2025-05-03 10:53:37,229 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:53:37,231 - INFO -   -- Round i=1: Evaluating 1 configs with resource=500.00 --
2025-05-03 10:53:37,947 - INFO -   ** New Best Found (Score: 0.6930) at max resource ** Params: {'colsample_bytree': 0.9039964094408228, 'learning_rate': 0.0797677538429512, 'max_depth': 11, 'metric': 'logloss', 'min_child_samples': 13, 'num_leaves': 127, 'objective': 'binary', 'reg_alpha': 0.012938744945205824, 'reg_lambda': 0.03825756838214059, 'subsample': 0.7039257128340015, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 10:53:37,949 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:53:37,949 - INFO -   Bracket s=1 final best score: 0.6930
2025-05-03 10:53:37,954 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=500.00
2025-05-03 10:53:37,960 - INFO -   -- Round i=0: Evaluating 3 configs with resource=500.00 --
2025-05-03 10:53:38,857 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:53:38,857 - INFO -   Bracket s=0 final best score: 0.6879
2025-05-03 10:53:38,862 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 10:53:38,862 - INFO - Total configurations evaluated (approx): 20
2025-05-03 10:53:38,862 - INFO - Best Overall Score (f1_score): 0.6930
2025-05-03 10:53:38,862 - INFO - Best Params: {'colsample_bytree': 0.9039964094408228, 'learning_rate': 0.0797677538429512, 'max_depth': 11, 'metric': 'logloss', 'min_child_samples': 13, 'num_leaves': 127, 'objective': 'binary', 'reg_alpha': 0.012938744945205824, 'reg_lambda': 0.03825756838214059, 'subsample': 0.7039257128340015, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 10:53:38,862 - INFO - [group_2] LGBM Best Params: {'colsample_bytree': 0.9039964094408228, 'learning_rate': 0.0797677538429512, 'max_depth': 11, 'metric': 'logloss', 'min_child_samples': 13, 'num_leaves': 127, 'objective': 'binary', 'reg_alpha': 0.012938744945205824, 'reg_lambda': 0.03825756838214059, 'subsample': 0.7039257128340015, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}, Score: 0.6930
2025-05-03 10:53:38,863 - INFO - [group_2] Successfully saved best parameters to best_params\group_2_best_params.json
2025-05-03 10:53:38,863 - INFO - --- Finished HPO for Group: group_2 in 664.21 seconds ---
2025-05-03 10:53:38,864 - INFO - 
============================== Running HPO for Group: group_3 ==============================
2025-05-03 10:53:38,864 - INFO - [group_3] Cleaning data...
2025-05-03 10:53:38,864 - INFO - Original dataset size: (27388, 136)
2025-05-03 10:53:38,876 - INFO - Dataset size after dropping NaNs: (27388, 49)
2025-05-03 10:53:38,877 - INFO - Value counts for target:
1 (Star): 1926
0 (Galaxy): 25462
2025-05-03 10:53:38,882 - INFO - [group_3] Splitting data (Train/Val only for HPO)...
2025-05-03 10:53:38,882 - INFO - Splitting data using 'stratified' strategy...
2025-05-03 10:53:38,883 - INFO - Target split ratios: Train=0.60, Val=0.10, Test=0.20, Cal=0.10
2025-05-03 10:53:38,897 - INFO - Train set shape: (16432, 48)
2025-05-03 10:53:38,903 - INFO - Validation set shape: (2738, 48)
2025-05-03 10:53:38,907 - INFO - Test set shape: (5478, 48)
2025-05-03 10:53:38,907 - INFO - Calibration set shape: (2740, 48)
2025-05-03 10:53:38,907 - INFO - Split lengths verification successful.
2025-05-03 10:53:38,907 - INFO - Data splitting complete.
2025-05-03 10:53:38,909 - INFO - Train target distribution:
acs_mu_class
0    0.929649
1    0.070351
Name: count, dtype: float64
2025-05-03 10:53:38,909 - INFO - Train target counts:
acs_mu_class
0    15276
1     1156
Name: count, dtype: int64
2025-05-03 10:53:38,909 - INFO - Validation target distribution:
acs_mu_class
0    0.929876
1    0.070124
Name: count, dtype: float64
2025-05-03 10:53:38,910 - INFO - Validation target counts:
acs_mu_class
0    2546
1     192
Name: count, dtype: int64
2025-05-03 10:53:38,910 - INFO - Test target distribution:
acs_mu_class
0    0.929719
1    0.070281
Name: count, dtype: float64
2025-05-03 10:53:38,910 - INFO - Test target counts:
acs_mu_class
0    5093
1     385
Name: count, dtype: int64
2025-05-03 10:53:38,911 - INFO - Calibration target distribution:
acs_mu_class
0    0.929562
1    0.070438
Name: count, dtype: float64
2025-05-03 10:53:38,911 - INFO - Calibration target counts:
acs_mu_class
0    2547
1     193
Name: count, dtype: int64
2025-05-03 10:53:38,912 - INFO - [group_3] Applying feature scaling (for SVM HPO)...
2025-05-03 10:53:38,912 - INFO - Applying StandardScaler to features...
2025-05-03 10:53:38,924 - INFO - Feature scaling complete.
2025-05-03 10:53:38,924 - INFO - --- [group_3] Running SVM HPO ---
2025-05-03 10:53:38,925 - INFO - --- [SVM] Running Hyperband HPO ---
2025-05-03 10:53:38,926 - INFO - --- Starting Hyperband HPO ---
2025-05-03 10:53:38,926 - INFO - Model: SVC
2025-05-03 10:53:38,926 - INFO - Resource Type: data_fraction
2025-05-03 10:53:38,926 - INFO - Resource Range: [0.1, 1.0]
2025-05-03 10:53:38,926 - INFO - Eta: 3
2025-05-03 10:53:38,926 - INFO - Max Brackets (s_max): 2
2025-05-03 10:53:38,926 - INFO - Approx. Budget (B): 3.00
2025-05-03 10:53:38,926 - INFO - Scoring: f1_score
2025-05-03 10:53:38,930 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=0.11
2025-05-03 10:53:38,935 - INFO -   -- Round i=0: Evaluating 9 configs with resource=0.11 --
2025-05-03 10:54:04,442 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 10:54:04,446 - INFO -   -- Round i=1: Evaluating 3 configs with resource=0.33 --
2025-05-03 10:56:01,786 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:56:01,789 - INFO -   -- Round i=2: Evaluating 1 configs with resource=1.00 --
2025-05-03 10:56:12,810 - INFO -   ** New Best Found (Score: 0.3894) at max resource ** Params: {'C': 0.3621670908164007, 'coef0': 1.294987926651415, 'degree': 4, 'gamma': 1.3275623071492055, 'kernel': 'rbf', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:56:12,816 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:56:12,816 - INFO -   Bracket s=2 final best score: 0.3894
2025-05-03 10:56:12,816 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=0.33
2025-05-03 10:56:12,824 - INFO -   -- Round i=0: Evaluating 3 configs with resource=0.33 --
2025-05-03 10:56:15,932 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 10:56:15,935 - INFO -   -- Round i=1: Evaluating 1 configs with resource=1.00 --
2025-05-03 10:56:43,762 - INFO -   ** New Best Found (Score: 0.5144) at max resource ** Params: {'C': 72.00503817038027, 'coef0': 1.2536223012228445, 'degree': 2, 'gamma': 0.03461859944484052, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 10:56:43,762 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 10:56:43,762 - INFO -   Bracket s=1 final best score: 0.5144
2025-05-03 10:56:43,770 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=1.00
2025-05-03 10:56:43,774 - INFO -   -- Round i=0: Evaluating 3 configs with resource=1.00 --
2025-05-03 11:09:11,517 - INFO -   ** New Best Found (Score: 0.5179) at max resource ** Params: {'C': 0.03097852707196491, 'coef0': 0.3499262631523865, 'degree': 4, 'gamma': 2.7850890691622254, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 11:09:11,517 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 11:09:11,517 - INFO -   Bracket s=0 final best score: 0.5179
2025-05-03 11:09:11,524 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 11:09:11,524 - INFO - Total configurations evaluated (approx): 20
2025-05-03 11:09:11,524 - INFO - Best Overall Score (f1_score): 0.5179
2025-05-03 11:09:11,524 - INFO - Best Params: {'C': 0.03097852707196491, 'coef0': 0.3499262631523865, 'degree': 4, 'gamma': 2.7850890691622254, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 11:09:11,524 - INFO - [group_3] SVM Best Params: {'C': 0.03097852707196491, 'coef0': 0.3499262631523865, 'degree': 4, 'gamma': 2.7850890691622254, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.5179
2025-05-03 11:09:11,524 - INFO - --- [group_3] Running CART HPO ---
2025-05-03 11:09:11,526 - INFO - --- [CART] Running Hyperband HPO ---
2025-05-03 11:09:11,526 - INFO - --- Starting Hyperband HPO ---
2025-05-03 11:09:11,526 - INFO - Model: DecisionTreeClassifier
2025-05-03 11:09:11,526 - INFO - Resource Type: data_fraction
2025-05-03 11:09:11,526 - INFO - Resource Range: [0.1, 1.0]
2025-05-03 11:09:11,526 - INFO - Eta: 3
2025-05-03 11:09:11,526 - INFO - Max Brackets (s_max): 2
2025-05-03 11:09:11,526 - INFO - Approx. Budget (B): 3.00
2025-05-03 11:09:11,526 - INFO - Scoring: f1_score
2025-05-03 11:09:11,530 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=0.11
2025-05-03 11:09:11,534 - INFO -   -- Round i=0: Evaluating 9 configs with resource=0.11 --
2025-05-03 11:09:11,634 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 11:09:11,706 - INFO -   -- Round i=1: Evaluating 3 configs with resource=0.33 --
2025-05-03 11:09:11,791 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 11:09:11,793 - INFO -   -- Round i=2: Evaluating 1 configs with resource=1.00 --
2025-05-03 11:09:11,872 - INFO -   ** New Best Found (Score: 0.3649) at max resource ** Params: {'ccp_alpha': 0.0019909732779604607, 'criterion': 'entropy', 'max_depth': 32, 'max_features': 'sqrt', 'min_samples_leaf': 11, 'min_samples_split': 36, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 11:09:11,874 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 11:09:11,874 - INFO -   Bracket s=2 final best score: 0.3649
2025-05-03 11:09:11,875 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=0.33
2025-05-03 11:09:11,881 - INFO -   -- Round i=0: Evaluating 3 configs with resource=0.33 --
2025-05-03 11:09:11,932 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 11:09:11,934 - INFO -   -- Round i=1: Evaluating 1 configs with resource=1.00 --
2025-05-03 11:09:11,973 - INFO -   ** New Best Found (Score: 0.3734) at max resource ** Params: {'ccp_alpha': 3.2185620345457748e-06, 'criterion': 'log_loss', 'max_depth': 31, 'max_features': None, 'min_samples_leaf': 7, 'min_samples_split': 22, 'splitter': 'random', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 11:09:11,974 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 11:09:11,974 - INFO -   Bracket s=1 final best score: 0.3734
2025-05-03 11:09:11,977 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=1.00
2025-05-03 11:09:11,977 - INFO -   -- Round i=0: Evaluating 3 configs with resource=1.00 --
2025-05-03 11:09:12,238 - INFO -   ** New Best Found (Score: 0.4168) at max resource ** Params: {'ccp_alpha': 0.00027098211790596967, 'criterion': 'log_loss', 'max_depth': 41, 'max_features': 'sqrt', 'min_samples_leaf': 12, 'min_samples_split': 24, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 11:09:12,238 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 11:09:12,238 - INFO -   Bracket s=0 final best score: 0.4168
2025-05-03 11:09:12,245 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 11:09:12,246 - INFO - Total configurations evaluated (approx): 20
2025-05-03 11:09:12,246 - INFO - Best Overall Score (f1_score): 0.4168
2025-05-03 11:09:12,246 - INFO - Best Params: {'ccp_alpha': 0.00027098211790596967, 'criterion': 'log_loss', 'max_depth': 41, 'max_features': 'sqrt', 'min_samples_leaf': 12, 'min_samples_split': 24, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 11:09:12,246 - INFO - [group_3] CART Best Params: {'ccp_alpha': 0.00027098211790596967, 'criterion': 'log_loss', 'max_depth': 41, 'max_features': 'sqrt', 'min_samples_leaf': 12, 'min_samples_split': 24, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.4168
2025-05-03 11:09:12,246 - INFO - --- [group_3] Running Random Forest HPO ---
2025-05-03 11:09:12,248 - INFO - --- [Random_Forest] Running Hyperband HPO ---
2025-05-03 11:09:12,248 - INFO - --- Starting Hyperband HPO ---
2025-05-03 11:09:12,248 - INFO - Model: RandomForestClassifier
2025-05-03 11:09:12,248 - INFO - Resource Type: iterations
2025-05-03 11:09:12,248 - INFO - Resource Range: [20, 300]
2025-05-03 11:09:12,248 - INFO - Eta: 3
2025-05-03 11:09:12,248 - INFO - Max Brackets (s_max): 2
2025-05-03 11:09:12,248 - INFO - Approx. Budget (B): 900.00
2025-05-03 11:09:12,248 - INFO - Scoring: f1_score
2025-05-03 11:09:12,250 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=33.33
2025-05-03 11:09:12,254 - INFO -   -- Round i=0: Evaluating 9 configs with resource=33.33 --
2025-05-03 11:10:06,629 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 11:10:06,632 - INFO -   -- Round i=1: Evaluating 3 configs with resource=100.00 --
2025-05-03 11:11:05,567 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 11:11:05,571 - INFO -   -- Round i=2: Evaluating 1 configs with resource=300.00 --
2025-05-03 11:12:23,792 - INFO -   ** New Best Found (Score: 0.6792) at max resource ** Params: {'bootstrap': False, 'ccp_alpha': 1.1456552628177777e-06, 'criterion': 'entropy', 'max_depth': 26, 'max_features': 0.5, 'min_samples_leaf': 10, 'min_samples_split': 32, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 11:12:23,792 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 11:12:23,792 - INFO -   Bracket s=2 final best score: 0.6792
2025-05-03 11:12:23,792 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=100.00
2025-05-03 11:12:23,792 - INFO -   -- Round i=0: Evaluating 3 configs with resource=100.00 --
2025-05-03 11:13:47,472 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 11:13:47,475 - INFO -   -- Round i=1: Evaluating 1 configs with resource=300.00 --
2025-05-03 11:15:09,152 - INFO -   ** New Best Found (Score: 0.7059) at max resource ** Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 11:15:09,152 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 11:15:09,152 - INFO -   Bracket s=1 final best score: 0.7059
2025-05-03 11:15:09,165 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=300.00
2025-05-03 11:15:09,168 - INFO -   -- Round i=0: Evaluating 3 configs with resource=300.00 --
2025-05-03 11:15:47,933 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 11:15:47,933 - INFO -   Bracket s=0 final best score: 0.6632
2025-05-03 11:15:47,933 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 11:15:47,933 - INFO - Total configurations evaluated (approx): 20
2025-05-03 11:15:47,933 - INFO - Best Overall Score (f1_score): 0.7059
2025-05-03 11:15:47,933 - INFO - Best Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 11:15:47,933 - INFO - [group_3] RF Best Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.7059
2025-05-03 11:15:47,933 - INFO - --- [group_3] Running XGBoost HPO ---
2025-05-03 11:15:47,933 - INFO - --- [XGBoost] Running Hyperband HPO ---
2025-05-03 11:15:47,933 - INFO - --- Starting Hyperband HPO ---
2025-05-03 11:15:47,933 - INFO - Model: XGBClassifier
2025-05-03 11:15:47,933 - INFO - Resource Type: iterations
2025-05-03 11:15:47,933 - INFO - Resource Range: [30, 500]
2025-05-03 11:15:47,933 - INFO - Eta: 3
2025-05-03 11:15:47,933 - INFO - Max Brackets (s_max): 2
2025-05-03 11:15:47,933 - INFO - Approx. Budget (B): 1500.00
2025-05-03 11:15:47,933 - INFO - Scoring: f1_score
2025-05-03 11:15:47,947 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=55.56
2025-05-03 11:15:47,954 - INFO -   -- Round i=0: Evaluating 9 configs with resource=55.56 --
2025-05-03 11:15:50,606 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 11:15:50,606 - INFO -   -- Round i=1: Evaluating 3 configs with resource=166.67 --
2025-05-03 11:15:52,889 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 11:15:52,892 - INFO -   -- Round i=2: Evaluating 1 configs with resource=500.00 --
2025-05-03 11:15:54,443 - INFO -   ** New Best Found (Score: 0.7303) at max resource ** Params: {'colsample_bytree': 0.9121655978614853, 'eval_metric': 'logloss', 'gamma': 0.02349697204033308, 'learning_rate': 0.10681467052331052, 'max_depth': 8, 'min_child_weight': 7.7379802149848596, 'objective': 'binary:logistic', 'reg_alpha': 8.407080271524405, 'reg_lambda': 0.004198585696776684, 'subsample': 0.7198992394624828, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 11:15:54,445 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 11:15:54,445 - INFO -   Bracket s=2 final best score: 0.7303
2025-05-03 11:15:54,448 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=166.67
2025-05-03 11:15:54,453 - INFO -   -- Round i=0: Evaluating 3 configs with resource=166.67 --
2025-05-03 11:15:56,315 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 11:15:56,315 - INFO -   -- Round i=1: Evaluating 1 configs with resource=500.00 --
2025-05-03 11:15:57,785 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 11:15:57,785 - INFO -   Bracket s=1 final best score: 0.7186
2025-05-03 11:15:57,790 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=500.00
2025-05-03 11:15:57,793 - INFO -   -- Round i=0: Evaluating 3 configs with resource=500.00 --
2025-05-03 11:16:01,533 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 11:16:01,533 - INFO -   Bracket s=0 final best score: 0.7284
2025-05-03 11:16:01,545 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 11:16:01,546 - INFO - Total configurations evaluated (approx): 20
2025-05-03 11:16:01,546 - INFO - Best Overall Score (f1_score): 0.7303
2025-05-03 11:16:01,546 - INFO - Best Params: {'colsample_bytree': 0.9121655978614853, 'eval_metric': 'logloss', 'gamma': 0.02349697204033308, 'learning_rate': 0.10681467052331052, 'max_depth': 8, 'min_child_weight': 7.7379802149848596, 'objective': 'binary:logistic', 'reg_alpha': 8.407080271524405, 'reg_lambda': 0.004198585696776684, 'subsample': 0.7198992394624828, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 11:16:01,546 - INFO - [group_3] XGB Best Params: {'colsample_bytree': 0.9121655978614853, 'eval_metric': 'logloss', 'gamma': 0.02349697204033308, 'learning_rate': 0.10681467052331052, 'max_depth': 8, 'min_child_weight': 7.7379802149848596, 'objective': 'binary:logistic', 'reg_alpha': 8.407080271524405, 'reg_lambda': 0.004198585696776684, 'subsample': 0.7198992394624828, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}, Score: 0.7303
2025-05-03 11:16:01,546 - INFO - --- [group_3] Running LightGBM HPO ---
2025-05-03 11:16:01,550 - INFO - --- [LightGBM] Running Hyperband HPO ---
2025-05-03 11:16:01,550 - INFO - --- Starting Hyperband HPO ---
2025-05-03 11:16:01,550 - INFO - Model: LGBMClassifier
2025-05-03 11:16:01,550 - INFO - Resource Type: iterations
2025-05-03 11:16:01,550 - INFO - Resource Range: [30, 500]
2025-05-03 11:16:01,550 - INFO - Eta: 3
2025-05-03 11:16:01,551 - INFO - Max Brackets (s_max): 2
2025-05-03 11:16:01,551 - INFO - Approx. Budget (B): 1500.00
2025-05-03 11:16:01,551 - INFO - Scoring: f1_score
2025-05-03 11:16:01,553 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=55.56
2025-05-03 11:16:01,558 - INFO -   -- Round i=0: Evaluating 9 configs with resource=55.56 --
2025-05-03 11:16:02,599 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 11:16:02,602 - INFO -   -- Round i=1: Evaluating 3 configs with resource=166.67 --
2025-05-03 11:16:03,296 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 11:16:03,303 - INFO -   -- Round i=2: Evaluating 1 configs with resource=500.00 --
2025-05-03 11:16:03,766 - INFO -   ** New Best Found (Score: 0.7262) at max resource ** Params: {'colsample_bytree': 0.5422063747642943, 'learning_rate': 0.07885165402835125, 'max_depth': 7, 'metric': 'logloss', 'min_child_samples': 38, 'num_leaves': 83, 'objective': 'binary', 'reg_alpha': 0.000741705371224509, 'reg_lambda': 0.0409101946040011, 'subsample': 0.9160632720432271, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 11:16:03,768 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 11:16:03,768 - INFO -   Bracket s=2 final best score: 0.7262
2025-05-03 11:16:03,772 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=166.67
2025-05-03 11:16:03,780 - INFO -   -- Round i=0: Evaluating 3 configs with resource=166.67 --
2025-05-03 11:16:04,696 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 11:16:04,705 - INFO -   -- Round i=1: Evaluating 1 configs with resource=500.00 --
2025-05-03 11:16:05,347 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 11:16:05,347 - INFO -   Bracket s=1 final best score: 0.7251
2025-05-03 11:16:05,351 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=500.00
2025-05-03 11:16:05,357 - INFO -   -- Round i=0: Evaluating 3 configs with resource=500.00 --
2025-05-03 11:16:06,632 - INFO -   ** New Best Found (Score: 0.7381) at max resource ** Params: {'colsample_bytree': 0.9252309722947032, 'learning_rate': 0.10579748529279263, 'max_depth': 10, 'metric': 'logloss', 'min_child_samples': 17, 'num_leaves': 27, 'objective': 'binary', 'reg_alpha': 0.00024991242947225575, 'reg_lambda': 0.02544659616528781, 'subsample': 0.5818175813025477, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 11:16:06,633 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 11:16:06,633 - INFO -   Bracket s=0 final best score: 0.7381
2025-05-03 11:16:06,636 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 11:16:06,636 - INFO - Total configurations evaluated (approx): 20
2025-05-03 11:16:06,636 - INFO - Best Overall Score (f1_score): 0.7381
2025-05-03 11:16:06,636 - INFO - Best Params: {'colsample_bytree': 0.9252309722947032, 'learning_rate': 0.10579748529279263, 'max_depth': 10, 'metric': 'logloss', 'min_child_samples': 17, 'num_leaves': 27, 'objective': 'binary', 'reg_alpha': 0.00024991242947225575, 'reg_lambda': 0.02544659616528781, 'subsample': 0.5818175813025477, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 11:16:06,636 - INFO - [group_3] LGBM Best Params: {'colsample_bytree': 0.9252309722947032, 'learning_rate': 0.10579748529279263, 'max_depth': 10, 'metric': 'logloss', 'min_child_samples': 17, 'num_leaves': 27, 'objective': 'binary', 'reg_alpha': 0.00024991242947225575, 'reg_lambda': 0.02544659616528781, 'subsample': 0.5818175813025477, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}, Score: 0.7381
2025-05-03 11:16:06,792 - INFO - [group_3] Successfully saved best parameters to best_params\group_3_best_params.json
2025-05-03 11:16:06,792 - INFO - --- Finished HPO for Group: group_3 in 1347.93 seconds ---
2025-05-03 11:16:06,793 - INFO - 
============================== Running HPO for Group: group_4 ==============================
2025-05-03 11:16:06,794 - INFO - [group_4] Cleaning data...
2025-05-03 11:16:06,794 - INFO - Original dataset size: (27388, 136)
2025-05-03 11:16:06,794 - INFO - Dataset size after dropping NaNs: (27388, 12)
2025-05-03 11:16:06,794 - INFO - Value counts for target:
1 (Star): 1926
0 (Galaxy): 25462
2025-05-03 11:16:06,801 - INFO - [group_4] Splitting data (Train/Val only for HPO)...
2025-05-03 11:16:06,801 - INFO - Splitting data using 'stratified' strategy...
2025-05-03 11:16:06,801 - INFO - Target split ratios: Train=0.60, Val=0.10, Test=0.20, Cal=0.10
2025-05-03 11:16:06,807 - INFO - Train set shape: (16432, 11)
2025-05-03 11:16:06,810 - INFO - Validation set shape: (2738, 11)
2025-05-03 11:16:06,813 - INFO - Test set shape: (5478, 11)
2025-05-03 11:16:06,813 - INFO - Calibration set shape: (2740, 11)
2025-05-03 11:16:06,813 - INFO - Split lengths verification successful.
2025-05-03 11:16:06,813 - INFO - Data splitting complete.
2025-05-03 11:16:06,813 - INFO - Train target distribution:
acs_mu_class
0    0.929649
1    0.070351
Name: count, dtype: float64
2025-05-03 11:16:06,813 - INFO - Train target counts:
acs_mu_class
0    15276
1     1156
Name: count, dtype: int64
2025-05-03 11:16:06,814 - INFO - Validation target distribution:
acs_mu_class
0    0.929876
1    0.070124
Name: count, dtype: float64
2025-05-03 11:16:06,814 - INFO - Validation target counts:
acs_mu_class
0    2546
1     192
Name: count, dtype: int64
2025-05-03 11:16:06,814 - INFO - Test target distribution:
acs_mu_class
0    0.929719
1    0.070281
Name: count, dtype: float64
2025-05-03 11:16:06,814 - INFO - Test target counts:
acs_mu_class
0    5093
1     385
Name: count, dtype: int64
2025-05-03 11:16:06,815 - INFO - Calibration target distribution:
acs_mu_class
0    0.929562
1    0.070438
Name: count, dtype: float64
2025-05-03 11:16:06,815 - INFO - Calibration target counts:
acs_mu_class
0    2547
1     193
Name: count, dtype: int64
2025-05-03 11:16:06,815 - INFO - [group_4] Applying feature scaling (for SVM HPO)...
2025-05-03 11:16:06,815 - INFO - Applying StandardScaler to features...
2025-05-03 11:16:06,818 - INFO - Feature scaling complete.
2025-05-03 11:16:06,819 - INFO - --- [group_4] Running SVM HPO ---
2025-05-03 11:16:06,819 - INFO - --- [SVM] Running Hyperband HPO ---
2025-05-03 11:16:06,819 - INFO - --- Starting Hyperband HPO ---
2025-05-03 11:16:06,819 - INFO - Model: SVC
2025-05-03 11:16:06,819 - INFO - Resource Type: data_fraction
2025-05-03 11:16:06,819 - INFO - Resource Range: [0.1, 1.0]
2025-05-03 11:16:06,819 - INFO - Eta: 3
2025-05-03 11:16:06,819 - INFO - Max Brackets (s_max): 2
2025-05-03 11:16:06,819 - INFO - Approx. Budget (B): 3.00
2025-05-03 11:16:06,819 - INFO - Scoring: f1_score
2025-05-03 11:16:06,824 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=0.11
2025-05-03 11:16:06,827 - INFO -   -- Round i=0: Evaluating 9 configs with resource=0.11 --
2025-05-03 11:16:11,751 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 11:16:11,754 - INFO -   -- Round i=1: Evaluating 3 configs with resource=0.33 --
2025-05-03 11:16:13,214 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 11:16:13,216 - INFO -   -- Round i=2: Evaluating 1 configs with resource=1.00 --
2025-05-03 11:16:15,503 - INFO -   ** New Best Found (Score: 0.5250) at max resource ** Params: {'C': 0.0024259612444969317, 'coef0': 1.7431902751987698, 'degree': 2, 'gamma': 0.6681682093919618, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 11:16:15,503 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 11:16:15,503 - INFO -   Bracket s=2 final best score: 0.5250
2025-05-03 11:16:15,509 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=0.33
2025-05-03 11:16:15,512 - INFO -   -- Round i=0: Evaluating 3 configs with resource=0.33 --
2025-05-03 11:16:17,586 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 11:16:17,589 - INFO -   -- Round i=1: Evaluating 1 configs with resource=1.00 --
2025-05-03 11:16:23,146 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 11:16:23,147 - INFO -   Bracket s=1 final best score: 0.5199
2025-05-03 11:16:23,150 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=1.00
2025-05-03 11:16:23,154 - INFO -   -- Round i=0: Evaluating 3 configs with resource=1.00 --
2025-05-03 12:36:23,946 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:36:23,946 - INFO -   Bracket s=0 final best score: 0.4724
2025-05-03 12:36:23,952 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 12:36:23,952 - INFO - Total configurations evaluated (approx): 20
2025-05-03 12:36:23,952 - INFO - Best Overall Score (f1_score): 0.5250
2025-05-03 12:36:23,952 - INFO - Best Params: {'C': 0.0024259612444969317, 'coef0': 1.7431902751987698, 'degree': 2, 'gamma': 0.6681682093919618, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:36:23,952 - INFO - [group_4] SVM Best Params: {'C': 0.0024259612444969317, 'coef0': 1.7431902751987698, 'degree': 2, 'gamma': 0.6681682093919618, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.5250
2025-05-03 12:36:23,952 - INFO - --- [group_4] Running CART HPO ---
2025-05-03 12:36:23,953 - INFO - --- [CART] Running Hyperband HPO ---
2025-05-03 12:36:23,953 - INFO - --- Starting Hyperband HPO ---
2025-05-03 12:36:23,953 - INFO - Model: DecisionTreeClassifier
2025-05-03 12:36:23,953 - INFO - Resource Type: data_fraction
2025-05-03 12:36:23,953 - INFO - Resource Range: [0.1, 1.0]
2025-05-03 12:36:23,953 - INFO - Eta: 3
2025-05-03 12:36:23,953 - INFO - Max Brackets (s_max): 2
2025-05-03 12:36:23,954 - INFO - Approx. Budget (B): 3.00
2025-05-03 12:36:23,954 - INFO - Scoring: f1_score
2025-05-03 12:36:23,957 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=0.11
2025-05-03 12:36:23,960 - INFO -   -- Round i=0: Evaluating 9 configs with resource=0.11 --
2025-05-03 12:36:24,031 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 12:36:24,033 - INFO -   -- Round i=1: Evaluating 3 configs with resource=0.33 --
2025-05-03 12:36:24,081 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:36:24,083 - INFO -   -- Round i=2: Evaluating 1 configs with resource=1.00 --
2025-05-03 12:36:24,134 - INFO -   ** New Best Found (Score: 0.3944) at max resource ** Params: {'ccp_alpha': 0.0003836096622706455, 'criterion': 'gini', 'max_depth': 32, 'max_features': 'sqrt', 'min_samples_leaf': 1, 'min_samples_split': 43, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:36:24,134 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:36:24,134 - INFO -   Bracket s=2 final best score: 0.3944
2025-05-03 12:36:24,139 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=0.33
2025-05-03 12:36:24,143 - INFO -   -- Round i=0: Evaluating 3 configs with resource=0.33 --
2025-05-03 12:36:24,175 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:36:24,177 - INFO -   -- Round i=1: Evaluating 1 configs with resource=1.00 --
2025-05-03 12:36:24,197 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:36:24,197 - INFO -   Bracket s=1 final best score: 0.3799
2025-05-03 12:36:24,200 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=1.00
2025-05-03 12:36:24,204 - INFO -   -- Round i=0: Evaluating 3 configs with resource=1.00 --
2025-05-03 12:36:24,302 - INFO -   ** New Best Found (Score: 0.5393) at max resource ** Params: {'ccp_alpha': 1.7480370654279986e-05, 'criterion': 'gini', 'max_depth': 4, 'max_features': None, 'min_samples_leaf': 10, 'min_samples_split': 5, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:36:24,304 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:36:24,304 - INFO -   Bracket s=0 final best score: 0.5393
2025-05-03 12:36:24,306 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 12:36:24,306 - INFO - Total configurations evaluated (approx): 20
2025-05-03 12:36:24,306 - INFO - Best Overall Score (f1_score): 0.5393
2025-05-03 12:36:24,306 - INFO - Best Params: {'ccp_alpha': 1.7480370654279986e-05, 'criterion': 'gini', 'max_depth': 4, 'max_features': None, 'min_samples_leaf': 10, 'min_samples_split': 5, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:36:24,306 - INFO - [group_4] CART Best Params: {'ccp_alpha': 1.7480370654279986e-05, 'criterion': 'gini', 'max_depth': 4, 'max_features': None, 'min_samples_leaf': 10, 'min_samples_split': 5, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.5393
2025-05-03 12:36:24,306 - INFO - --- [group_4] Running Random Forest HPO ---
2025-05-03 12:36:24,309 - INFO - --- [Random_Forest] Running Hyperband HPO ---
2025-05-03 12:36:24,309 - INFO - --- Starting Hyperband HPO ---
2025-05-03 12:36:24,309 - INFO - Model: RandomForestClassifier
2025-05-03 12:36:24,309 - INFO - Resource Type: iterations
2025-05-03 12:36:24,309 - INFO - Resource Range: [20, 300]
2025-05-03 12:36:24,309 - INFO - Eta: 3
2025-05-03 12:36:24,309 - INFO - Max Brackets (s_max): 2
2025-05-03 12:36:24,309 - INFO - Approx. Budget (B): 900.00
2025-05-03 12:36:24,309 - INFO - Scoring: f1_score
2025-05-03 12:36:24,313 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=33.33
2025-05-03 12:36:24,322 - INFO -   -- Round i=0: Evaluating 9 configs with resource=33.33 --
2025-05-03 12:36:38,893 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 12:36:38,896 - INFO -   -- Round i=1: Evaluating 3 configs with resource=100.00 --
2025-05-03 12:36:58,253 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:36:58,255 - INFO -   -- Round i=2: Evaluating 1 configs with resource=300.00 --
2025-05-03 12:37:17,321 - INFO -   ** New Best Found (Score: 0.6123) at max resource ** Params: {'bootstrap': False, 'ccp_alpha': 0.0001355770390242371, 'criterion': 'entropy', 'max_depth': 33, 'max_features': 0.5, 'min_samples_leaf': 1, 'min_samples_split': 43, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:37:17,323 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:37:17,323 - INFO -   Bracket s=2 final best score: 0.6123
2025-05-03 12:37:17,327 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=100.00
2025-05-03 12:37:17,333 - INFO -   -- Round i=0: Evaluating 3 configs with resource=100.00 --
2025-05-03 12:37:37,457 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:37:37,460 - INFO -   -- Round i=1: Evaluating 1 configs with resource=300.00 --
2025-05-03 12:37:57,035 - INFO -   ** New Best Found (Score: 0.6407) at max resource ** Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:37:57,035 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:37:57,035 - INFO -   Bracket s=1 final best score: 0.6407
2025-05-03 12:37:57,043 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=300.00
2025-05-03 12:37:57,046 - INFO -   -- Round i=0: Evaluating 3 configs with resource=300.00 --
2025-05-03 12:38:21,349 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:38:21,349 - INFO -   Bracket s=0 final best score: 0.6188
2025-05-03 12:38:21,353 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 12:38:21,353 - INFO - Total configurations evaluated (approx): 20
2025-05-03 12:38:21,353 - INFO - Best Overall Score (f1_score): 0.6407
2025-05-03 12:38:21,353 - INFO - Best Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:38:21,353 - INFO - [group_4] RF Best Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.6407
2025-05-03 12:38:21,353 - INFO - --- [group_4] Running XGBoost HPO ---
2025-05-03 12:38:21,356 - INFO - --- [XGBoost] Running Hyperband HPO ---
2025-05-03 12:38:21,356 - INFO - --- Starting Hyperband HPO ---
2025-05-03 12:38:21,356 - INFO - Model: XGBClassifier
2025-05-03 12:38:21,356 - INFO - Resource Type: iterations
2025-05-03 12:38:21,356 - INFO - Resource Range: [30, 500]
2025-05-03 12:38:21,356 - INFO - Eta: 3
2025-05-03 12:38:21,356 - INFO - Max Brackets (s_max): 2
2025-05-03 12:38:21,356 - INFO - Approx. Budget (B): 1500.00
2025-05-03 12:38:21,356 - INFO - Scoring: f1_score
2025-05-03 12:38:21,360 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=55.56
2025-05-03 12:38:21,363 - INFO -   -- Round i=0: Evaluating 9 configs with resource=55.56 --
2025-05-03 12:38:22,403 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 12:38:22,404 - INFO -   -- Round i=1: Evaluating 3 configs with resource=166.67 --
2025-05-03 12:38:23,479 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:38:23,481 - INFO -   -- Round i=2: Evaluating 1 configs with resource=500.00 --
2025-05-03 12:38:24,217 - INFO -   ** New Best Found (Score: 0.6586) at max resource ** Params: {'colsample_bytree': 0.9945318117251694, 'eval_metric': 'logloss', 'gamma': 0.000747225366266352, 'learning_rate': 0.18840199781437414, 'max_depth': 10, 'min_child_weight': 1.3986421814568597, 'objective': 'binary:logistic', 'reg_alpha': 0.37218805533904253, 'reg_lambda': 0.1423466853015628, 'subsample': 0.9249775685156074, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 12:38:24,217 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:38:24,217 - INFO -   Bracket s=2 final best score: 0.6586
2025-05-03 12:38:24,222 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=166.67
2025-05-03 12:38:24,229 - INFO -   -- Round i=0: Evaluating 3 configs with resource=166.67 --
2025-05-03 12:38:24,977 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:38:24,979 - INFO -   -- Round i=1: Evaluating 1 configs with resource=500.00 --
2025-05-03 12:38:25,616 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:38:25,616 - INFO -   Bracket s=1 final best score: 0.6388
2025-05-03 12:38:25,616 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=500.00
2025-05-03 12:38:25,622 - INFO -   -- Round i=0: Evaluating 3 configs with resource=500.00 --
2025-05-03 12:38:27,235 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:38:27,235 - INFO -   Bracket s=0 final best score: 0.6366
2025-05-03 12:38:27,240 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 12:38:27,240 - INFO - Total configurations evaluated (approx): 20
2025-05-03 12:38:27,240 - INFO - Best Overall Score (f1_score): 0.6586
2025-05-03 12:38:27,240 - INFO - Best Params: {'colsample_bytree': 0.9945318117251694, 'eval_metric': 'logloss', 'gamma': 0.000747225366266352, 'learning_rate': 0.18840199781437414, 'max_depth': 10, 'min_child_weight': 1.3986421814568597, 'objective': 'binary:logistic', 'reg_alpha': 0.37218805533904253, 'reg_lambda': 0.1423466853015628, 'subsample': 0.9249775685156074, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 12:38:27,240 - INFO - [group_4] XGB Best Params: {'colsample_bytree': 0.9945318117251694, 'eval_metric': 'logloss', 'gamma': 0.000747225366266352, 'learning_rate': 0.18840199781437414, 'max_depth': 10, 'min_child_weight': 1.3986421814568597, 'objective': 'binary:logistic', 'reg_alpha': 0.37218805533904253, 'reg_lambda': 0.1423466853015628, 'subsample': 0.9249775685156074, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}, Score: 0.6586
2025-05-03 12:38:27,240 - INFO - --- [group_4] Running LightGBM HPO ---
2025-05-03 12:38:27,247 - INFO - --- [LightGBM] Running Hyperband HPO ---
2025-05-03 12:38:27,247 - INFO - --- Starting Hyperband HPO ---
2025-05-03 12:38:27,247 - INFO - Model: LGBMClassifier
2025-05-03 12:38:27,247 - INFO - Resource Type: iterations
2025-05-03 12:38:27,247 - INFO - Resource Range: [30, 500]
2025-05-03 12:38:27,247 - INFO - Eta: 3
2025-05-03 12:38:27,247 - INFO - Max Brackets (s_max): 2
2025-05-03 12:38:27,247 - INFO - Approx. Budget (B): 1500.00
2025-05-03 12:38:27,247 - INFO - Scoring: f1_score
2025-05-03 12:38:27,251 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=55.56
2025-05-03 12:38:27,260 - INFO -   -- Round i=0: Evaluating 9 configs with resource=55.56 --
2025-05-03 12:38:27,841 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 12:38:27,841 - INFO -   -- Round i=1: Evaluating 3 configs with resource=166.67 --
2025-05-03 12:38:28,269 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:38:28,271 - INFO -   -- Round i=2: Evaluating 1 configs with resource=500.00 --
2025-05-03 12:38:28,582 - INFO -   ** New Best Found (Score: 0.6045) at max resource ** Params: {'colsample_bytree': 0.5422063747642943, 'learning_rate': 0.07885165402835125, 'max_depth': 7, 'metric': 'logloss', 'min_child_samples': 38, 'num_leaves': 83, 'objective': 'binary', 'reg_alpha': 0.000741705371224509, 'reg_lambda': 0.0409101946040011, 'subsample': 0.9160632720432271, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 12:38:28,583 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:38:28,583 - INFO -   Bracket s=2 final best score: 0.6045
2025-05-03 12:38:28,587 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=166.67
2025-05-03 12:38:28,593 - INFO -   -- Round i=0: Evaluating 3 configs with resource=166.67 --
2025-05-03 12:38:29,168 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:38:29,173 - INFO -   -- Round i=1: Evaluating 1 configs with resource=500.00 --
2025-05-03 12:38:29,913 - INFO -   ** New Best Found (Score: 0.6420) at max resource ** Params: {'colsample_bytree': 0.9039964094408228, 'learning_rate': 0.0797677538429512, 'max_depth': 11, 'metric': 'logloss', 'min_child_samples': 13, 'num_leaves': 127, 'objective': 'binary', 'reg_alpha': 0.012938744945205824, 'reg_lambda': 0.03825756838214059, 'subsample': 0.7039257128340015, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 12:38:29,919 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:38:29,919 - INFO -   Bracket s=1 final best score: 0.6420
2025-05-03 12:38:29,919 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=500.00
2025-05-03 12:38:29,925 - INFO -   -- Round i=0: Evaluating 3 configs with resource=500.00 --
2025-05-03 12:38:30,702 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:38:30,702 - INFO -   Bracket s=0 final best score: 0.6209
2025-05-03 12:38:30,702 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 12:38:30,702 - INFO - Total configurations evaluated (approx): 20
2025-05-03 12:38:30,702 - INFO - Best Overall Score (f1_score): 0.6420
2025-05-03 12:38:30,702 - INFO - Best Params: {'colsample_bytree': 0.9039964094408228, 'learning_rate': 0.0797677538429512, 'max_depth': 11, 'metric': 'logloss', 'min_child_samples': 13, 'num_leaves': 127, 'objective': 'binary', 'reg_alpha': 0.012938744945205824, 'reg_lambda': 0.03825756838214059, 'subsample': 0.7039257128340015, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 12:38:30,702 - INFO - [group_4] LGBM Best Params: {'colsample_bytree': 0.9039964094408228, 'learning_rate': 0.0797677538429512, 'max_depth': 11, 'metric': 'logloss', 'min_child_samples': 13, 'num_leaves': 127, 'objective': 'binary', 'reg_alpha': 0.012938744945205824, 'reg_lambda': 0.03825756838214059, 'subsample': 0.7039257128340015, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}, Score: 0.6420
2025-05-03 12:38:30,702 - INFO - [group_4] Successfully saved best parameters to best_params\group_4_best_params.json
2025-05-03 12:38:30,702 - INFO - --- Finished HPO for Group: group_4 in 4943.91 seconds ---
2025-05-03 12:38:30,702 - INFO - 
============================== Running HPO for Group: group_5 ==============================
2025-05-03 12:38:30,702 - INFO - [group_5] Cleaning data...
2025-05-03 12:38:30,702 - INFO - Original dataset size: (27388, 136)
2025-05-03 12:38:30,730 - INFO - Dataset size after dropping NaNs: (27388, 59)
2025-05-03 12:38:30,731 - INFO - Value counts for target:
1 (Star): 1926
0 (Galaxy): 25462
2025-05-03 12:38:30,731 - INFO - [group_5] Splitting data (Train/Val only for HPO)...
2025-05-03 12:38:30,731 - INFO - Splitting data using 'stratified' strategy...
2025-05-03 12:38:30,731 - INFO - Target split ratios: Train=0.60, Val=0.10, Test=0.20, Cal=0.10
2025-05-03 12:38:30,744 - INFO - Train set shape: (16432, 58)
2025-05-03 12:38:30,752 - INFO - Validation set shape: (2738, 58)
2025-05-03 12:38:30,763 - INFO - Test set shape: (5478, 58)
2025-05-03 12:38:30,763 - INFO - Calibration set shape: (2740, 58)
2025-05-03 12:38:30,763 - INFO - Split lengths verification successful.
2025-05-03 12:38:30,763 - INFO - Data splitting complete.
2025-05-03 12:38:30,763 - INFO - Train target distribution:
acs_mu_class
0    0.929649
1    0.070351
Name: count, dtype: float64
2025-05-03 12:38:30,763 - INFO - Train target counts:
acs_mu_class
0    15276
1     1156
Name: count, dtype: int64
2025-05-03 12:38:30,763 - INFO - Validation target distribution:
acs_mu_class
0    0.929876
1    0.070124
Name: count, dtype: float64
2025-05-03 12:38:30,763 - INFO - Validation target counts:
acs_mu_class
0    2546
1     192
Name: count, dtype: int64
2025-05-03 12:38:30,763 - INFO - Test target distribution:
acs_mu_class
0    0.929719
1    0.070281
Name: count, dtype: float64
2025-05-03 12:38:30,767 - INFO - Test target counts:
acs_mu_class
0    5093
1     385
Name: count, dtype: int64
2025-05-03 12:38:30,768 - INFO - Calibration target distribution:
acs_mu_class
0    0.929562
1    0.070438
Name: count, dtype: float64
2025-05-03 12:38:30,768 - INFO - Calibration target counts:
acs_mu_class
0    2547
1     193
Name: count, dtype: int64
2025-05-03 12:38:30,768 - INFO - [group_5] Applying feature scaling (for SVM HPO)...
2025-05-03 12:38:30,770 - INFO - Applying StandardScaler to features...
2025-05-03 12:38:30,790 - INFO - Feature scaling complete.
2025-05-03 12:38:30,791 - INFO - --- [group_5] Running SVM HPO ---
2025-05-03 12:38:30,793 - INFO - --- [SVM] Running Hyperband HPO ---
2025-05-03 12:38:30,793 - INFO - --- Starting Hyperband HPO ---
2025-05-03 12:38:30,793 - INFO - Model: SVC
2025-05-03 12:38:30,793 - INFO - Resource Type: data_fraction
2025-05-03 12:38:30,793 - INFO - Resource Range: [0.1, 1.0]
2025-05-03 12:38:30,793 - INFO - Eta: 3
2025-05-03 12:38:30,793 - INFO - Max Brackets (s_max): 2
2025-05-03 12:38:30,793 - INFO - Approx. Budget (B): 3.00
2025-05-03 12:38:30,793 - INFO - Scoring: f1_score
2025-05-03 12:38:30,796 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=0.11
2025-05-03 12:38:30,802 - INFO -   -- Round i=0: Evaluating 9 configs with resource=0.11 --
2025-05-03 12:39:06,866 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 12:39:06,868 - INFO -   -- Round i=1: Evaluating 3 configs with resource=0.33 --
2025-05-03 12:39:09,415 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:39:09,415 - INFO -   -- Round i=2: Evaluating 1 configs with resource=1.00 --
2025-05-03 12:39:16,181 - INFO -   ** New Best Found (Score: 0.5130) at max resource ** Params: {'C': 0.5601826959647047, 'coef0': -0.07495117910526505, 'degree': 3, 'gamma': 5.281387138164578e-05, 'kernel': 'rbf', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:39:16,183 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:39:16,183 - INFO -   Bracket s=2 final best score: 0.5130
2025-05-03 12:39:16,187 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=0.33
2025-05-03 12:39:16,191 - INFO -   -- Round i=0: Evaluating 3 configs with resource=0.33 --
2025-05-03 12:39:19,160 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:39:19,167 - INFO -   -- Round i=1: Evaluating 1 configs with resource=1.00 --
2025-05-03 12:39:52,852 - INFO -   ** New Best Found (Score: 0.5650) at max resource ** Params: {'C': 72.00503817038027, 'coef0': 1.2536223012228445, 'degree': 2, 'gamma': 0.03461859944484052, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:39:52,853 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:39:52,854 - INFO -   Bracket s=1 final best score: 0.5650
2025-05-03 12:39:52,858 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=1.00
2025-05-03 12:39:52,863 - INFO -   -- Round i=0: Evaluating 3 configs with resource=1.00 --
2025-05-03 12:42:23,317 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:42:23,317 - INFO -   Bracket s=0 final best score: 0.5374
2025-05-03 12:42:23,321 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 12:42:23,321 - INFO - Total configurations evaluated (approx): 20
2025-05-03 12:42:23,321 - INFO - Best Overall Score (f1_score): 0.5650
2025-05-03 12:42:23,321 - INFO - Best Params: {'C': 72.00503817038027, 'coef0': 1.2536223012228445, 'degree': 2, 'gamma': 0.03461859944484052, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:42:23,321 - INFO - [group_5] SVM Best Params: {'C': 72.00503817038027, 'coef0': 1.2536223012228445, 'degree': 2, 'gamma': 0.03461859944484052, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.5650
2025-05-03 12:42:23,321 - INFO - --- [group_5] Running CART HPO ---
2025-05-03 12:42:23,321 - INFO - --- [CART] Running Hyperband HPO ---
2025-05-03 12:42:23,321 - INFO - --- Starting Hyperband HPO ---
2025-05-03 12:42:23,321 - INFO - Model: DecisionTreeClassifier
2025-05-03 12:42:23,321 - INFO - Resource Type: data_fraction
2025-05-03 12:42:23,321 - INFO - Resource Range: [0.1, 1.0]
2025-05-03 12:42:23,321 - INFO - Eta: 3
2025-05-03 12:42:23,321 - INFO - Max Brackets (s_max): 2
2025-05-03 12:42:23,321 - INFO - Approx. Budget (B): 3.00
2025-05-03 12:42:23,321 - INFO - Scoring: f1_score
2025-05-03 12:42:23,327 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=0.11
2025-05-03 12:42:23,333 - INFO -   -- Round i=0: Evaluating 9 configs with resource=0.11 --
2025-05-03 12:42:23,464 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 12:42:23,467 - INFO -   -- Round i=1: Evaluating 3 configs with resource=0.33 --
2025-05-03 12:42:23,557 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:42:23,559 - INFO -   -- Round i=2: Evaluating 1 configs with resource=1.00 --
2025-05-03 12:42:23,643 - INFO -   ** New Best Found (Score: 0.4678) at max resource ** Params: {'ccp_alpha': 0.0003836096622706455, 'criterion': 'gini', 'max_depth': 32, 'max_features': 'sqrt', 'min_samples_leaf': 1, 'min_samples_split': 43, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:42:23,643 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:42:23,643 - INFO -   Bracket s=2 final best score: 0.4678
2025-05-03 12:42:23,648 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=0.33
2025-05-03 12:42:23,652 - INFO -   -- Round i=0: Evaluating 3 configs with resource=0.33 --
2025-05-03 12:42:23,711 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:42:23,713 - INFO -   -- Round i=1: Evaluating 1 configs with resource=1.00 --
2025-05-03 12:42:23,758 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:42:23,758 - INFO -   Bracket s=1 final best score: 0.4301
2025-05-03 12:42:23,763 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=1.00
2025-05-03 12:42:23,766 - INFO -   -- Round i=0: Evaluating 3 configs with resource=1.00 --
2025-05-03 12:42:24,093 - INFO -   ** New Best Found (Score: 0.4884) at max resource ** Params: {'ccp_alpha': 0.00027098211790596967, 'criterion': 'log_loss', 'max_depth': 41, 'max_features': 'sqrt', 'min_samples_leaf': 12, 'min_samples_split': 24, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:42:24,094 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:42:24,094 - INFO -   Bracket s=0 final best score: 0.4884
2025-05-03 12:42:24,096 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 12:42:24,096 - INFO - Total configurations evaluated (approx): 20
2025-05-03 12:42:24,097 - INFO - Best Overall Score (f1_score): 0.4884
2025-05-03 12:42:24,097 - INFO - Best Params: {'ccp_alpha': 0.00027098211790596967, 'criterion': 'log_loss', 'max_depth': 41, 'max_features': 'sqrt', 'min_samples_leaf': 12, 'min_samples_split': 24, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:42:24,097 - INFO - [group_5] CART Best Params: {'ccp_alpha': 0.00027098211790596967, 'criterion': 'log_loss', 'max_depth': 41, 'max_features': 'sqrt', 'min_samples_leaf': 12, 'min_samples_split': 24, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.4884
2025-05-03 12:42:24,097 - INFO - --- [group_5] Running Random Forest HPO ---
2025-05-03 12:42:24,098 - INFO - --- [Random_Forest] Running Hyperband HPO ---
2025-05-03 12:42:24,099 - INFO - --- Starting Hyperband HPO ---
2025-05-03 12:42:24,099 - INFO - Model: RandomForestClassifier
2025-05-03 12:42:24,099 - INFO - Resource Type: iterations
2025-05-03 12:42:24,099 - INFO - Resource Range: [20, 300]
2025-05-03 12:42:24,099 - INFO - Eta: 3
2025-05-03 12:42:24,099 - INFO - Max Brackets (s_max): 2
2025-05-03 12:42:24,099 - INFO - Approx. Budget (B): 900.00
2025-05-03 12:42:24,099 - INFO - Scoring: f1_score
2025-05-03 12:42:24,102 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=33.33
2025-05-03 12:42:24,105 - INFO -   -- Round i=0: Evaluating 9 configs with resource=33.33 --
2025-05-03 12:43:26,247 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 12:43:26,247 - INFO -   -- Round i=1: Evaluating 3 configs with resource=100.00 --
2025-05-03 12:44:32,010 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:44:32,016 - INFO -   -- Round i=2: Evaluating 1 configs with resource=300.00 --
2025-05-03 12:45:56,796 - INFO -   ** New Best Found (Score: 0.7218) at max resource ** Params: {'bootstrap': False, 'ccp_alpha': 1.1456552628177777e-06, 'criterion': 'entropy', 'max_depth': 26, 'max_features': 0.5, 'min_samples_leaf': 10, 'min_samples_split': 32, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:45:56,798 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:45:56,799 - INFO -   Bracket s=2 final best score: 0.7218
2025-05-03 12:45:56,802 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=100.00
2025-05-03 12:45:56,802 - INFO -   -- Round i=0: Evaluating 3 configs with resource=100.00 --
2025-05-03 12:47:29,234 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:47:29,237 - INFO -   -- Round i=1: Evaluating 1 configs with resource=300.00 --
2025-05-03 12:48:58,374 - INFO -   ** New Best Found (Score: 0.7352) at max resource ** Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:48:58,374 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:48:58,374 - INFO -   Bracket s=1 final best score: 0.7352
2025-05-03 12:48:58,381 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=300.00
2025-05-03 12:48:58,386 - INFO -   -- Round i=0: Evaluating 3 configs with resource=300.00 --
2025-05-03 12:49:37,240 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:49:37,240 - INFO -   Bracket s=0 final best score: 0.7278
2025-05-03 12:49:37,240 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 12:49:37,240 - INFO - Total configurations evaluated (approx): 20
2025-05-03 12:49:37,240 - INFO - Best Overall Score (f1_score): 0.7352
2025-05-03 12:49:37,240 - INFO - Best Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:49:37,240 - INFO - [group_5] RF Best Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.7352
2025-05-03 12:49:37,240 - INFO - --- [group_5] Running XGBoost HPO ---
2025-05-03 12:49:37,253 - INFO - --- [XGBoost] Running Hyperband HPO ---
2025-05-03 12:49:37,253 - INFO - --- Starting Hyperband HPO ---
2025-05-03 12:49:37,254 - INFO - Model: XGBClassifier
2025-05-03 12:49:37,254 - INFO - Resource Type: iterations
2025-05-03 12:49:37,254 - INFO - Resource Range: [30, 500]
2025-05-03 12:49:37,254 - INFO - Eta: 3
2025-05-03 12:49:37,254 - INFO - Max Brackets (s_max): 2
2025-05-03 12:49:37,254 - INFO - Approx. Budget (B): 1500.00
2025-05-03 12:49:37,254 - INFO - Scoring: f1_score
2025-05-03 12:49:37,257 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=55.56
2025-05-03 12:49:37,260 - INFO -   -- Round i=0: Evaluating 9 configs with resource=55.56 --
2025-05-03 12:49:40,300 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 12:49:40,312 - INFO -   -- Round i=1: Evaluating 3 configs with resource=166.67 --
2025-05-03 12:49:42,999 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:49:43,001 - INFO -   -- Round i=2: Evaluating 1 configs with resource=500.00 --
2025-05-03 12:49:44,939 - INFO -   ** New Best Found (Score: 0.7795) at max resource ** Params: {'colsample_bytree': 0.671548352757404, 'eval_metric': 'logloss', 'gamma': 0.09305677512486618, 'learning_rate': 0.08192678537706805, 'max_depth': 10, 'min_child_weight': 2.5379710478017956, 'objective': 'binary:logistic', 'reg_alpha': 0.0015064017388305203, 'reg_lambda': 0.005018177793082854, 'subsample': 0.8487175162644316, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 12:49:44,940 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:49:44,940 - INFO -   Bracket s=2 final best score: 0.7795
2025-05-03 12:49:44,943 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=166.67
2025-05-03 12:49:44,950 - INFO -   -- Round i=0: Evaluating 3 configs with resource=166.67 --
2025-05-03 12:49:47,143 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:49:47,149 - INFO -   -- Round i=1: Evaluating 1 configs with resource=500.00 --
2025-05-03 12:49:48,900 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:49:48,900 - INFO -   Bracket s=1 final best score: 0.7633
2025-05-03 12:49:48,900 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=500.00
2025-05-03 12:49:48,913 - INFO -   -- Round i=0: Evaluating 3 configs with resource=500.00 --
2025-05-03 12:49:53,270 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:49:53,270 - INFO -   Bracket s=0 final best score: 0.7636
2025-05-03 12:49:53,270 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 12:49:53,270 - INFO - Total configurations evaluated (approx): 20
2025-05-03 12:49:53,270 - INFO - Best Overall Score (f1_score): 0.7795
2025-05-03 12:49:53,270 - INFO - Best Params: {'colsample_bytree': 0.671548352757404, 'eval_metric': 'logloss', 'gamma': 0.09305677512486618, 'learning_rate': 0.08192678537706805, 'max_depth': 10, 'min_child_weight': 2.5379710478017956, 'objective': 'binary:logistic', 'reg_alpha': 0.0015064017388305203, 'reg_lambda': 0.005018177793082854, 'subsample': 0.8487175162644316, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 12:49:53,270 - INFO - [group_5] XGB Best Params: {'colsample_bytree': 0.671548352757404, 'eval_metric': 'logloss', 'gamma': 0.09305677512486618, 'learning_rate': 0.08192678537706805, 'max_depth': 10, 'min_child_weight': 2.5379710478017956, 'objective': 'binary:logistic', 'reg_alpha': 0.0015064017388305203, 'reg_lambda': 0.005018177793082854, 'subsample': 0.8487175162644316, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}, Score: 0.7795
2025-05-03 12:49:53,270 - INFO - --- [group_5] Running LightGBM HPO ---
2025-05-03 12:49:53,278 - INFO - --- [LightGBM] Running Hyperband HPO ---
2025-05-03 12:49:53,278 - INFO - --- Starting Hyperband HPO ---
2025-05-03 12:49:53,278 - INFO - Model: LGBMClassifier
2025-05-03 12:49:53,279 - INFO - Resource Type: iterations
2025-05-03 12:49:53,279 - INFO - Resource Range: [30, 500]
2025-05-03 12:49:53,279 - INFO - Eta: 3
2025-05-03 12:49:53,279 - INFO - Max Brackets (s_max): 2
2025-05-03 12:49:53,279 - INFO - Approx. Budget (B): 1500.00
2025-05-03 12:49:53,279 - INFO - Scoring: f1_score
2025-05-03 12:49:53,282 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=55.56
2025-05-03 12:49:53,289 - INFO -   -- Round i=0: Evaluating 9 configs with resource=55.56 --
2025-05-03 12:49:54,464 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 12:49:54,464 - INFO -   -- Round i=1: Evaluating 3 configs with resource=166.67 --
2025-05-03 12:49:55,282 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:49:55,282 - INFO -   -- Round i=2: Evaluating 1 configs with resource=500.00 --
2025-05-03 12:49:55,836 - INFO -   ** New Best Found (Score: 0.7734) at max resource ** Params: {'colsample_bytree': 0.5422063747642943, 'learning_rate': 0.07885165402835125, 'max_depth': 7, 'metric': 'logloss', 'min_child_samples': 38, 'num_leaves': 83, 'objective': 'binary', 'reg_alpha': 0.000741705371224509, 'reg_lambda': 0.0409101946040011, 'subsample': 0.9160632720432271, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 12:49:55,921 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:49:55,922 - INFO -   Bracket s=2 final best score: 0.7734
2025-05-03 12:49:55,925 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=166.67
2025-05-03 12:49:55,931 - INFO -   -- Round i=0: Evaluating 3 configs with resource=166.67 --
2025-05-03 12:49:57,016 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:49:57,016 - INFO -   -- Round i=1: Evaluating 1 configs with resource=500.00 --
2025-05-03 12:49:57,864 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:49:57,864 - INFO -   Bracket s=1 final best score: 0.7720
2025-05-03 12:49:57,870 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=500.00
2025-05-03 12:49:57,877 - INFO -   -- Round i=0: Evaluating 3 configs with resource=500.00 --
2025-05-03 12:49:59,359 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:49:59,359 - INFO -   Bracket s=0 final best score: 0.7701
2025-05-03 12:49:59,361 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 12:49:59,361 - INFO - Total configurations evaluated (approx): 20
2025-05-03 12:49:59,361 - INFO - Best Overall Score (f1_score): 0.7734
2025-05-03 12:49:59,361 - INFO - Best Params: {'colsample_bytree': 0.5422063747642943, 'learning_rate': 0.07885165402835125, 'max_depth': 7, 'metric': 'logloss', 'min_child_samples': 38, 'num_leaves': 83, 'objective': 'binary', 'reg_alpha': 0.000741705371224509, 'reg_lambda': 0.0409101946040011, 'subsample': 0.9160632720432271, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 12:49:59,361 - INFO - [group_5] LGBM Best Params: {'colsample_bytree': 0.5422063747642943, 'learning_rate': 0.07885165402835125, 'max_depth': 7, 'metric': 'logloss', 'min_child_samples': 38, 'num_leaves': 83, 'objective': 'binary', 'reg_alpha': 0.000741705371224509, 'reg_lambda': 0.0409101946040011, 'subsample': 0.9160632720432271, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}, Score: 0.7734
2025-05-03 12:49:59,361 - INFO - [group_5] Successfully saved best parameters to best_params\group_5_best_params.json
2025-05-03 12:49:59,361 - INFO - --- Finished HPO for Group: group_5 in 688.66 seconds ---
2025-05-03 12:49:59,361 - INFO - 
============================== Running HPO for Group: group_6 ==============================
2025-05-03 12:49:59,361 - INFO - [group_6] Cleaning data...
2025-05-03 12:49:59,361 - INFO - Original dataset size: (27388, 136)
2025-05-03 12:49:59,385 - INFO - Dataset size after dropping NaNs: (27388, 70)
2025-05-03 12:49:59,386 - INFO - Value counts for target:
1 (Star): 1926
0 (Galaxy): 25462
2025-05-03 12:49:59,392 - INFO - [group_6] Splitting data (Train/Val only for HPO)...
2025-05-03 12:49:59,392 - INFO - Splitting data using 'stratified' strategy...
2025-05-03 12:49:59,392 - INFO - Target split ratios: Train=0.60, Val=0.10, Test=0.20, Cal=0.10
2025-05-03 12:49:59,416 - INFO - Train set shape: (16432, 69)
2025-05-03 12:49:59,428 - INFO - Validation set shape: (2738, 69)
2025-05-03 12:49:59,436 - INFO - Test set shape: (5478, 69)
2025-05-03 12:49:59,436 - INFO - Calibration set shape: (2740, 69)
2025-05-03 12:49:59,436 - INFO - Split lengths verification successful.
2025-05-03 12:49:59,437 - INFO - Data splitting complete.
2025-05-03 12:49:59,438 - INFO - Train target distribution:
acs_mu_class
0    0.929649
1    0.070351
Name: count, dtype: float64
2025-05-03 12:49:59,438 - INFO - Train target counts:
acs_mu_class
0    15276
1     1156
Name: count, dtype: int64
2025-05-03 12:49:59,439 - INFO - Validation target distribution:
acs_mu_class
0    0.929876
1    0.070124
Name: count, dtype: float64
2025-05-03 12:49:59,439 - INFO - Validation target counts:
acs_mu_class
0    2546
1     192
Name: count, dtype: int64
2025-05-03 12:49:59,439 - INFO - Test target distribution:
acs_mu_class
0    0.929719
1    0.070281
Name: count, dtype: float64
2025-05-03 12:49:59,440 - INFO - Test target counts:
acs_mu_class
0    5093
1     385
Name: count, dtype: int64
2025-05-03 12:49:59,440 - INFO - Calibration target distribution:
acs_mu_class
0    0.929562
1    0.070438
Name: count, dtype: float64
2025-05-03 12:49:59,440 - INFO - Calibration target counts:
acs_mu_class
0    2547
1     193
Name: count, dtype: int64
2025-05-03 12:49:59,442 - INFO - [group_6] Applying feature scaling (for SVM HPO)...
2025-05-03 12:49:59,442 - INFO - Applying StandardScaler to features...
2025-05-03 12:49:59,461 - INFO - Feature scaling complete.
2025-05-03 12:49:59,462 - INFO - --- [group_6] Running SVM HPO ---
2025-05-03 12:49:59,463 - INFO - --- [SVM] Running Hyperband HPO ---
2025-05-03 12:49:59,463 - INFO - --- Starting Hyperband HPO ---
2025-05-03 12:49:59,463 - INFO - Model: SVC
2025-05-03 12:49:59,463 - INFO - Resource Type: data_fraction
2025-05-03 12:49:59,463 - INFO - Resource Range: [0.1, 1.0]
2025-05-03 12:49:59,463 - INFO - Eta: 3
2025-05-03 12:49:59,463 - INFO - Max Brackets (s_max): 2
2025-05-03 12:49:59,463 - INFO - Approx. Budget (B): 3.00
2025-05-03 12:49:59,463 - INFO - Scoring: f1_score
2025-05-03 12:49:59,464 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=0.11
2025-05-03 12:49:59,470 - INFO -   -- Round i=0: Evaluating 9 configs with resource=0.11 --
2025-05-03 12:50:41,213 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 12:50:41,215 - INFO -   -- Round i=1: Evaluating 3 configs with resource=0.33 --
2025-05-03 12:55:02,398 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:55:02,400 - INFO -   -- Round i=2: Evaluating 1 configs with resource=1.00 --
2025-05-03 12:55:05,030 - INFO -   ** New Best Found (Score: 0.5786) at max resource ** Params: {'C': 0.0024259612444969317, 'coef0': 1.7431902751987698, 'degree': 2, 'gamma': 0.6681682093919618, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:55:05,031 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:55:05,031 - INFO -   Bracket s=2 final best score: 0.5786
2025-05-03 12:55:05,035 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=0.33
2025-05-03 12:55:05,040 - INFO -   -- Round i=0: Evaluating 3 configs with resource=0.33 --
2025-05-03 12:55:07,576 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:55:07,579 - INFO -   -- Round i=1: Evaluating 1 configs with resource=1.00 --
2025-05-03 12:55:31,890 - INFO -   ** New Best Found (Score: 0.5954) at max resource ** Params: {'C': 72.00503817038027, 'coef0': 1.2536223012228445, 'degree': 2, 'gamma': 0.03461859944484052, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:55:31,892 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:55:31,892 - INFO -   Bracket s=1 final best score: 0.5954
2025-05-03 12:55:31,894 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=1.00
2025-05-03 12:55:31,901 - INFO -   -- Round i=0: Evaluating 3 configs with resource=1.00 --
2025-05-03 12:58:22,363 - INFO -   ** New Best Found (Score: 0.6124) at max resource ** Params: {'C': 0.03097852707196491, 'coef0': 0.3499262631523865, 'degree': 4, 'gamma': 2.7850890691622254, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:58:22,369 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:58:22,369 - INFO -   Bracket s=0 final best score: 0.6124
2025-05-03 12:58:22,372 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 12:58:22,372 - INFO - Total configurations evaluated (approx): 20
2025-05-03 12:58:22,372 - INFO - Best Overall Score (f1_score): 0.6124
2025-05-03 12:58:22,372 - INFO - Best Params: {'C': 0.03097852707196491, 'coef0': 0.3499262631523865, 'degree': 4, 'gamma': 2.7850890691622254, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:58:22,372 - INFO - [group_6] SVM Best Params: {'C': 0.03097852707196491, 'coef0': 0.3499262631523865, 'degree': 4, 'gamma': 2.7850890691622254, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.6124
2025-05-03 12:58:22,372 - INFO - --- [group_6] Running CART HPO ---
2025-05-03 12:58:22,375 - INFO - --- [CART] Running Hyperband HPO ---
2025-05-03 12:58:22,375 - INFO - --- Starting Hyperband HPO ---
2025-05-03 12:58:22,375 - INFO - Model: DecisionTreeClassifier
2025-05-03 12:58:22,375 - INFO - Resource Type: data_fraction
2025-05-03 12:58:22,375 - INFO - Resource Range: [0.1, 1.0]
2025-05-03 12:58:22,375 - INFO - Eta: 3
2025-05-03 12:58:22,375 - INFO - Max Brackets (s_max): 2
2025-05-03 12:58:22,375 - INFO - Approx. Budget (B): 3.00
2025-05-03 12:58:22,375 - INFO - Scoring: f1_score
2025-05-03 12:58:22,378 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=0.11
2025-05-03 12:58:22,382 - INFO -   -- Round i=0: Evaluating 9 configs with resource=0.11 --
2025-05-03 12:58:22,508 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 12:58:22,512 - INFO -   -- Round i=1: Evaluating 3 configs with resource=0.33 --
2025-05-03 12:58:22,633 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:58:22,636 - INFO -   -- Round i=2: Evaluating 1 configs with resource=1.00 --
2025-05-03 12:58:22,726 - INFO -   ** New Best Found (Score: 0.4424) at max resource ** Params: {'ccp_alpha': 0.0003836096622706455, 'criterion': 'gini', 'max_depth': 32, 'max_features': 'sqrt', 'min_samples_leaf': 1, 'min_samples_split': 43, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:58:22,727 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:58:22,727 - INFO -   Bracket s=2 final best score: 0.4424
2025-05-03 12:58:22,727 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=0.33
2025-05-03 12:58:22,735 - INFO -   -- Round i=0: Evaluating 3 configs with resource=0.33 --
2025-05-03 12:58:22,794 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:58:22,799 - INFO -   -- Round i=1: Evaluating 1 configs with resource=1.00 --
2025-05-03 12:58:22,848 - INFO -   ** New Best Found (Score: 0.4942) at max resource ** Params: {'ccp_alpha': 3.2185620345457748e-06, 'criterion': 'log_loss', 'max_depth': 31, 'max_features': None, 'min_samples_leaf': 7, 'min_samples_split': 22, 'splitter': 'random', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:58:22,848 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 12:58:22,848 - INFO -   Bracket s=1 final best score: 0.4942
2025-05-03 12:58:22,856 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=1.00
2025-05-03 12:58:22,860 - INFO -   -- Round i=0: Evaluating 3 configs with resource=1.00 --
2025-05-03 12:58:23,239 - INFO -   ** New Best Found (Score: 0.5129) at max resource ** Params: {'ccp_alpha': 1.7480370654279986e-05, 'criterion': 'gini', 'max_depth': 4, 'max_features': None, 'min_samples_leaf': 10, 'min_samples_split': 5, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:58:23,240 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 12:58:23,241 - INFO -   Bracket s=0 final best score: 0.5129
2025-05-03 12:58:23,244 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 12:58:23,244 - INFO - Total configurations evaluated (approx): 20
2025-05-03 12:58:23,244 - INFO - Best Overall Score (f1_score): 0.5129
2025-05-03 12:58:23,244 - INFO - Best Params: {'ccp_alpha': 1.7480370654279986e-05, 'criterion': 'gini', 'max_depth': 4, 'max_features': None, 'min_samples_leaf': 10, 'min_samples_split': 5, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 12:58:23,244 - INFO - [group_6] CART Best Params: {'ccp_alpha': 1.7480370654279986e-05, 'criterion': 'gini', 'max_depth': 4, 'max_features': None, 'min_samples_leaf': 10, 'min_samples_split': 5, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.5129
2025-05-03 12:58:23,244 - INFO - --- [group_6] Running Random Forest HPO ---
2025-05-03 12:58:23,245 - INFO - --- [Random_Forest] Running Hyperband HPO ---
2025-05-03 12:58:23,245 - INFO - --- Starting Hyperband HPO ---
2025-05-03 12:58:23,245 - INFO - Model: RandomForestClassifier
2025-05-03 12:58:23,245 - INFO - Resource Type: iterations
2025-05-03 12:58:23,245 - INFO - Resource Range: [20, 300]
2025-05-03 12:58:23,245 - INFO - Eta: 3
2025-05-03 12:58:23,245 - INFO - Max Brackets (s_max): 2
2025-05-03 12:58:23,245 - INFO - Approx. Budget (B): 900.00
2025-05-03 12:58:23,245 - INFO - Scoring: f1_score
2025-05-03 12:58:23,248 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=33.33
2025-05-03 12:58:23,254 - INFO -   -- Round i=0: Evaluating 9 configs with resource=33.33 --
2025-05-03 12:59:38,743 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 12:59:38,743 - INFO -   -- Round i=1: Evaluating 3 configs with resource=100.00 --
2025-05-03 13:00:56,881 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:00:56,893 - INFO -   -- Round i=2: Evaluating 1 configs with resource=300.00 --
2025-05-03 13:02:42,560 - INFO -   ** New Best Found (Score: 0.7386) at max resource ** Params: {'bootstrap': False, 'ccp_alpha': 0.0001355770390242371, 'criterion': 'entropy', 'max_depth': 33, 'max_features': 0.5, 'min_samples_leaf': 1, 'min_samples_split': 43, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 13:02:42,561 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 13:02:42,562 - INFO -   Bracket s=2 final best score: 0.7386
2025-05-03 13:02:42,564 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=100.00
2025-05-03 13:02:42,564 - INFO -   -- Round i=0: Evaluating 3 configs with resource=100.00 --
2025-05-03 13:04:34,122 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:04:34,126 - INFO -   -- Round i=1: Evaluating 1 configs with resource=300.00 --
2025-05-03 13:06:20,912 - INFO -   ** New Best Found (Score: 0.7576) at max resource ** Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 13:06:20,912 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 13:06:20,912 - INFO -   Bracket s=1 final best score: 0.7576
2025-05-03 13:06:20,920 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=300.00
2025-05-03 13:06:20,923 - INFO -   -- Round i=0: Evaluating 3 configs with resource=300.00 --
2025-05-03 13:07:08,305 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:07:08,305 - INFO -   Bracket s=0 final best score: 0.7405
2025-05-03 13:07:08,305 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 13:07:08,305 - INFO - Total configurations evaluated (approx): 20
2025-05-03 13:07:08,305 - INFO - Best Overall Score (f1_score): 0.7576
2025-05-03 13:07:08,305 - INFO - Best Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 13:07:08,305 - INFO - [group_6] RF Best Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.7576
2025-05-03 13:07:08,305 - INFO - --- [group_6] Running XGBoost HPO ---
2025-05-03 13:07:08,311 - INFO - --- [XGBoost] Running Hyperband HPO ---
2025-05-03 13:07:08,311 - INFO - --- Starting Hyperband HPO ---
2025-05-03 13:07:08,311 - INFO - Model: XGBClassifier
2025-05-03 13:07:08,311 - INFO - Resource Type: iterations
2025-05-03 13:07:08,311 - INFO - Resource Range: [30, 500]
2025-05-03 13:07:08,311 - INFO - Eta: 3
2025-05-03 13:07:08,311 - INFO - Max Brackets (s_max): 2
2025-05-03 13:07:08,311 - INFO - Approx. Budget (B): 1500.00
2025-05-03 13:07:08,311 - INFO - Scoring: f1_score
2025-05-03 13:07:08,311 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=55.56
2025-05-03 13:07:08,319 - INFO -   -- Round i=0: Evaluating 9 configs with resource=55.56 --
2025-05-03 13:07:11,565 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 13:07:11,565 - INFO -   -- Round i=1: Evaluating 3 configs with resource=166.67 --
2025-05-03 13:07:14,356 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:07:14,359 - INFO -   -- Round i=2: Evaluating 1 configs with resource=500.00 --
2025-05-03 13:07:16,405 - INFO -   ** New Best Found (Score: 0.7751) at max resource ** Params: {'colsample_bytree': 0.671548352757404, 'eval_metric': 'logloss', 'gamma': 0.09305677512486618, 'learning_rate': 0.08192678537706805, 'max_depth': 10, 'min_child_weight': 2.5379710478017956, 'objective': 'binary:logistic', 'reg_alpha': 0.0015064017388305203, 'reg_lambda': 0.005018177793082854, 'subsample': 0.8487175162644316, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 13:07:16,406 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 13:07:16,406 - INFO -   Bracket s=2 final best score: 0.7751
2025-05-03 13:07:16,408 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=166.67
2025-05-03 13:07:16,414 - INFO -   -- Round i=0: Evaluating 3 configs with resource=166.67 --
2025-05-03 13:07:18,880 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:07:18,892 - INFO -   -- Round i=1: Evaluating 1 configs with resource=500.00 --
2025-05-03 13:07:20,862 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 13:07:20,862 - INFO -   Bracket s=1 final best score: 0.7651
2025-05-03 13:07:20,869 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=500.00
2025-05-03 13:07:20,875 - INFO -   -- Round i=0: Evaluating 3 configs with resource=500.00 --
2025-05-03 13:07:25,535 - INFO -   ** New Best Found (Score: 0.7882) at max resource ** Params: {'colsample_bytree': 0.9399063351767167, 'eval_metric': 'logloss', 'gamma': 0.0001335978952467058, 'learning_rate': 0.0760037620756919, 'max_depth': 10, 'min_child_weight': 1.624776257487987, 'objective': 'binary:logistic', 'reg_alpha': 0.00024991242947225575, 'reg_lambda': 0.02544659616528781, 'subsample': 0.5818175813025477, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 13:07:25,536 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:07:25,536 - INFO -   Bracket s=0 final best score: 0.7882
2025-05-03 13:07:25,539 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 13:07:25,539 - INFO - Total configurations evaluated (approx): 20
2025-05-03 13:07:25,539 - INFO - Best Overall Score (f1_score): 0.7882
2025-05-03 13:07:25,539 - INFO - Best Params: {'colsample_bytree': 0.9399063351767167, 'eval_metric': 'logloss', 'gamma': 0.0001335978952467058, 'learning_rate': 0.0760037620756919, 'max_depth': 10, 'min_child_weight': 1.624776257487987, 'objective': 'binary:logistic', 'reg_alpha': 0.00024991242947225575, 'reg_lambda': 0.02544659616528781, 'subsample': 0.5818175813025477, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 13:07:25,540 - INFO - [group_6] XGB Best Params: {'colsample_bytree': 0.9399063351767167, 'eval_metric': 'logloss', 'gamma': 0.0001335978952467058, 'learning_rate': 0.0760037620756919, 'max_depth': 10, 'min_child_weight': 1.624776257487987, 'objective': 'binary:logistic', 'reg_alpha': 0.00024991242947225575, 'reg_lambda': 0.02544659616528781, 'subsample': 0.5818175813025477, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}, Score: 0.7882
2025-05-03 13:07:25,540 - INFO - --- [group_6] Running LightGBM HPO ---
2025-05-03 13:07:25,540 - INFO - --- [LightGBM] Running Hyperband HPO ---
2025-05-03 13:07:25,540 - INFO - --- Starting Hyperband HPO ---
2025-05-03 13:07:25,540 - INFO - Model: LGBMClassifier
2025-05-03 13:07:25,540 - INFO - Resource Type: iterations
2025-05-03 13:07:25,540 - INFO - Resource Range: [30, 500]
2025-05-03 13:07:25,540 - INFO - Eta: 3
2025-05-03 13:07:25,540 - INFO - Max Brackets (s_max): 2
2025-05-03 13:07:25,540 - INFO - Approx. Budget (B): 1500.00
2025-05-03 13:07:25,540 - INFO - Scoring: f1_score
2025-05-03 13:07:25,540 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=55.56
2025-05-03 13:07:25,555 - INFO -   -- Round i=0: Evaluating 9 configs with resource=55.56 --
2025-05-03 13:07:26,861 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 13:07:26,862 - INFO -   -- Round i=1: Evaluating 3 configs with resource=166.67 --
2025-05-03 13:07:27,771 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:07:27,774 - INFO -   -- Round i=2: Evaluating 1 configs with resource=500.00 --
2025-05-03 13:07:28,765 - INFO -   ** New Best Found (Score: 0.7613) at max resource ** Params: {'colsample_bytree': 0.587568255527738, 'learning_rate': 0.04025491647638509, 'max_depth': 10, 'metric': 'logloss', 'min_child_samples': 59, 'num_leaves': 115, 'objective': 'binary', 'reg_alpha': 0.04521012452572427, 'reg_lambda': 0.07784122133813023, 'subsample': 0.7102534887199938, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 13:07:28,765 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 13:07:28,765 - INFO -   Bracket s=2 final best score: 0.7613
2025-05-03 13:07:28,765 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=166.67
2025-05-03 13:07:28,775 - INFO -   -- Round i=0: Evaluating 3 configs with resource=166.67 --
2025-05-03 13:07:30,008 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:07:30,013 - INFO -   -- Round i=1: Evaluating 1 configs with resource=500.00 --
2025-05-03 13:07:31,353 - INFO -   ** New Best Found (Score: 0.7645) at max resource ** Params: {'colsample_bytree': 0.9039964094408228, 'learning_rate': 0.0797677538429512, 'max_depth': 11, 'metric': 'logloss', 'min_child_samples': 13, 'num_leaves': 127, 'objective': 'binary', 'reg_alpha': 0.012938744945205824, 'reg_lambda': 0.03825756838214059, 'subsample': 0.7039257128340015, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 13:07:31,355 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 13:07:31,355 - INFO -   Bracket s=1 final best score: 0.7645
2025-05-03 13:07:31,359 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=500.00
2025-05-03 13:07:31,364 - INFO -   -- Round i=0: Evaluating 3 configs with resource=500.00 --
2025-05-03 13:07:33,084 - INFO -   ** New Best Found (Score: 0.7674) at max resource ** Params: {'colsample_bytree': 0.9252309722947032, 'learning_rate': 0.10579748529279263, 'max_depth': 10, 'metric': 'logloss', 'min_child_samples': 17, 'num_leaves': 27, 'objective': 'binary', 'reg_alpha': 0.00024991242947225575, 'reg_lambda': 0.02544659616528781, 'subsample': 0.5818175813025477, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 13:07:33,084 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:07:33,084 - INFO -   Bracket s=0 final best score: 0.7674
2025-05-03 13:07:33,092 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 13:07:33,092 - INFO - Total configurations evaluated (approx): 20
2025-05-03 13:07:33,092 - INFO - Best Overall Score (f1_score): 0.7674
2025-05-03 13:07:33,092 - INFO - Best Params: {'colsample_bytree': 0.9252309722947032, 'learning_rate': 0.10579748529279263, 'max_depth': 10, 'metric': 'logloss', 'min_child_samples': 17, 'num_leaves': 27, 'objective': 'binary', 'reg_alpha': 0.00024991242947225575, 'reg_lambda': 0.02544659616528781, 'subsample': 0.5818175813025477, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 13:07:33,092 - INFO - [group_6] LGBM Best Params: {'colsample_bytree': 0.9252309722947032, 'learning_rate': 0.10579748529279263, 'max_depth': 10, 'metric': 'logloss', 'min_child_samples': 17, 'num_leaves': 27, 'objective': 'binary', 'reg_alpha': 0.00024991242947225575, 'reg_lambda': 0.02544659616528781, 'subsample': 0.5818175813025477, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}, Score: 0.7674
2025-05-03 13:07:33,092 - INFO - [group_6] Successfully saved best parameters to best_params\group_6_best_params.json
2025-05-03 13:07:33,092 - INFO - --- Finished HPO for Group: group_6 in 1053.73 seconds ---
2025-05-03 13:07:33,092 - INFO - 
============================== Running HPO for Group: group_7 ==============================
2025-05-03 13:07:33,092 - INFO - [group_7] Cleaning data...
2025-05-03 13:07:33,092 - INFO - Original dataset size: (27388, 136)
2025-05-03 13:07:33,129 - INFO - Dataset size after dropping NaNs: (27388, 95)
2025-05-03 13:07:33,130 - INFO - Value counts for target:
1 (Star): 1926
0 (Galaxy): 25462
2025-05-03 13:07:33,140 - INFO - [group_7] Splitting data (Train/Val only for HPO)...
2025-05-03 13:07:33,140 - INFO - Splitting data using 'stratified' strategy...
2025-05-03 13:07:33,140 - INFO - Target split ratios: Train=0.60, Val=0.10, Test=0.20, Cal=0.10
2025-05-03 13:07:33,172 - INFO - Train set shape: (16432, 94)
2025-05-03 13:07:33,179 - INFO - Validation set shape: (2738, 94)
2025-05-03 13:07:33,183 - INFO - Test set shape: (5478, 94)
2025-05-03 13:07:33,183 - INFO - Calibration set shape: (2740, 94)
2025-05-03 13:07:33,183 - INFO - Split lengths verification successful.
2025-05-03 13:07:33,183 - INFO - Data splitting complete.
2025-05-03 13:07:33,183 - INFO - Train target distribution:
acs_mu_class
0    0.929649
1    0.070351
Name: count, dtype: float64
2025-05-03 13:07:33,183 - INFO - Train target counts:
acs_mu_class
0    15276
1     1156
Name: count, dtype: int64
2025-05-03 13:07:33,183 - INFO - Validation target distribution:
acs_mu_class
0    0.929876
1    0.070124
Name: count, dtype: float64
2025-05-03 13:07:33,183 - INFO - Validation target counts:
acs_mu_class
0    2546
1     192
Name: count, dtype: int64
2025-05-03 13:07:33,183 - INFO - Test target distribution:
acs_mu_class
0    0.929719
1    0.070281
Name: count, dtype: float64
2025-05-03 13:07:33,183 - INFO - Test target counts:
acs_mu_class
0    5093
1     385
Name: count, dtype: int64
2025-05-03 13:07:33,183 - INFO - Calibration target distribution:
acs_mu_class
0    0.929562
1    0.070438
Name: count, dtype: float64
2025-05-03 13:07:33,183 - INFO - Calibration target counts:
acs_mu_class
0    2547
1     193
Name: count, dtype: int64
2025-05-03 13:07:33,183 - INFO - [group_7] Applying feature scaling (for SVM HPO)...
2025-05-03 13:07:33,183 - INFO - Applying StandardScaler to features...
2025-05-03 13:07:33,207 - INFO - Feature scaling complete.
2025-05-03 13:07:33,207 - INFO - --- [group_7] Running SVM HPO ---
2025-05-03 13:07:33,207 - INFO - --- [SVM] Running Hyperband HPO ---
2025-05-03 13:07:33,207 - INFO - --- Starting Hyperband HPO ---
2025-05-03 13:07:33,207 - INFO - Model: SVC
2025-05-03 13:07:33,207 - INFO - Resource Type: data_fraction
2025-05-03 13:07:33,207 - INFO - Resource Range: [0.1, 1.0]
2025-05-03 13:07:33,207 - INFO - Eta: 3
2025-05-03 13:07:33,207 - INFO - Max Brackets (s_max): 2
2025-05-03 13:07:33,207 - INFO - Approx. Budget (B): 3.00
2025-05-03 13:07:33,207 - INFO - Scoring: f1_score
2025-05-03 13:07:33,213 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=0.11
2025-05-03 13:07:33,219 - INFO -   -- Round i=0: Evaluating 9 configs with resource=0.11 --
2025-05-03 13:08:22,317 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 13:08:22,321 - INFO -   -- Round i=1: Evaluating 3 configs with resource=0.33 --
2025-05-03 13:17:26,885 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:17:26,887 - INFO -   -- Round i=2: Evaluating 1 configs with resource=1.00 --
2025-05-03 13:17:29,639 - INFO -   ** New Best Found (Score: 0.5579) at max resource ** Params: {'C': 0.0024259612444969317, 'coef0': 1.7431902751987698, 'degree': 2, 'gamma': 0.6681682093919618, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 13:17:29,640 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 13:17:29,640 - INFO -   Bracket s=2 final best score: 0.5579
2025-05-03 13:17:29,645 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=0.33
2025-05-03 13:17:29,651 - INFO -   -- Round i=0: Evaluating 3 configs with resource=0.33 --
2025-05-03 13:17:32,302 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:17:32,306 - INFO -   -- Round i=1: Evaluating 1 configs with resource=1.00 --
2025-05-03 13:17:41,505 - INFO -   ** New Best Found (Score: 0.5714) at max resource ** Params: {'C': 72.00503817038027, 'coef0': 1.2536223012228445, 'degree': 2, 'gamma': 0.03461859944484052, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 13:17:41,505 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 13:17:41,505 - INFO -   Bracket s=1 final best score: 0.5714
2025-05-03 13:17:41,505 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=1.00
2025-05-03 13:17:41,511 - INFO -   -- Round i=0: Evaluating 3 configs with resource=1.00 --
2025-05-03 13:24:00,026 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:24:00,026 - INFO -   Bracket s=0 final best score: 0.5450
2025-05-03 13:24:00,030 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 13:24:00,030 - INFO - Total configurations evaluated (approx): 20
2025-05-03 13:24:00,030 - INFO - Best Overall Score (f1_score): 0.5714
2025-05-03 13:24:00,030 - INFO - Best Params: {'C': 72.00503817038027, 'coef0': 1.2536223012228445, 'degree': 2, 'gamma': 0.03461859944484052, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 13:24:00,030 - INFO - [group_7] SVM Best Params: {'C': 72.00503817038027, 'coef0': 1.2536223012228445, 'degree': 2, 'gamma': 0.03461859944484052, 'kernel': 'poly', 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.5714
2025-05-03 13:24:00,030 - INFO - --- [group_7] Running CART HPO ---
2025-05-03 13:24:00,032 - INFO - --- [CART] Running Hyperband HPO ---
2025-05-03 13:24:00,032 - INFO - --- Starting Hyperband HPO ---
2025-05-03 13:24:00,032 - INFO - Model: DecisionTreeClassifier
2025-05-03 13:24:00,032 - INFO - Resource Type: data_fraction
2025-05-03 13:24:00,032 - INFO - Resource Range: [0.1, 1.0]
2025-05-03 13:24:00,032 - INFO - Eta: 3
2025-05-03 13:24:00,032 - INFO - Max Brackets (s_max): 2
2025-05-03 13:24:00,032 - INFO - Approx. Budget (B): 3.00
2025-05-03 13:24:00,032 - INFO - Scoring: f1_score
2025-05-03 13:24:00,035 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=0.11
2025-05-03 13:24:00,040 - INFO -   -- Round i=0: Evaluating 9 configs with resource=0.11 --
2025-05-03 13:24:00,187 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 13:24:00,189 - INFO -   -- Round i=1: Evaluating 3 configs with resource=0.33 --
2025-05-03 13:24:00,310 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:24:00,315 - INFO -   -- Round i=2: Evaluating 1 configs with resource=1.00 --
2025-05-03 13:24:00,387 - INFO -   ** New Best Found (Score: 0.4675) at max resource ** Params: {'ccp_alpha': 1.685787245621472e-05, 'criterion': 'entropy', 'max_depth': 38, 'max_features': None, 'min_samples_leaf': 5, 'min_samples_split': 31, 'splitter': 'random', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 13:24:00,388 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 13:24:00,388 - INFO -   Bracket s=2 final best score: 0.4675
2025-05-03 13:24:00,389 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=0.33
2025-05-03 13:24:00,394 - INFO -   -- Round i=0: Evaluating 3 configs with resource=0.33 --
2025-05-03 13:24:00,474 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:24:00,475 - INFO -   -- Round i=1: Evaluating 1 configs with resource=1.00 --
2025-05-03 13:24:00,547 - INFO -   ** New Best Found (Score: 0.5000) at max resource ** Params: {'ccp_alpha': 3.2185620345457748e-06, 'criterion': 'log_loss', 'max_depth': 31, 'max_features': None, 'min_samples_leaf': 7, 'min_samples_split': 22, 'splitter': 'random', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 13:24:00,547 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 13:24:00,547 - INFO -   Bracket s=1 final best score: 0.5000
2025-05-03 13:24:00,552 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=1.00
2025-05-03 13:24:00,558 - INFO -   -- Round i=0: Evaluating 3 configs with resource=1.00 --
2025-05-03 13:24:00,952 - INFO -   ** New Best Found (Score: 0.5129) at max resource ** Params: {'ccp_alpha': 1.7480370654279986e-05, 'criterion': 'gini', 'max_depth': 4, 'max_features': None, 'min_samples_leaf': 10, 'min_samples_split': 5, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 13:24:00,952 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:24:00,952 - INFO -   Bracket s=0 final best score: 0.5129
2025-05-03 13:24:00,960 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 13:24:00,960 - INFO - Total configurations evaluated (approx): 20
2025-05-03 13:24:00,960 - INFO - Best Overall Score (f1_score): 0.5129
2025-05-03 13:24:00,960 - INFO - Best Params: {'ccp_alpha': 1.7480370654279986e-05, 'criterion': 'gini', 'max_depth': 4, 'max_features': None, 'min_samples_leaf': 10, 'min_samples_split': 5, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 13:24:00,960 - INFO - [group_7] CART Best Params: {'ccp_alpha': 1.7480370654279986e-05, 'criterion': 'gini', 'max_depth': 4, 'max_features': None, 'min_samples_leaf': 10, 'min_samples_split': 5, 'splitter': 'best', 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.5129
2025-05-03 13:24:00,960 - INFO - --- [group_7] Running Random Forest HPO ---
2025-05-03 13:24:00,962 - INFO - --- [Random_Forest] Running Hyperband HPO ---
2025-05-03 13:24:00,962 - INFO - --- Starting Hyperband HPO ---
2025-05-03 13:24:00,962 - INFO - Model: RandomForestClassifier
2025-05-03 13:24:00,962 - INFO - Resource Type: iterations
2025-05-03 13:24:00,962 - INFO - Resource Range: [20, 300]
2025-05-03 13:24:00,962 - INFO - Eta: 3
2025-05-03 13:24:00,962 - INFO - Max Brackets (s_max): 2
2025-05-03 13:24:00,962 - INFO - Approx. Budget (B): 900.00
2025-05-03 13:24:00,962 - INFO - Scoring: f1_score
2025-05-03 13:24:00,964 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=33.33
2025-05-03 13:24:00,969 - INFO -   -- Round i=0: Evaluating 9 configs with resource=33.33 --
2025-05-03 13:25:21,334 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 13:25:21,337 - INFO -   -- Round i=1: Evaluating 3 configs with resource=100.00 --
2025-05-03 13:26:44,424 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:26:44,428 - INFO -   -- Round i=2: Evaluating 1 configs with resource=300.00 --
2025-05-03 13:28:38,371 - INFO -   ** New Best Found (Score: 0.7356) at max resource ** Params: {'bootstrap': False, 'ccp_alpha': 0.0001355770390242371, 'criterion': 'entropy', 'max_depth': 33, 'max_features': 0.5, 'min_samples_leaf': 1, 'min_samples_split': 43, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 13:28:38,373 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 13:28:38,373 - INFO -   Bracket s=2 final best score: 0.7356
2025-05-03 13:28:38,377 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=100.00
2025-05-03 13:28:38,380 - INFO -   -- Round i=0: Evaluating 3 configs with resource=100.00 --
2025-05-03 13:30:38,557 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:30:38,559 - INFO -   -- Round i=1: Evaluating 1 configs with resource=300.00 --
2025-05-03 13:32:35,195 - INFO -   ** New Best Found (Score: 0.7401) at max resource ** Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 13:32:35,197 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 13:32:35,197 - INFO -   Bracket s=1 final best score: 0.7401
2025-05-03 13:32:35,197 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=300.00
2025-05-03 13:32:35,203 - INFO -   -- Round i=0: Evaluating 3 configs with resource=300.00 --
2025-05-03 13:33:15,391 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:33:15,391 - INFO -   Bracket s=0 final best score: 0.7310
2025-05-03 13:33:15,394 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 13:33:15,394 - INFO - Total configurations evaluated (approx): 20
2025-05-03 13:33:15,394 - INFO - Best Overall Score (f1_score): 0.7401
2025-05-03 13:33:15,394 - INFO - Best Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}
2025-05-03 13:33:15,394 - INFO - [group_7] RF Best Params: {'bootstrap': False, 'ccp_alpha': 9.523997498642667e-07, 'criterion': 'entropy', 'max_depth': 24, 'max_features': 0.5, 'min_samples_leaf': 4, 'min_samples_split': 7, 'random_state': 33, 'class_weight': 'balanced'}, Score: 0.7401
2025-05-03 13:33:15,394 - INFO - --- [group_7] Running XGBoost HPO ---
2025-05-03 13:33:15,396 - INFO - --- [XGBoost] Running Hyperband HPO ---
2025-05-03 13:33:15,396 - INFO - --- Starting Hyperband HPO ---
2025-05-03 13:33:15,396 - INFO - Model: XGBClassifier
2025-05-03 13:33:15,396 - INFO - Resource Type: iterations
2025-05-03 13:33:15,396 - INFO - Resource Range: [30, 500]
2025-05-03 13:33:15,396 - INFO - Eta: 3
2025-05-03 13:33:15,396 - INFO - Max Brackets (s_max): 2
2025-05-03 13:33:15,396 - INFO - Approx. Budget (B): 1500.00
2025-05-03 13:33:15,396 - INFO - Scoring: f1_score
2025-05-03 13:33:15,400 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=55.56
2025-05-03 13:33:15,406 - INFO -   -- Round i=0: Evaluating 9 configs with resource=55.56 --
2025-05-03 13:33:19,383 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 13:33:19,384 - INFO -   -- Round i=1: Evaluating 3 configs with resource=166.67 --
2025-05-03 13:33:22,860 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:33:22,864 - INFO -   -- Round i=2: Evaluating 1 configs with resource=500.00 --
2025-05-03 13:33:25,024 - INFO -   ** New Best Found (Score: 0.7749) at max resource ** Params: {'colsample_bytree': 0.9121655978614853, 'eval_metric': 'logloss', 'gamma': 0.02349697204033308, 'learning_rate': 0.10681467052331052, 'max_depth': 8, 'min_child_weight': 7.7379802149848596, 'objective': 'binary:logistic', 'reg_alpha': 8.407080271524405, 'reg_lambda': 0.004198585696776684, 'subsample': 0.7198992394624828, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 13:33:25,025 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 13:33:25,026 - INFO -   Bracket s=2 final best score: 0.7749
2025-05-03 13:33:25,026 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=166.67
2025-05-03 13:33:25,034 - INFO -   -- Round i=0: Evaluating 3 configs with resource=166.67 --
2025-05-03 13:33:28,050 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:33:28,050 - INFO -   -- Round i=1: Evaluating 1 configs with resource=500.00 --
2025-05-03 13:33:30,022 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 13:33:30,022 - INFO -   Bracket s=1 final best score: 0.7746
2025-05-03 13:33:30,026 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=500.00
2025-05-03 13:33:30,026 - INFO -   -- Round i=0: Evaluating 3 configs with resource=500.00 --
2025-05-03 13:33:35,886 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:33:35,886 - INFO -   Bracket s=0 final best score: 0.7711
2025-05-03 13:33:35,895 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 13:33:35,895 - INFO - Total configurations evaluated (approx): 20
2025-05-03 13:33:35,895 - INFO - Best Overall Score (f1_score): 0.7749
2025-05-03 13:33:35,895 - INFO - Best Params: {'colsample_bytree': 0.9121655978614853, 'eval_metric': 'logloss', 'gamma': 0.02349697204033308, 'learning_rate': 0.10681467052331052, 'max_depth': 8, 'min_child_weight': 7.7379802149848596, 'objective': 'binary:logistic', 'reg_alpha': 8.407080271524405, 'reg_lambda': 0.004198585696776684, 'subsample': 0.7198992394624828, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 13:33:35,895 - INFO - [group_7] XGB Best Params: {'colsample_bytree': 0.9121655978614853, 'eval_metric': 'logloss', 'gamma': 0.02349697204033308, 'learning_rate': 0.10681467052331052, 'max_depth': 8, 'min_child_weight': 7.7379802149848596, 'objective': 'binary:logistic', 'reg_alpha': 8.407080271524405, 'reg_lambda': 0.004198585696776684, 'subsample': 0.7198992394624828, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}, Score: 0.7749
2025-05-03 13:33:35,896 - INFO - --- [group_7] Running LightGBM HPO ---
2025-05-03 13:33:35,899 - INFO - --- [LightGBM] Running Hyperband HPO ---
2025-05-03 13:33:35,899 - INFO - --- Starting Hyperband HPO ---
2025-05-03 13:33:35,899 - INFO - Model: LGBMClassifier
2025-05-03 13:33:35,899 - INFO - Resource Type: iterations
2025-05-03 13:33:35,899 - INFO - Resource Range: [30, 500]
2025-05-03 13:33:35,899 - INFO - Eta: 3
2025-05-03 13:33:35,899 - INFO - Max Brackets (s_max): 2
2025-05-03 13:33:35,899 - INFO - Approx. Budget (B): 1500.00
2025-05-03 13:33:35,899 - INFO - Scoring: f1_score
2025-05-03 13:33:35,904 - INFO - 
>> Bracket s=2: n_configs=9, r_initial=55.56
2025-05-03 13:33:35,914 - INFO -   -- Round i=0: Evaluating 9 configs with resource=55.56 --
2025-05-03 13:33:37,626 - INFO -   -- Round i=0: Completed 9 evaluations. Keeping top 3 configs. --
2025-05-03 13:33:37,633 - INFO -   -- Round i=1: Evaluating 3 configs with resource=166.67 --
2025-05-03 13:33:38,868 - INFO -   -- Round i=1: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:33:38,868 - INFO -   -- Round i=2: Evaluating 1 configs with resource=500.00 --
2025-05-03 13:33:39,766 - INFO -   ** New Best Found (Score: 0.7561) at max resource ** Params: {'colsample_bytree': 0.5422063747642943, 'learning_rate': 0.07885165402835125, 'max_depth': 7, 'metric': 'logloss', 'min_child_samples': 38, 'num_leaves': 83, 'objective': 'binary', 'reg_alpha': 0.000741705371224509, 'reg_lambda': 0.0409101946040011, 'subsample': 0.9160632720432271, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 13:33:39,766 - INFO -   -- Round i=2: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 13:33:39,766 - INFO -   Bracket s=2 final best score: 0.7561
2025-05-03 13:33:39,773 - INFO - 
>> Bracket s=1: n_configs=3, r_initial=166.67
2025-05-03 13:33:39,780 - INFO -   -- Round i=0: Evaluating 3 configs with resource=166.67 --
2025-05-03 13:33:41,583 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:33:41,583 - INFO -   -- Round i=1: Evaluating 1 configs with resource=500.00 --
2025-05-03 13:33:43,517 - INFO -   ** New Best Found (Score: 0.7674) at max resource ** Params: {'colsample_bytree': 0.9039964094408228, 'learning_rate': 0.0797677538429512, 'max_depth': 11, 'metric': 'logloss', 'min_child_samples': 13, 'num_leaves': 127, 'objective': 'binary', 'reg_alpha': 0.012938744945205824, 'reg_lambda': 0.03825756838214059, 'subsample': 0.7039257128340015, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 13:33:43,518 - INFO -   -- Round i=1: Completed 1 evaluations. Keeping top 0 configs. --
2025-05-03 13:33:43,519 - INFO -   Bracket s=1 final best score: 0.7674
2025-05-03 13:33:43,523 - INFO - 
>> Bracket s=0: n_configs=3, r_initial=500.00
2025-05-03 13:33:43,531 - INFO -   -- Round i=0: Evaluating 3 configs with resource=500.00 --
2025-05-03 13:33:46,026 - INFO -   -- Round i=0: Completed 3 evaluations. Keeping top 1 configs. --
2025-05-03 13:33:46,026 - INFO -   Bracket s=0 final best score: 0.7660
2025-05-03 13:33:46,033 - INFO - 
--- Hyperband HPO Finished ---
2025-05-03 13:33:46,033 - INFO - Total configurations evaluated (approx): 20
2025-05-03 13:33:46,033 - INFO - Best Overall Score (f1_score): 0.7674
2025-05-03 13:33:46,034 - INFO - Best Params: {'colsample_bytree': 0.9039964094408228, 'learning_rate': 0.0797677538429512, 'max_depth': 11, 'metric': 'logloss', 'min_child_samples': 13, 'num_leaves': 127, 'objective': 'binary', 'reg_alpha': 0.012938744945205824, 'reg_lambda': 0.03825756838214059, 'subsample': 0.7039257128340015, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}
2025-05-03 13:33:46,034 - INFO - [group_7] LGBM Best Params: {'colsample_bytree': 0.9039964094408228, 'learning_rate': 0.0797677538429512, 'max_depth': 11, 'metric': 'logloss', 'min_child_samples': 13, 'num_leaves': 127, 'objective': 'binary', 'reg_alpha': 0.012938744945205824, 'reg_lambda': 0.03825756838214059, 'subsample': 0.7039257128340015, 'verbose': -1, 'random_state': 33, 'scale_pos_weight': 13.214532871972319}, Score: 0.7674
2025-05-03 13:33:46,035 - INFO - [group_7] Successfully saved best parameters to best_params\group_7_best_params.json
2025-05-03 13:33:46,035 - INFO - --- Finished HPO for Group: group_7 in 1572.94 seconds ---
2025-05-03 13:33:46,038 - INFO - 
============================== Finished HPO for all groups in 11152.81 seconds ==============================
