2025-05-06 19:57:47,207 - INFO - DataFrame created with shape: (27389, 136)
2025-05-06 19:57:47,207 - INFO - Original class counts:
2025-05-06 19:57:47,213 - INFO - acs_mu_class
1    25462
2     1926
3        1
2025-05-06 19:57:47,213 - INFO - Number of fake detections (class 3): 1
2025-05-06 19:57:47,219 - INFO - After dropping fakes and mapping classes (0: Galaxy, 1: Star):
2025-05-06 19:57:47,225 - INFO - acs_mu_class
0    25462
1     1926
2025-05-06 19:58:14,690 - INFO - Starting main workflow loop for groups: ['group_1', 'group_2', 'group_3', 'group_4', 'group_5', 'group_6', 'group_7']
2025-05-06 19:58:14,852 - INFO - 
============================== Processing Feature Group: group_1 ==============================
2025-05-06 19:58:14,852 - INFO - [group_1] Successfully loaded best parameters from best_params\group_1_best_params.json
2025-05-06 19:58:14,852 - INFO - [group_1] Cleaning data...
2025-05-06 19:58:14,852 - INFO - Original dataset size: (27388, 136)
2025-05-06 19:58:14,852 - INFO - Dataset size after dropping NaNs: (27388, 11)
2025-05-06 19:58:14,852 - INFO - Value counts for target:
1 (Star): 1926
0 (Galaxy): 25462
2025-05-06 19:58:14,852 - INFO - [group_1] Splitting data (Train/Val/Test/Cal)...
2025-05-06 19:58:14,852 - INFO - Splitting data using 'stratified' strategy...
2025-05-06 19:58:14,852 - INFO - Target split ratios: Train=0.60, Val=0.10, Test=0.20, Cal=0.10
2025-05-06 19:58:14,877 - INFO - Train set shape: (16432, 10)
2025-05-06 19:58:14,882 - INFO - Validation set shape: (2738, 10)
2025-05-06 19:58:14,884 - INFO - Test set shape: (5478, 10)
2025-05-06 19:58:14,884 - INFO - Calibration set shape: (2740, 10)
2025-05-06 19:58:14,884 - INFO - Split lengths verification successful.
2025-05-06 19:58:14,884 - INFO - Data splitting complete.
2025-05-06 19:58:14,885 - INFO - Train target distribution:
acs_mu_class
0    0.929649
1    0.070351
Name: count, dtype: float64
2025-05-06 19:58:14,885 - INFO - Train target counts:
acs_mu_class
0    15276
1     1156
Name: count, dtype: int64
2025-05-06 19:58:14,886 - INFO - Validation target distribution:
acs_mu_class
0    0.929876
1    0.070124
Name: count, dtype: float64
2025-05-06 19:58:14,886 - INFO - Validation target counts:
acs_mu_class
0    2546
1     192
Name: count, dtype: int64
2025-05-06 19:58:14,886 - INFO - Test target distribution:
acs_mu_class
0    0.929719
1    0.070281
Name: count, dtype: float64
2025-05-06 19:58:14,886 - INFO - Test target counts:
acs_mu_class
0    5093
1     385
Name: count, dtype: int64
2025-05-06 19:58:14,887 - INFO - Calibration target distribution:
acs_mu_class
0    0.929562
1    0.070438
Name: count, dtype: float64
2025-05-06 19:58:14,887 - INFO - Calibration target counts:
acs_mu_class
0    2547
1     193
Name: count, dtype: int64
2025-05-06 19:58:14,887 - INFO - [group_1] Applying feature scaling (for SVM)...
2025-05-06 19:58:14,895 - INFO - Scaler loaded from trained_models\scaler_group_1.joblib
2025-05-06 19:58:14,899 - INFO - Feature scaling complete.
2025-05-06 19:58:14,899 - INFO - --- [group_1] Running SVM Workflow ---
2025-05-06 19:58:14,899 - INFO - 

===== Starting Workflow for SVM (group_1) =====
2025-05-06 19:58:14,899 - INFO - --- [SVM] Using provided hyperparameters, skipping HPO. ---
2025-05-06 19:58:14,899 - INFO - --- [SVM] Training final model & calibrator (platt) ---
2025-05-06 19:58:14,899 - INFO - --- Preparing Model Training & Calibration (platt) for SVM (group_1) ---
2025-05-06 19:58:14,899 - INFO - --- [SVM] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_1\SVM_group_1_platt.joblib. Proceeding with training. ---
2025-05-06 19:58:14,899 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 19:58:14,899 - WARNING - Setting probability=True for SVC as required by calibration setup.
2025-05-06 19:58:14,899 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 19:58:14,899 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 19:58:36,252 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 19:58:36,253 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 19:58:36,269 - INFO - --- [SVM] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_1\SVM_group_1_platt.joblib ---
2025-05-06 19:58:36,270 - INFO - --- [SVM] Training & Calibration with platt finished in 21.37 seconds ---
2025-05-06 19:58:36,270 - INFO - --- [SVM] Calibrating Mondrian Conformal Prediction ---
2025-05-06 19:58:38,713 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 19:58:38,713 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 19:58:38,713 - INFO - --- [SVM] Mondrian CP calibration finished in 2.44 seconds ---
2025-05-06 19:58:38,713 - INFO - --- [SVM] Final Evaluation on Test Set ---
2025-05-06 19:58:43,242 - INFO - --- SVM Metrics ---
2025-05-06 19:58:43,242 - INFO - Accuracy: 0.9567
2025-05-06 19:58:43,242 - INFO - Precision: 0.9022
2025-05-06 19:58:43,242 - INFO - Recall (TPR): 0.4312
2025-05-06 19:58:43,242 - INFO - Specificity (TNR): 0.9965
2025-05-06 19:58:43,242 - INFO - F1-Score: 0.5835
2025-05-06 19:58:43,242 - INFO - G-Mean: 0.6555
2025-05-06 19:58:43,242 - INFO - ROC AUC: 0.8663
2025-05-06 19:58:43,242 - INFO - PR AUC: 0.6364
2025-05-06 19:58:43,242 - INFO - Brier Score: 0.0380
2025-05-06 19:58:43,242 - INFO - Confusion Matrix (TN, FP, FN, TP): (5075, 18, 219, 166)
2025-05-06 19:58:43,242 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 19:58:43,375 - INFO - Mondrian CP Coverage for class 0: 0.9994
2025-05-06 19:58:43,375 - INFO - Mondrian CP Coverage for class 1: 0.5065
2025-05-06 19:58:43,375 - INFO - Mondrian CP Coverage: 0.9648
2025-05-06 19:58:43,375 - INFO - Mondrian CP Avg Set Size: 1.2008
2025-05-06 19:58:43,375 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 19:58:43,375 - INFO - --- [SVM] Mondrian CP evaluation finished in 0.13 seconds ---
2025-05-06 19:58:43,375 - INFO - --- [SVM] Total Evaluation finished in 4.66 seconds ---
2025-05-06 19:58:43,375 - INFO - ===== Finished Workflow for SVM (group_1) =====
2025-05-06 19:58:43,376 - INFO - --- [group_1] Running CART Workflow ---
2025-05-06 19:58:43,376 - INFO - 

===== Starting Workflow for CART (group_1) =====
2025-05-06 19:58:43,376 - INFO - --- [CART] Using provided hyperparameters, skipping HPO. ---
2025-05-06 19:58:43,376 - INFO - --- [CART] Training final model & calibrator (platt) ---
2025-05-06 19:58:43,376 - INFO - --- Preparing Model Training & Calibration (platt) for CART (group_1) ---
2025-05-06 19:58:43,376 - INFO - --- [CART] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_1\CART_group_1_platt.joblib. Proceeding with training. ---
2025-05-06 19:58:43,376 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 19:58:43,376 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 19:58:43,377 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 19:58:44,406 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 19:58:44,406 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 19:58:44,408 - INFO - --- [CART] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_1\CART_group_1_platt.joblib ---
2025-05-06 19:58:44,408 - INFO - --- [CART] Training & Calibration with platt finished in 1.03 seconds ---
2025-05-06 19:58:44,408 - INFO - --- [CART] Calibrating Mondrian Conformal Prediction ---
2025-05-06 19:58:44,415 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 19:58:44,415 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 19:58:44,415 - INFO - --- [CART] Mondrian CP calibration finished in 0.01 seconds ---
2025-05-06 19:58:44,415 - INFO - --- [CART] Final Evaluation on Test Set ---
2025-05-06 19:58:44,420 - INFO - [CART] Calibrated test probabilities for class 1 (sample): [0.03713386 0.62991576 0.02888289 0.02641408 0.03713386 0.03713386
 0.03713386 0.02641408 0.03713386 0.03713386 0.03713386 0.03713386
 0.03713386 0.03713386 0.03713386 0.62991576 0.02641408 0.03713386
 0.03713386 0.02641408]
2025-05-06 19:58:44,420 - INFO - [CART] Calibrated test probabilities range: min=0.0264, max=0.6299, mean=0.0707
2025-05-06 19:58:44,424 - INFO - --- CART Metrics ---
2025-05-06 19:58:44,424 - INFO - Accuracy: 0.9474
2025-05-06 19:58:44,424 - INFO - Precision: 0.6422
2025-05-06 19:58:44,424 - INFO - Recall (TPR): 0.5688
2025-05-06 19:58:44,424 - INFO - Specificity (TNR): 0.9760
2025-05-06 19:58:44,424 - INFO - F1-Score: 0.6033
2025-05-06 19:58:44,424 - INFO - G-Mean: 0.7451
2025-05-06 19:58:44,424 - INFO - ROC AUC: 0.7852
2025-05-06 19:58:44,424 - INFO - PR AUC: 0.5937
2025-05-06 19:58:44,424 - INFO - Brier Score: 0.0435
2025-05-06 19:58:44,424 - INFO - Confusion Matrix (TN, FP, FN, TP): (4971, 122, 166, 219)
2025-05-06 19:58:44,424 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 19:58:44,552 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 19:58:44,552 - INFO - Mondrian CP Coverage for class 1: 0.5688
2025-05-06 19:58:44,552 - INFO - Mondrian CP Coverage: 0.9697
2025-05-06 19:58:44,552 - INFO - Mondrian CP Avg Set Size: 1.1993
2025-05-06 19:58:44,552 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 19:58:44,553 - INFO - --- [CART] Mondrian CP evaluation finished in 0.13 seconds ---
2025-05-06 19:58:44,553 - INFO - --- [CART] Total Evaluation finished in 0.14 seconds ---
2025-05-06 19:58:44,553 - INFO - ===== Finished Workflow for CART (group_1) =====
2025-05-06 19:58:44,553 - INFO - --- [group_1] Running Random Forest Workflow ---
2025-05-06 19:58:44,553 - INFO - 

===== Starting Workflow for Random_Forest (group_1) =====
2025-05-06 19:58:44,553 - INFO - --- [Random_Forest] Using provided hyperparameters, skipping HPO. ---
2025-05-06 19:58:44,553 - INFO - --- [Random_Forest] Training final model & calibrator (platt) ---
2025-05-06 19:58:44,553 - INFO - --- Preparing Model Training & Calibration (platt) for Random_Forest (group_1) ---
2025-05-06 19:58:44,553 - INFO - --- [Random_Forest] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_1\Random_Forest_group_1_platt.joblib. Proceeding with training. ---
2025-05-06 19:58:44,553 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 19:58:44,554 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 19:58:44,554 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 19:58:47,996 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 19:58:47,996 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 19:58:48,160 - INFO - --- [Random_Forest] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_1\Random_Forest_group_1_platt.joblib ---
2025-05-06 19:58:48,160 - INFO - --- [Random_Forest] Calibration with platt finished in 3.61 seconds ---
2025-05-06 19:58:48,160 - INFO - --- [Random_Forest] Calibrating Mondrian Conformal Prediction ---
2025-05-06 19:58:48,290 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 19:58:48,290 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 19:58:48,290 - INFO - --- [Random_Forest] Mondrian CP calibration finished in 0.13 seconds ---
2025-05-06 19:58:48,290 - INFO - --- [Random_Forest] Final Evaluation on Test Set ---
2025-05-06 19:58:48,420 - INFO - --- Random_Forest Metrics ---
2025-05-06 19:58:48,420 - INFO - Accuracy: 0.9618
2025-05-06 19:58:48,420 - INFO - Precision: 0.8729
2025-05-06 19:58:48,420 - INFO - Recall (TPR): 0.5351
2025-05-06 19:58:48,420 - INFO - Specificity (TNR): 0.9941
2025-05-06 19:58:48,420 - INFO - F1-Score: 0.6634
2025-05-06 19:58:48,420 - INFO - G-Mean: 0.7293
2025-05-06 19:58:48,420 - INFO - ROC AUC: 0.8792
2025-05-06 19:58:48,420 - INFO - PR AUC: 0.6719
2025-05-06 19:58:48,420 - INFO - Brier Score: 0.0341
2025-05-06 19:58:48,420 - INFO - Confusion Matrix (TN, FP, FN, TP): (5063, 30, 179, 206)
2025-05-06 19:58:48,420 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 19:58:48,566 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 19:58:48,566 - INFO - Mondrian CP Coverage for class 1: 0.6130
2025-05-06 19:58:48,566 - INFO - Mondrian CP Coverage: 0.9728
2025-05-06 19:58:48,566 - INFO - Mondrian CP Avg Set Size: 1.2083
2025-05-06 19:58:48,566 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 19:58:48,566 - INFO - --- [Random_Forest] Mondrian CP evaluation finished in 0.15 seconds ---
2025-05-06 19:58:48,566 - INFO - --- [Random_Forest] Total Evaluation finished in 0.28 seconds ---
2025-05-06 19:58:48,566 - INFO - ===== Finished Workflow for Random_Forest (group_1) =====
2025-05-06 19:58:48,572 - INFO - --- [group_1] Running XGBoost Workflow ---
2025-05-06 19:58:48,572 - INFO - 

===== Starting Workflow for XGBoost =====
2025-05-06 19:58:48,572 - INFO - --- [XGBoost] Using provided hyperparameters, skipping HPO. ---
2025-05-06 19:58:48,572 - INFO - --- [XGBoost] Determining best iteration and training calibrator ---
2025-05-06 19:58:48,572 - INFO - Training temporary XGBoost with early stopping to find best iteration...
2025-05-06 19:58:48,880 - INFO - Best iteration found: 99
2025-05-06 19:58:48,880 - INFO - --- [XGBoost] Training final model (99 est.) and calibrator ---
2025-05-06 19:58:48,880 - INFO - --- Preparing Model Training & Calibration (platt) for XGBoost (group_1) ---
2025-05-06 19:58:48,880 - INFO - --- [XGBoost] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_1\XGBoost_group_1_platt.joblib. Proceeding with training. ---
2025-05-06 19:58:48,880 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 19:58:48,880 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 19:58:48,880 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 19:58:50,466 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 19:58:50,466 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 19:58:50,490 - INFO - --- [XGBoost] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_1\XGBoost_group_1_platt.joblib ---
2025-05-06 19:58:50,490 - INFO - --- [XGBoost] Calibration with platt finished in 1.92 seconds ---
2025-05-06 19:58:50,490 - INFO - --- [XGBoost] Calibrating Mondrian Conformal Prediction ---
2025-05-06 19:58:50,499 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 19:58:50,499 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 19:58:50,499 - INFO - --- [XGBoost] Mondrian CP calibration finished in 0.01 seconds ---
2025-05-06 19:58:50,499 - INFO - --- [XGBoost] Final Evaluation on Test Set ---
2025-05-06 19:58:50,523 - INFO - --- XGBoost Metrics ---
2025-05-06 19:58:50,523 - INFO - Accuracy: 0.9611
2025-05-06 19:58:50,523 - INFO - Precision: 0.8496
2025-05-06 19:58:50,523 - INFO - Recall (TPR): 0.5429
2025-05-06 19:58:50,523 - INFO - Specificity (TNR): 0.9927
2025-05-06 19:58:50,523 - INFO - F1-Score: 0.6624
2025-05-06 19:58:50,523 - INFO - G-Mean: 0.7341
2025-05-06 19:58:50,523 - INFO - ROC AUC: 0.8815
2025-05-06 19:58:50,523 - INFO - PR AUC: 0.6703
2025-05-06 19:58:50,523 - INFO - Brier Score: 0.0352
2025-05-06 19:58:50,523 - INFO - Confusion Matrix (TN, FP, FN, TP): (5056, 37, 176, 209)
2025-05-06 19:58:50,523 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 19:58:50,715 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 19:58:50,715 - INFO - Mondrian CP Coverage for class 1: 0.6026
2025-05-06 19:58:50,715 - INFO - Mondrian CP Coverage: 0.9721
2025-05-06 19:58:50,715 - INFO - Mondrian CP Avg Set Size: 1.1955
2025-05-06 19:58:50,715 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 19:58:50,715 - INFO - --- [XGBoost] Mondrian CP evaluation finished in 0.19 seconds ---
2025-05-06 19:58:50,715 - INFO - --- [XGBoost] Total Evaluation finished in 0.22 seconds ---
2025-05-06 19:58:50,715 - INFO - ===== Finished Workflow for XGBoost =====
2025-05-06 19:58:50,715 - INFO - --- [group_1] Running LightGBM Workflow ---
2025-05-06 19:58:50,715 - INFO - 

===== Starting Workflow for LightGBM =====
2025-05-06 19:58:50,715 - INFO - --- [LightGBM] Using provided hyperparameters, skipping HPO. ---
2025-05-06 19:58:50,715 - INFO - --- [LightGBM] Determining best iteration and training calibrator ---
2025-05-06 19:58:50,715 - INFO - Training temporary LightGBM with early stopping (monitoring 'logloss') to find best iteration...
2025-05-06 19:58:50,809 - INFO - Best iteration found: 13
2025-05-06 19:58:50,809 - INFO - --- [LightGBM] Training final model (13 est.) and calibrator ---
2025-05-06 19:58:50,809 - INFO - --- Preparing Model Training & Calibration (platt) for LightGBM (group_1) ---
2025-05-06 19:58:50,809 - INFO - --- [LightGBM] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_1\LightGBM_group_1_platt.joblib. Proceeding with training. ---
2025-05-06 19:58:50,809 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 19:58:50,810 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 19:58:50,810 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 19:58:51,288 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 19:58:51,288 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 19:58:51,297 - INFO - --- [LightGBM] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_1\LightGBM_group_1_platt.joblib ---
2025-05-06 19:58:51,297 - INFO - --- [LightGBM] Calibration finished in 0.58 seconds ---
2025-05-06 19:58:51,297 - INFO - --- [LightGBM] Calibrating Mondrian Conformal Prediction ---
2025-05-06 19:58:51,305 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 19:58:51,306 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 19:58:51,306 - INFO - --- [LightGBM] Mondrian CP calibration finished in 0.01 seconds ---
2025-05-06 19:58:51,306 - INFO - --- [LightGBM] Final Evaluation on Test Set ---
2025-05-06 19:58:51,323 - INFO - --- LightGBM Metrics ---
2025-05-06 19:58:51,323 - INFO - Accuracy: 0.9576
2025-05-06 19:58:51,323 - INFO - Precision: 0.8000
2025-05-06 19:58:51,323 - INFO - Recall (TPR): 0.5299
2025-05-06 19:58:51,323 - INFO - Specificity (TNR): 0.9900
2025-05-06 19:58:51,323 - INFO - F1-Score: 0.6375
2025-05-06 19:58:51,323 - INFO - G-Mean: 0.7243
2025-05-06 19:58:51,323 - INFO - ROC AUC: 0.8821
2025-05-06 19:58:51,323 - INFO - PR AUC: 0.6590
2025-05-06 19:58:51,323 - INFO - Brier Score: 0.0366
2025-05-06 19:58:51,323 - INFO - Confusion Matrix (TN, FP, FN, TP): (5042, 51, 181, 204)
2025-05-06 19:58:51,323 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 19:58:51,511 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 19:58:51,511 - INFO - Mondrian CP Coverage for class 1: 0.5974
2025-05-06 19:58:51,511 - INFO - Mondrian CP Coverage: 0.9717
2025-05-06 19:58:51,511 - INFO - Mondrian CP Avg Set Size: 1.2039
2025-05-06 19:58:51,511 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 19:58:51,511 - INFO - --- [LightGBM] Mondrian CP evaluation finished in 0.19 seconds ---
2025-05-06 19:58:51,511 - INFO - --- [LightGBM] Total Evaluation finished in 0.21 seconds ---
2025-05-06 19:58:51,511 - INFO - ===== Finished Workflow for LightGBM =====
2025-05-06 19:58:51,511 - INFO - --- Finished processing Feature Group: group_1 in 36.66 seconds ---
2025-05-06 19:58:51,519 - INFO - 
============================== Processing Feature Group: group_2 ==============================
2025-05-06 19:58:51,521 - INFO - [group_2] Successfully loaded best parameters from best_params\group_2_best_params.json
2025-05-06 19:58:51,521 - INFO - [group_2] Cleaning data...
2025-05-06 19:58:51,521 - INFO - Original dataset size: (27388, 136)
2025-05-06 19:58:51,526 - INFO - Dataset size after dropping NaNs: (27388, 25)
2025-05-06 19:58:51,526 - INFO - Value counts for target:
1 (Star): 1926
0 (Galaxy): 25462
2025-05-06 19:58:51,527 - INFO - [group_2] Splitting data (Train/Val/Test/Cal)...
2025-05-06 19:58:51,528 - INFO - Splitting data using 'stratified' strategy...
2025-05-06 19:58:51,528 - INFO - Target split ratios: Train=0.60, Val=0.10, Test=0.20, Cal=0.10
2025-05-06 19:58:51,536 - INFO - Train set shape: (16432, 24)
2025-05-06 19:58:51,544 - INFO - Validation set shape: (2738, 24)
2025-05-06 19:58:51,548 - INFO - Test set shape: (5478, 24)
2025-05-06 19:58:51,548 - INFO - Calibration set shape: (2740, 24)
2025-05-06 19:58:51,548 - INFO - Split lengths verification successful.
2025-05-06 19:58:51,548 - INFO - Data splitting complete.
2025-05-06 19:58:51,548 - INFO - Train target distribution:
acs_mu_class
0    0.929649
1    0.070351
Name: count, dtype: float64
2025-05-06 19:58:51,549 - INFO - Train target counts:
acs_mu_class
0    15276
1     1156
Name: count, dtype: int64
2025-05-06 19:58:51,549 - INFO - Validation target distribution:
acs_mu_class
0    0.929876
1    0.070124
Name: count, dtype: float64
2025-05-06 19:58:51,549 - INFO - Validation target counts:
acs_mu_class
0    2546
1     192
Name: count, dtype: int64
2025-05-06 19:58:51,550 - INFO - Test target distribution:
acs_mu_class
0    0.929719
1    0.070281
Name: count, dtype: float64
2025-05-06 19:58:51,550 - INFO - Test target counts:
acs_mu_class
0    5093
1     385
Name: count, dtype: int64
2025-05-06 19:58:51,550 - INFO - Calibration target distribution:
acs_mu_class
0    0.929562
1    0.070438
Name: count, dtype: float64
2025-05-06 19:58:51,550 - INFO - Calibration target counts:
acs_mu_class
0    2547
1     193
Name: count, dtype: int64
2025-05-06 19:58:51,550 - INFO - [group_2] Applying feature scaling (for SVM)...
2025-05-06 19:58:51,552 - INFO - Scaler loaded from trained_models\scaler_group_2.joblib
2025-05-06 19:58:51,554 - INFO - Feature scaling complete.
2025-05-06 19:58:51,554 - INFO - --- [group_2] Running SVM Workflow ---
2025-05-06 19:58:51,554 - INFO - 

===== Starting Workflow for SVM (group_2) =====
2025-05-06 19:58:51,554 - INFO - --- [SVM] Using provided hyperparameters, skipping HPO. ---
2025-05-06 19:58:51,554 - INFO - --- [SVM] Training final model & calibrator (platt) ---
2025-05-06 19:58:51,554 - INFO - --- Preparing Model Training & Calibration (platt) for SVM (group_2) ---
2025-05-06 19:58:51,554 - INFO - --- [SVM] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_2\SVM_group_2_platt.joblib. Proceeding with training. ---
2025-05-06 19:58:51,554 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 19:58:51,554 - WARNING - Setting probability=True for SVC as required by calibration setup.
2025-05-06 19:58:51,554 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 19:58:51,554 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:19:07,621 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:19:07,621 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:19:07,637 - INFO - --- [SVM] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_2\SVM_group_2_platt.joblib ---
2025-05-06 20:19:07,637 - INFO - --- [SVM] Training & Calibration with platt finished in 1216.08 seconds ---
2025-05-06 20:19:07,637 - INFO - --- [SVM] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:19:08,320 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:19:08,320 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:19:08,320 - INFO - --- [SVM] Mondrian CP calibration finished in 0.68 seconds ---
2025-05-06 20:19:08,320 - INFO - --- [SVM] Final Evaluation on Test Set ---
2025-05-06 20:19:09,657 - INFO - --- SVM Metrics ---
2025-05-06 20:19:09,657 - INFO - Accuracy: 0.9297
2025-05-06 20:19:09,658 - INFO - Precision: 0.0000
2025-05-06 20:19:09,658 - INFO - Recall (TPR): 0.0000
2025-05-06 20:19:09,658 - INFO - Specificity (TNR): 1.0000
2025-05-06 20:19:09,658 - INFO - F1-Score: 0.0000
2025-05-06 20:19:09,658 - INFO - G-Mean: 0.0000
2025-05-06 20:19:09,658 - INFO - ROC AUC: 0.7434
2025-05-06 20:19:09,658 - INFO - PR AUC: 0.3073
2025-05-06 20:19:09,658 - INFO - Brier Score: 0.0653
2025-05-06 20:19:09,658 - INFO - Confusion Matrix (TN, FP, FN, TP): (5093, 0, 385, 0)
2025-05-06 20:19:09,658 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:19:09,837 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:19:09,837 - INFO - Mondrian CP Coverage for class 1: 0.2338
2025-05-06 20:19:09,837 - INFO - Mondrian CP Coverage: 0.9461
2025-05-06 20:19:09,837 - INFO - Mondrian CP Avg Set Size: 1.1811
2025-05-06 20:19:09,837 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:19:09,838 - INFO - --- [SVM] Mondrian CP evaluation finished in 0.18 seconds ---
2025-05-06 20:19:09,838 - INFO - --- [SVM] Total Evaluation finished in 1.52 seconds ---
2025-05-06 20:19:09,838 - INFO - ===== Finished Workflow for SVM (group_2) =====
2025-05-06 20:19:09,838 - INFO - --- [group_2] Running CART Workflow ---
2025-05-06 20:19:09,838 - INFO - 

===== Starting Workflow for CART (group_2) =====
2025-05-06 20:19:09,838 - INFO - --- [CART] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:19:09,838 - INFO - --- [CART] Training final model & calibrator (platt) ---
2025-05-06 20:19:09,838 - INFO - --- Preparing Model Training & Calibration (platt) for CART (group_2) ---
2025-05-06 20:19:09,838 - INFO - --- [CART] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_2\CART_group_2_platt.joblib. Proceeding with training. ---
2025-05-06 20:19:09,838 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:19:09,838 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:19:09,838 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:19:10,081 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:19:10,081 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:19:10,085 - INFO - --- [CART] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_2\CART_group_2_platt.joblib ---
2025-05-06 20:19:10,085 - INFO - --- [CART] Training & Calibration with platt finished in 0.25 seconds ---
2025-05-06 20:19:10,085 - INFO - --- [CART] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:19:10,099 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:19:10,100 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:19:10,100 - INFO - --- [CART] Mondrian CP calibration finished in 0.01 seconds ---
2025-05-06 20:19:10,100 - INFO - --- [CART] Final Evaluation on Test Set ---
2025-05-06 20:19:10,114 - INFO - [CART] Calibrated test probabilities for class 1 (sample): [0.03740037 0.1896346  0.06296642 0.02336964 0.08670689 0.14627032
 0.05986154 0.02336964 0.05277285 0.02336964 0.02336964 0.02336964
 0.09572928 0.09401077 0.07025608 0.36502804 0.02336964 0.08172082
 0.02336964 0.14660743]
2025-05-06 20:19:10,114 - INFO - [CART] Calibrated test probabilities range: min=0.0234, max=0.3666, mean=0.0707
2025-05-06 20:19:10,127 - INFO - --- CART Metrics ---
2025-05-06 20:19:10,127 - INFO - Accuracy: 0.9297
2025-05-06 20:19:10,127 - INFO - Precision: 0.0000
2025-05-06 20:19:10,127 - INFO - Recall (TPR): 0.0000
2025-05-06 20:19:10,127 - INFO - Specificity (TNR): 1.0000
2025-05-06 20:19:10,127 - INFO - F1-Score: 0.0000
2025-05-06 20:19:10,127 - INFO - G-Mean: 0.0000
2025-05-06 20:19:10,127 - INFO - ROC AUC: 0.8613
2025-05-06 20:19:10,127 - INFO - PR AUC: 0.6108
2025-05-06 20:19:10,127 - INFO - Brier Score: 0.0506
2025-05-06 20:19:10,127 - INFO - Confusion Matrix (TN, FP, FN, TP): (5093, 0, 385, 0)
2025-05-06 20:19:10,127 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:19:10,406 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:19:10,406 - INFO - Mondrian CP Coverage for class 1: 0.2078
2025-05-06 20:19:10,407 - INFO - Mondrian CP Coverage: 0.9443
2025-05-06 20:19:10,407 - INFO - Mondrian CP Avg Set Size: 1.1992
2025-05-06 20:19:10,407 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:19:10,407 - INFO - --- [CART] Mondrian CP evaluation finished in 0.28 seconds ---
2025-05-06 20:19:10,407 - INFO - --- [CART] Total Evaluation finished in 0.31 seconds ---
2025-05-06 20:19:10,407 - INFO - ===== Finished Workflow for CART (group_2) =====
2025-05-06 20:19:10,407 - INFO - --- [group_2] Running Random Forest Workflow ---
2025-05-06 20:19:10,407 - INFO - 

===== Starting Workflow for Random_Forest (group_2) =====
2025-05-06 20:19:10,407 - INFO - --- [Random_Forest] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:19:10,407 - INFO - --- [Random_Forest] Training final model & calibrator (platt) ---
2025-05-06 20:19:10,407 - INFO - --- Preparing Model Training & Calibration (platt) for Random_Forest (group_2) ---
2025-05-06 20:19:10,407 - INFO - --- [Random_Forest] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_2\Random_Forest_group_2_platt.joblib. Proceeding with training. ---
2025-05-06 20:19:10,407 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:19:10,407 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:19:10,407 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:19:17,811 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:19:17,811 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:19:17,995 - INFO - --- [Random_Forest] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_2\Random_Forest_group_2_platt.joblib ---
2025-05-06 20:19:17,995 - INFO - --- [Random_Forest] Calibration with platt finished in 7.59 seconds ---
2025-05-06 20:19:17,995 - INFO - --- [Random_Forest] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:19:18,129 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:19:18,130 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:19:18,130 - INFO - --- [Random_Forest] Mondrian CP calibration finished in 0.14 seconds ---
2025-05-06 20:19:18,130 - INFO - --- [Random_Forest] Final Evaluation on Test Set ---
2025-05-06 20:19:18,276 - INFO - --- Random_Forest Metrics ---
2025-05-06 20:19:18,276 - INFO - Accuracy: 0.9644
2025-05-06 20:19:18,276 - INFO - Precision: 0.8926
2025-05-06 20:19:18,276 - INFO - Recall (TPR): 0.5610
2025-05-06 20:19:18,276 - INFO - Specificity (TNR): 0.9949
2025-05-06 20:19:18,276 - INFO - F1-Score: 0.6890
2025-05-06 20:19:18,276 - INFO - G-Mean: 0.7471
2025-05-06 20:19:18,276 - INFO - ROC AUC: 0.9122
2025-05-06 20:19:18,276 - INFO - PR AUC: 0.7370
2025-05-06 20:19:18,276 - INFO - Brier Score: 0.0310
2025-05-06 20:19:18,276 - INFO - Confusion Matrix (TN, FP, FN, TP): (5067, 26, 169, 216)
2025-05-06 20:19:18,276 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:19:18,518 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:19:18,518 - INFO - Mondrian CP Coverage for class 1: 0.6260
2025-05-06 20:19:18,518 - INFO - Mondrian CP Coverage: 0.9737
2025-05-06 20:19:18,519 - INFO - Mondrian CP Avg Set Size: 1.1984
2025-05-06 20:19:18,519 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:19:18,519 - INFO - --- [Random_Forest] Mondrian CP evaluation finished in 0.24 seconds ---
2025-05-06 20:19:18,519 - INFO - --- [Random_Forest] Total Evaluation finished in 0.39 seconds ---
2025-05-06 20:19:18,519 - INFO - ===== Finished Workflow for Random_Forest (group_2) =====
2025-05-06 20:19:18,524 - INFO - --- [group_2] Running XGBoost Workflow ---
2025-05-06 20:19:18,524 - INFO - 

===== Starting Workflow for XGBoost =====
2025-05-06 20:19:18,524 - INFO - --- [XGBoost] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:19:18,524 - INFO - --- [XGBoost] Determining best iteration and training calibrator ---
2025-05-06 20:19:18,524 - INFO - Training temporary XGBoost with early stopping to find best iteration...
2025-05-06 20:19:19,070 - INFO - Best iteration found: 99
2025-05-06 20:19:19,070 - INFO - --- [XGBoost] Training final model (99 est.) and calibrator ---
2025-05-06 20:19:19,070 - INFO - --- Preparing Model Training & Calibration (platt) for XGBoost (group_2) ---
2025-05-06 20:19:19,070 - INFO - --- [XGBoost] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_2\XGBoost_group_2_platt.joblib. Proceeding with training. ---
2025-05-06 20:19:19,070 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:19:19,070 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:19:19,070 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:19:24,085 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:19:24,085 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:19:24,115 - INFO - --- [XGBoost] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_2\XGBoost_group_2_platt.joblib ---
2025-05-06 20:19:24,116 - INFO - --- [XGBoost] Calibration with platt finished in 5.59 seconds ---
2025-05-06 20:19:24,116 - INFO - --- [XGBoost] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:19:24,132 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:19:24,132 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:19:24,132 - INFO - --- [XGBoost] Mondrian CP calibration finished in 0.02 seconds ---
2025-05-06 20:19:24,132 - INFO - --- [XGBoost] Final Evaluation on Test Set ---
2025-05-06 20:19:24,158 - INFO - --- XGBoost Metrics ---
2025-05-06 20:19:24,158 - INFO - Accuracy: 0.9650
2025-05-06 20:19:24,159 - INFO - Precision: 0.8814
2025-05-06 20:19:24,159 - INFO - Recall (TPR): 0.5792
2025-05-06 20:19:24,159 - INFO - Specificity (TNR): 0.9941
2025-05-06 20:19:24,159 - INFO - F1-Score: 0.6991
2025-05-06 20:19:24,159 - INFO - G-Mean: 0.7588
2025-05-06 20:19:24,159 - INFO - ROC AUC: 0.9070
2025-05-06 20:19:24,159 - INFO - PR AUC: 0.7472
2025-05-06 20:19:24,159 - INFO - Brier Score: 0.0303
2025-05-06 20:19:24,159 - INFO - Confusion Matrix (TN, FP, FN, TP): (5063, 30, 162, 223)
2025-05-06 20:19:24,159 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:19:24,377 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:19:24,377 - INFO - Mondrian CP Coverage for class 1: 0.6571
2025-05-06 20:19:24,377 - INFO - Mondrian CP Coverage: 0.9759
2025-05-06 20:19:24,377 - INFO - Mondrian CP Avg Set Size: 1.2006
2025-05-06 20:19:24,377 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:19:24,377 - INFO - --- [XGBoost] Mondrian CP evaluation finished in 0.22 seconds ---
2025-05-06 20:19:24,377 - INFO - --- [XGBoost] Total Evaluation finished in 0.25 seconds ---
2025-05-06 20:19:24,377 - INFO - ===== Finished Workflow for XGBoost =====
2025-05-06 20:19:24,378 - INFO - --- [group_2] Running LightGBM Workflow ---
2025-05-06 20:19:24,378 - INFO - 

===== Starting Workflow for LightGBM =====
2025-05-06 20:19:24,378 - INFO - --- [LightGBM] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:19:24,378 - INFO - --- [LightGBM] Determining best iteration and training calibrator ---
2025-05-06 20:19:24,378 - INFO - Training temporary LightGBM with early stopping (monitoring 'logloss') to find best iteration...
2025-05-06 20:19:24,637 - INFO - Best iteration found: 100
2025-05-06 20:19:24,637 - INFO - --- [LightGBM] Training final model (100 est.) and calibrator ---
2025-05-06 20:19:24,637 - INFO - --- Preparing Model Training & Calibration (platt) for LightGBM (group_2) ---
2025-05-06 20:19:24,637 - INFO - --- [LightGBM] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_2\LightGBM_group_2_platt.joblib. Proceeding with training. ---
2025-05-06 20:19:24,637 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:19:24,638 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:19:24,638 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:19:27,719 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:19:27,719 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:19:27,772 - INFO - --- [LightGBM] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_2\LightGBM_group_2_platt.joblib ---
2025-05-06 20:19:27,772 - INFO - --- [LightGBM] Calibration finished in 3.39 seconds ---
2025-05-06 20:19:27,772 - INFO - --- [LightGBM] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:19:27,788 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:19:27,788 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:19:27,788 - INFO - --- [LightGBM] Mondrian CP calibration finished in 0.02 seconds ---
2025-05-06 20:19:27,789 - INFO - --- [LightGBM] Final Evaluation on Test Set ---
2025-05-06 20:19:27,823 - INFO - --- LightGBM Metrics ---
2025-05-06 20:19:27,823 - INFO - Accuracy: 0.9651
2025-05-06 20:19:27,823 - INFO - Precision: 0.8819
2025-05-06 20:19:27,823 - INFO - Recall (TPR): 0.5818
2025-05-06 20:19:27,823 - INFO - Specificity (TNR): 0.9941
2025-05-06 20:19:27,823 - INFO - F1-Score: 0.7011
2025-05-06 20:19:27,823 - INFO - G-Mean: 0.7605
2025-05-06 20:19:27,823 - INFO - ROC AUC: 0.9134
2025-05-06 20:19:27,823 - INFO - PR AUC: 0.7459
2025-05-06 20:19:27,823 - INFO - Brier Score: 0.0306
2025-05-06 20:19:27,823 - INFO - Confusion Matrix (TN, FP, FN, TP): (5063, 30, 161, 224)
2025-05-06 20:19:27,823 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:19:28,037 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:19:28,037 - INFO - Mondrian CP Coverage for class 1: 0.6468
2025-05-06 20:19:28,038 - INFO - Mondrian CP Coverage: 0.9752
2025-05-06 20:19:28,038 - INFO - Mondrian CP Avg Set Size: 1.1988
2025-05-06 20:19:28,038 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:19:28,038 - INFO - --- [LightGBM] Mondrian CP evaluation finished in 0.22 seconds ---
2025-05-06 20:19:28,038 - INFO - --- [LightGBM] Total Evaluation finished in 0.25 seconds ---
2025-05-06 20:19:28,038 - INFO - ===== Finished Workflow for LightGBM =====
2025-05-06 20:19:28,038 - INFO - --- Finished processing Feature Group: group_2 in 1236.52 seconds ---
2025-05-06 20:19:28,038 - INFO - 
============================== Processing Feature Group: group_3 ==============================
2025-05-06 20:19:28,039 - INFO - [group_3] Successfully loaded best parameters from best_params\group_3_best_params.json
2025-05-06 20:19:28,039 - INFO - [group_3] Cleaning data...
2025-05-06 20:19:28,039 - INFO - Original dataset size: (27388, 136)
2025-05-06 20:19:28,054 - INFO - Dataset size after dropping NaNs: (27388, 49)
2025-05-06 20:19:28,054 - INFO - Value counts for target:
1 (Star): 1926
0 (Galaxy): 25462
2025-05-06 20:19:28,059 - INFO - [group_3] Splitting data (Train/Val/Test/Cal)...
2025-05-06 20:19:28,059 - INFO - Splitting data using 'stratified' strategy...
2025-05-06 20:19:28,060 - INFO - Target split ratios: Train=0.60, Val=0.10, Test=0.20, Cal=0.10
2025-05-06 20:19:28,082 - INFO - Train set shape: (16432, 48)
2025-05-06 20:19:28,089 - INFO - Validation set shape: (2738, 48)
2025-05-06 20:19:28,103 - INFO - Test set shape: (5478, 48)
2025-05-06 20:19:28,103 - INFO - Calibration set shape: (2740, 48)
2025-05-06 20:19:28,103 - INFO - Split lengths verification successful.
2025-05-06 20:19:28,104 - INFO - Data splitting complete.
2025-05-06 20:19:28,106 - INFO - Train target distribution:
acs_mu_class
0    0.929649
1    0.070351
Name: count, dtype: float64
2025-05-06 20:19:28,106 - INFO - Train target counts:
acs_mu_class
0    15276
1     1156
Name: count, dtype: int64
2025-05-06 20:19:28,108 - INFO - Validation target distribution:
acs_mu_class
0    0.929876
1    0.070124
Name: count, dtype: float64
2025-05-06 20:19:28,108 - INFO - Validation target counts:
acs_mu_class
0    2546
1     192
Name: count, dtype: int64
2025-05-06 20:19:28,110 - INFO - Test target distribution:
acs_mu_class
0    0.929719
1    0.070281
Name: count, dtype: float64
2025-05-06 20:19:28,110 - INFO - Test target counts:
acs_mu_class
0    5093
1     385
Name: count, dtype: int64
2025-05-06 20:19:28,111 - INFO - Calibration target distribution:
acs_mu_class
0    0.929562
1    0.070438
Name: count, dtype: float64
2025-05-06 20:19:28,112 - INFO - Calibration target counts:
acs_mu_class
0    2547
1     193
Name: count, dtype: int64
2025-05-06 20:19:28,113 - INFO - [group_3] Applying feature scaling (for SVM)...
2025-05-06 20:19:28,124 - INFO - Scaler loaded from trained_models\scaler_group_3.joblib
2025-05-06 20:19:28,146 - INFO - Feature scaling complete.
2025-05-06 20:19:28,147 - INFO - --- [group_3] Running SVM Workflow ---
2025-05-06 20:19:28,147 - INFO - 

===== Starting Workflow for SVM (group_3) =====
2025-05-06 20:19:28,147 - INFO - --- [SVM] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:19:28,147 - INFO - --- [SVM] Training final model & calibrator (platt) ---
2025-05-06 20:19:28,147 - INFO - --- Preparing Model Training & Calibration (platt) for SVM (group_3) ---
2025-05-06 20:19:28,148 - INFO - --- [SVM] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_3\SVM_group_3_platt.joblib. Proceeding with training. ---
2025-05-06 20:19:28,148 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:19:28,149 - WARNING - Setting probability=True for SVC as required by calibration setup.
2025-05-06 20:19:28,149 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:19:28,149 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:49:19,215 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:49:19,215 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:49:19,220 - INFO - --- [SVM] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_3\SVM_group_3_platt.joblib ---
2025-05-06 20:49:19,220 - INFO - --- [SVM] Training & Calibration with platt finished in 1791.07 seconds ---
2025-05-06 20:49:19,220 - INFO - --- [SVM] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:49:19,584 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:49:19,584 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:49:19,584 - INFO - --- [SVM] Mondrian CP calibration finished in 0.36 seconds ---
2025-05-06 20:49:19,584 - INFO - --- [SVM] Final Evaluation on Test Set ---
2025-05-06 20:49:20,304 - INFO - --- SVM Metrics ---
2025-05-06 20:49:20,304 - INFO - Accuracy: 0.9297
2025-05-06 20:49:20,304 - INFO - Precision: 0.0000
2025-05-06 20:49:20,304 - INFO - Recall (TPR): 0.0000
2025-05-06 20:49:20,304 - INFO - Specificity (TNR): 1.0000
2025-05-06 20:49:20,304 - INFO - F1-Score: 0.0000
2025-05-06 20:49:20,304 - INFO - G-Mean: 0.0000
2025-05-06 20:49:20,304 - INFO - ROC AUC: 0.7397
2025-05-06 20:49:20,304 - INFO - PR AUC: 0.2778
2025-05-06 20:49:20,304 - INFO - Brier Score: 0.0653
2025-05-06 20:49:20,304 - INFO - Confusion Matrix (TN, FP, FN, TP): (5093, 0, 385, 0)
2025-05-06 20:49:20,304 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:49:20,450 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:49:20,450 - INFO - Mondrian CP Coverage for class 1: 0.2000
2025-05-06 20:49:20,455 - INFO - Mondrian CP Coverage: 0.9438
2025-05-06 20:49:20,455 - INFO - Mondrian CP Avg Set Size: 1.1986
2025-05-06 20:49:20,455 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:49:20,455 - INFO - --- [SVM] Mondrian CP evaluation finished in 0.15 seconds ---
2025-05-06 20:49:20,455 - INFO - --- [SVM] Total Evaluation finished in 0.87 seconds ---
2025-05-06 20:49:20,455 - INFO - ===== Finished Workflow for SVM (group_3) =====
2025-05-06 20:49:20,455 - INFO - --- [group_3] Running CART Workflow ---
2025-05-06 20:49:20,456 - INFO - 

===== Starting Workflow for CART (group_3) =====
2025-05-06 20:49:20,456 - INFO - --- [CART] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:49:20,456 - INFO - --- [CART] Training final model & calibrator (platt) ---
2025-05-06 20:49:20,456 - INFO - --- Preparing Model Training & Calibration (platt) for CART (group_3) ---
2025-05-06 20:49:20,456 - INFO - --- [CART] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_3\CART_group_3_platt.joblib. Proceeding with training. ---
2025-05-06 20:49:20,456 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:49:20,456 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:49:20,456 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:49:21,886 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:49:21,886 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:49:21,886 - INFO - --- [CART] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_3\CART_group_3_platt.joblib ---
2025-05-06 20:49:21,886 - INFO - --- [CART] Training & Calibration with platt finished in 1.43 seconds ---
2025-05-06 20:49:21,886 - INFO - --- [CART] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:49:21,896 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:49:21,896 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:49:21,896 - INFO - --- [CART] Mondrian CP calibration finished in 0.01 seconds ---
2025-05-06 20:49:21,896 - INFO - --- [CART] Final Evaluation on Test Set ---
2025-05-06 20:49:21,896 - INFO - [CART] Calibrated test probabilities for class 1 (sample): [0.02438485 0.26796821 0.02438485 0.04456653 0.08008088 0.10521062
 0.15003172 0.02438485 0.02438485 0.06044215 0.02438485 0.03642193
 0.02438485 0.05838859 0.05720173 0.39378127 0.16360961 0.06876256
 0.02438485 0.02438485]
2025-05-06 20:49:21,896 - INFO - [CART] Calibrated test probabilities range: min=0.0244, max=0.3952, mean=0.0685
2025-05-06 20:49:21,896 - INFO - --- CART Metrics ---
2025-05-06 20:49:21,896 - INFO - Accuracy: 0.9297
2025-05-06 20:49:21,896 - INFO - Precision: 0.0000
2025-05-06 20:49:21,896 - INFO - Recall (TPR): 0.0000
2025-05-06 20:49:21,896 - INFO - Specificity (TNR): 1.0000
2025-05-06 20:49:21,896 - INFO - F1-Score: 0.0000
2025-05-06 20:49:21,896 - INFO - G-Mean: 0.0000
2025-05-06 20:49:21,896 - INFO - ROC AUC: 0.8840
2025-05-06 20:49:21,896 - INFO - PR AUC: 0.6637
2025-05-06 20:49:21,896 - INFO - Brier Score: 0.0474
2025-05-06 20:49:21,896 - INFO - Confusion Matrix (TN, FP, FN, TP): (5093, 0, 385, 0)
2025-05-06 20:49:21,910 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:49:22,050 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:49:22,050 - INFO - Mondrian CP Coverage for class 1: 0.2494
2025-05-06 20:49:22,050 - INFO - Mondrian CP Coverage: 0.9472
2025-05-06 20:49:22,050 - INFO - Mondrian CP Avg Set Size: 1.2116
2025-05-06 20:49:22,050 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:49:22,050 - INFO - --- [CART] Mondrian CP evaluation finished in 0.15 seconds ---
2025-05-06 20:49:22,050 - INFO - --- [CART] Total Evaluation finished in 0.15 seconds ---
2025-05-06 20:49:22,050 - INFO - ===== Finished Workflow for CART (group_3) =====
2025-05-06 20:49:22,050 - INFO - --- [group_3] Running Random Forest Workflow ---
2025-05-06 20:49:22,050 - INFO - 

===== Starting Workflow for Random_Forest (group_3) =====
2025-05-06 20:49:22,050 - INFO - --- [Random_Forest] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:49:22,050 - INFO - --- [Random_Forest] Training final model & calibrator (platt) ---
2025-05-06 20:49:22,050 - INFO - --- Preparing Model Training & Calibration (platt) for Random_Forest (group_3) ---
2025-05-06 20:49:22,050 - INFO - --- [Random_Forest] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_3\Random_Forest_group_3_platt.joblib. Proceeding with training. ---
2025-05-06 20:49:22,050 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:49:22,050 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:49:22,050 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:49:33,331 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:49:33,331 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:49:33,437 - INFO - --- [Random_Forest] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_3\Random_Forest_group_3_platt.joblib ---
2025-05-06 20:49:33,437 - INFO - --- [Random_Forest] Calibration with platt finished in 11.39 seconds ---
2025-05-06 20:49:33,437 - INFO - --- [Random_Forest] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:49:33,579 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:49:33,579 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:49:33,579 - INFO - --- [Random_Forest] Mondrian CP calibration finished in 0.14 seconds ---
2025-05-06 20:49:33,579 - INFO - --- [Random_Forest] Final Evaluation on Test Set ---
2025-05-06 20:49:33,716 - INFO - --- Random_Forest Metrics ---
2025-05-06 20:49:33,716 - INFO - Accuracy: 0.9660
2025-05-06 20:49:33,716 - INFO - Precision: 0.9270
2025-05-06 20:49:33,716 - INFO - Recall (TPR): 0.5610
2025-05-06 20:49:33,716 - INFO - Specificity (TNR): 0.9967
2025-05-06 20:49:33,716 - INFO - F1-Score: 0.6990
2025-05-06 20:49:33,716 - INFO - G-Mean: 0.7478
2025-05-06 20:49:33,716 - INFO - ROC AUC: 0.9211
2025-05-06 20:49:33,716 - INFO - PR AUC: 0.7547
2025-05-06 20:49:33,716 - INFO - Brier Score: 0.0291
2025-05-06 20:49:33,716 - INFO - Confusion Matrix (TN, FP, FN, TP): (5076, 17, 169, 216)
2025-05-06 20:49:33,716 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:49:33,856 - INFO - Mondrian CP Coverage for class 0: 0.9998
2025-05-06 20:49:33,856 - INFO - Mondrian CP Coverage for class 1: 0.6208
2025-05-06 20:49:33,856 - INFO - Mondrian CP Coverage: 0.9732
2025-05-06 20:49:33,856 - INFO - Mondrian CP Avg Set Size: 1.2068
2025-05-06 20:49:33,856 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:49:33,856 - INFO - --- [Random_Forest] Mondrian CP evaluation finished in 0.14 seconds ---
2025-05-06 20:49:33,856 - INFO - --- [Random_Forest] Total Evaluation finished in 0.28 seconds ---
2025-05-06 20:49:33,856 - INFO - ===== Finished Workflow for Random_Forest (group_3) =====
2025-05-06 20:49:33,861 - INFO - --- [group_3] Running XGBoost Workflow ---
2025-05-06 20:49:33,861 - INFO - 

===== Starting Workflow for XGBoost =====
2025-05-06 20:49:33,861 - INFO - --- [XGBoost] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:49:33,861 - INFO - --- [XGBoost] Determining best iteration and training calibrator ---
2025-05-06 20:49:33,861 - INFO - Training temporary XGBoost with early stopping to find best iteration...
2025-05-06 20:49:34,297 - INFO - Best iteration found: 99
2025-05-06 20:49:34,297 - INFO - --- [XGBoost] Training final model (99 est.) and calibrator ---
2025-05-06 20:49:34,297 - INFO - --- Preparing Model Training & Calibration (platt) for XGBoost (group_3) ---
2025-05-06 20:49:34,297 - INFO - --- [XGBoost] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_3\XGBoost_group_3_platt.joblib. Proceeding with training. ---
2025-05-06 20:49:34,297 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:49:34,297 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:49:34,297 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:49:36,661 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:49:36,661 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:49:36,677 - INFO - --- [XGBoost] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_3\XGBoost_group_3_platt.joblib ---
2025-05-06 20:49:36,677 - INFO - --- [XGBoost] Calibration with platt finished in 2.82 seconds ---
2025-05-06 20:49:36,677 - INFO - --- [XGBoost] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:49:36,693 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:49:36,693 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:49:36,693 - INFO - --- [XGBoost] Mondrian CP calibration finished in 0.02 seconds ---
2025-05-06 20:49:36,693 - INFO - --- [XGBoost] Final Evaluation on Test Set ---
2025-05-06 20:49:36,719 - INFO - --- XGBoost Metrics ---
2025-05-06 20:49:36,719 - INFO - Accuracy: 0.9648
2025-05-06 20:49:36,719 - INFO - Precision: 0.8429
2025-05-06 20:49:36,719 - INFO - Recall (TPR): 0.6130
2025-05-06 20:49:36,719 - INFO - Specificity (TNR): 0.9914
2025-05-06 20:49:36,719 - INFO - F1-Score: 0.7098
2025-05-06 20:49:36,719 - INFO - G-Mean: 0.7795
2025-05-06 20:49:36,719 - INFO - ROC AUC: 0.9270
2025-05-06 20:49:36,719 - INFO - PR AUC: 0.7686
2025-05-06 20:49:36,719 - INFO - Brier Score: 0.0285
2025-05-06 20:49:36,719 - INFO - Confusion Matrix (TN, FP, FN, TP): (5049, 44, 149, 236)
2025-05-06 20:49:36,719 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:49:36,880 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:49:36,880 - INFO - Mondrian CP Coverage for class 1: 0.7013
2025-05-06 20:49:36,880 - INFO - Mondrian CP Coverage: 0.9790
2025-05-06 20:49:36,880 - INFO - Mondrian CP Avg Set Size: 1.1997
2025-05-06 20:49:36,880 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:49:36,880 - INFO - --- [XGBoost] Mondrian CP evaluation finished in 0.16 seconds ---
2025-05-06 20:49:36,880 - INFO - --- [XGBoost] Total Evaluation finished in 0.19 seconds ---
2025-05-06 20:49:36,880 - INFO - ===== Finished Workflow for XGBoost =====
2025-05-06 20:49:36,880 - INFO - --- [group_3] Running LightGBM Workflow ---
2025-05-06 20:49:36,880 - INFO - 

===== Starting Workflow for LightGBM =====
2025-05-06 20:49:36,880 - INFO - --- [LightGBM] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:49:36,880 - INFO - --- [LightGBM] Determining best iteration and training calibrator ---
2025-05-06 20:49:36,880 - INFO - Training temporary LightGBM with early stopping (monitoring 'logloss') to find best iteration...
2025-05-06 20:49:36,932 - INFO - Best iteration found: 1
2025-05-06 20:49:36,932 - INFO - --- [LightGBM] Training final model (1 est.) and calibrator ---
2025-05-06 20:49:36,932 - INFO - --- Preparing Model Training & Calibration (platt) for LightGBM (group_3) ---
2025-05-06 20:49:36,933 - INFO - --- [LightGBM] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_3\LightGBM_group_3_platt.joblib. Proceeding with training. ---
2025-05-06 20:49:36,933 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:49:36,933 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:49:36,933 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:49:38,068 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:49:38,068 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:49:38,080 - INFO - --- [LightGBM] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_3\LightGBM_group_3_platt.joblib ---
2025-05-06 20:49:38,080 - INFO - --- [LightGBM] Calibration finished in 1.20 seconds ---
2025-05-06 20:49:38,080 - INFO - --- [LightGBM] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:49:38,089 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:49:38,089 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:49:38,089 - INFO - --- [LightGBM] Mondrian CP calibration finished in 0.01 seconds ---
2025-05-06 20:49:38,090 - INFO - --- [LightGBM] Final Evaluation on Test Set ---
2025-05-06 20:49:38,103 - INFO - --- LightGBM Metrics ---
2025-05-06 20:49:38,103 - INFO - Accuracy: 0.9297
2025-05-06 20:49:38,103 - INFO - Precision: 0.0000
2025-05-06 20:49:38,103 - INFO - Recall (TPR): 0.0000
2025-05-06 20:49:38,103 - INFO - Specificity (TNR): 1.0000
2025-05-06 20:49:38,103 - INFO - F1-Score: 0.0000
2025-05-06 20:49:38,103 - INFO - G-Mean: 0.0000
2025-05-06 20:49:38,103 - INFO - ROC AUC: 0.8882
2025-05-06 20:49:38,103 - INFO - PR AUC: 0.5498
2025-05-06 20:49:38,103 - INFO - Brier Score: 0.0458
2025-05-06 20:49:38,103 - INFO - Confusion Matrix (TN, FP, FN, TP): (5093, 0, 385, 0)
2025-05-06 20:49:38,103 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:49:38,270 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:49:38,270 - INFO - Mondrian CP Coverage for class 1: 0.2260
2025-05-06 20:49:38,271 - INFO - Mondrian CP Coverage: 0.9456
2025-05-06 20:49:38,271 - INFO - Mondrian CP Avg Set Size: 1.2055
2025-05-06 20:49:38,271 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:49:38,271 - INFO - --- [LightGBM] Mondrian CP evaluation finished in 0.17 seconds ---
2025-05-06 20:49:38,271 - INFO - --- [LightGBM] Total Evaluation finished in 0.18 seconds ---
2025-05-06 20:49:38,271 - INFO - ===== Finished Workflow for LightGBM =====
2025-05-06 20:49:38,271 - INFO - --- Finished processing Feature Group: group_3 in 1810.23 seconds ---
2025-05-06 20:49:38,271 - INFO - 
============================== Processing Feature Group: group_4 ==============================
2025-05-06 20:49:38,280 - INFO - [group_4] Successfully loaded best parameters from best_params\group_4_best_params.json
2025-05-06 20:49:38,280 - INFO - [group_4] Cleaning data...
2025-05-06 20:49:38,280 - INFO - Original dataset size: (27388, 136)
2025-05-06 20:49:38,288 - INFO - Dataset size after dropping NaNs: (27388, 12)
2025-05-06 20:49:38,289 - INFO - Value counts for target:
1 (Star): 1926
0 (Galaxy): 25462
2025-05-06 20:49:38,291 - INFO - [group_4] Splitting data (Train/Val/Test/Cal)...
2025-05-06 20:49:38,292 - INFO - Splitting data using 'stratified' strategy...
2025-05-06 20:49:38,292 - INFO - Target split ratios: Train=0.60, Val=0.10, Test=0.20, Cal=0.10
2025-05-06 20:49:38,300 - INFO - Train set shape: (16432, 11)
2025-05-06 20:49:38,303 - INFO - Validation set shape: (2738, 11)
2025-05-06 20:49:38,306 - INFO - Test set shape: (5478, 11)
2025-05-06 20:49:38,306 - INFO - Calibration set shape: (2740, 11)
2025-05-06 20:49:38,306 - INFO - Split lengths verification successful.
2025-05-06 20:49:38,306 - INFO - Data splitting complete.
2025-05-06 20:49:38,306 - INFO - Train target distribution:
acs_mu_class
0    0.929649
1    0.070351
Name: count, dtype: float64
2025-05-06 20:49:38,307 - INFO - Train target counts:
acs_mu_class
0    15276
1     1156
Name: count, dtype: int64
2025-05-06 20:49:38,307 - INFO - Validation target distribution:
acs_mu_class
0    0.929876
1    0.070124
Name: count, dtype: float64
2025-05-06 20:49:38,307 - INFO - Validation target counts:
acs_mu_class
0    2546
1     192
Name: count, dtype: int64
2025-05-06 20:49:38,307 - INFO - Test target distribution:
acs_mu_class
0    0.929719
1    0.070281
Name: count, dtype: float64
2025-05-06 20:49:38,308 - INFO - Test target counts:
acs_mu_class
0    5093
1     385
Name: count, dtype: int64
2025-05-06 20:49:38,308 - INFO - Calibration target distribution:
acs_mu_class
0    0.929562
1    0.070438
Name: count, dtype: float64
2025-05-06 20:49:38,308 - INFO - Calibration target counts:
acs_mu_class
0    2547
1     193
Name: count, dtype: int64
2025-05-06 20:49:38,308 - INFO - [group_4] Applying feature scaling (for SVM)...
2025-05-06 20:49:38,309 - INFO - Scaler loaded from trained_models\scaler_group_4.joblib
2025-05-06 20:49:38,319 - INFO - Feature scaling complete.
2025-05-06 20:49:38,322 - INFO - --- [group_4] Running SVM Workflow ---
2025-05-06 20:49:38,322 - INFO - 

===== Starting Workflow for SVM (group_4) =====
2025-05-06 20:49:38,322 - INFO - --- [SVM] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:49:38,322 - INFO - --- [SVM] Training final model & calibrator (platt) ---
2025-05-06 20:49:38,322 - INFO - --- Preparing Model Training & Calibration (platt) for SVM (group_4) ---
2025-05-06 20:49:38,322 - INFO - --- [SVM] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_4\SVM_group_4_platt.joblib. Proceeding with training. ---
2025-05-06 20:49:38,322 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:49:38,322 - WARNING - Setting probability=True for SVC as required by calibration setup.
2025-05-06 20:49:38,322 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:49:38,322 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:49:50,162 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:49:50,162 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:49:50,168 - INFO - --- [SVM] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_4\SVM_group_4_platt.joblib ---
2025-05-06 20:49:50,168 - INFO - --- [SVM] Training & Calibration with platt finished in 11.85 seconds ---
2025-05-06 20:49:50,168 - INFO - --- [SVM] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:49:51,057 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:49:51,057 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:49:51,057 - INFO - --- [SVM] Mondrian CP calibration finished in 0.89 seconds ---
2025-05-06 20:49:51,057 - INFO - --- [SVM] Final Evaluation on Test Set ---
2025-05-06 20:49:52,854 - INFO - --- SVM Metrics ---
2025-05-06 20:49:52,854 - INFO - Accuracy: 0.9587
2025-05-06 20:49:52,854 - INFO - Precision: 0.8597
2025-05-06 20:49:52,854 - INFO - Recall (TPR): 0.4935
2025-05-06 20:49:52,854 - INFO - Specificity (TNR): 0.9939
2025-05-06 20:49:52,854 - INFO - F1-Score: 0.6271
2025-05-06 20:49:52,854 - INFO - G-Mean: 0.7004
2025-05-06 20:49:52,854 - INFO - ROC AUC: 0.9196
2025-05-06 20:49:52,854 - INFO - PR AUC: 0.7129
2025-05-06 20:49:52,854 - INFO - Brier Score: 0.0337
2025-05-06 20:49:52,854 - INFO - Confusion Matrix (TN, FP, FN, TP): (5062, 31, 195, 190)
2025-05-06 20:49:52,854 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:49:53,131 - INFO - Mondrian CP Coverage for class 0: 0.9994
2025-05-06 20:49:53,131 - INFO - Mondrian CP Coverage for class 1: 0.5740
2025-05-06 20:49:53,131 - INFO - Mondrian CP Coverage: 0.9695
2025-05-06 20:49:53,131 - INFO - Mondrian CP Avg Set Size: 1.1891
2025-05-06 20:49:53,131 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:49:53,131 - INFO - --- [SVM] Mondrian CP evaluation finished in 0.28 seconds ---
2025-05-06 20:49:53,131 - INFO - --- [SVM] Total Evaluation finished in 2.07 seconds ---
2025-05-06 20:49:53,131 - INFO - ===== Finished Workflow for SVM (group_4) =====
2025-05-06 20:49:53,131 - INFO - --- [group_4] Running CART Workflow ---
2025-05-06 20:49:53,131 - INFO - 

===== Starting Workflow for CART (group_4) =====
2025-05-06 20:49:53,131 - INFO - --- [CART] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:49:53,131 - INFO - --- [CART] Training final model & calibrator (platt) ---
2025-05-06 20:49:53,131 - INFO - --- Preparing Model Training & Calibration (platt) for CART (group_4) ---
2025-05-06 20:49:53,131 - INFO - --- [CART] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_4\CART_group_4_platt.joblib. Proceeding with training. ---
2025-05-06 20:49:53,131 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:49:53,131 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:49:53,132 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:49:53,308 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:49:53,309 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:49:53,310 - INFO - --- [CART] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_4\CART_group_4_platt.joblib ---
2025-05-06 20:49:53,310 - INFO - --- [CART] Training & Calibration with platt finished in 0.18 seconds ---
2025-05-06 20:49:53,310 - INFO - --- [CART] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:49:53,310 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:49:53,310 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:49:53,310 - INFO - --- [CART] Mondrian CP calibration finished in 0.00 seconds ---
2025-05-06 20:49:53,310 - INFO - --- [CART] Final Evaluation on Test Set ---
2025-05-06 20:49:53,322 - INFO - [CART] Calibrated test probabilities for class 1 (sample): [0.00904818 0.64391499 0.01787144 0.15094036 0.0083866  0.08604023
 0.10510141 0.01015942 0.01881517 0.01015942 0.26064823 0.04133338
 0.09721356 0.01881517 0.0083866  0.64391499 0.34634879 0.13666598
 0.10510141 0.01015942]
2025-05-06 20:49:53,322 - INFO - [CART] Calibrated test probabilities range: min=0.0067, max=0.6439, mean=0.0706
2025-05-06 20:49:53,327 - INFO - --- CART Metrics ---
2025-05-06 20:49:53,327 - INFO - Accuracy: 0.9564
2025-05-06 20:49:53,327 - INFO - Precision: 0.8067
2025-05-06 20:49:53,327 - INFO - Recall (TPR): 0.4987
2025-05-06 20:49:53,327 - INFO - Specificity (TNR): 0.9910
2025-05-06 20:49:53,327 - INFO - F1-Score: 0.6164
2025-05-06 20:49:53,327 - INFO - G-Mean: 0.7030
2025-05-06 20:49:53,327 - INFO - ROC AUC: 0.9058
2025-05-06 20:49:53,327 - INFO - PR AUC: 0.6804
2025-05-06 20:49:53,327 - INFO - Brier Score: 0.0387
2025-05-06 20:49:53,327 - INFO - Confusion Matrix (TN, FP, FN, TP): (5047, 46, 193, 192)
2025-05-06 20:49:53,327 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:49:53,465 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:49:53,465 - INFO - Mondrian CP Coverage for class 1: 0.5688
2025-05-06 20:49:53,465 - INFO - Mondrian CP Coverage: 0.9697
2025-05-06 20:49:53,465 - INFO - Mondrian CP Avg Set Size: 1.1990
2025-05-06 20:49:53,465 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:49:53,465 - INFO - --- [CART] Mondrian CP evaluation finished in 0.14 seconds ---
2025-05-06 20:49:53,465 - INFO - --- [CART] Total Evaluation finished in 0.15 seconds ---
2025-05-06 20:49:53,465 - INFO - ===== Finished Workflow for CART (group_4) =====
2025-05-06 20:49:53,465 - INFO - --- [group_4] Running Random Forest Workflow ---
2025-05-06 20:49:53,465 - INFO - 

===== Starting Workflow for Random_Forest (group_4) =====
2025-05-06 20:49:53,465 - INFO - --- [Random_Forest] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:49:53,465 - INFO - --- [Random_Forest] Training final model & calibrator (platt) ---
2025-05-06 20:49:53,465 - INFO - --- Preparing Model Training & Calibration (platt) for Random_Forest (group_4) ---
2025-05-06 20:49:53,465 - INFO - --- [Random_Forest] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_4\Random_Forest_group_4_platt.joblib. Proceeding with training. ---
2025-05-06 20:49:53,465 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:49:53,466 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:49:53,466 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:49:56,134 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:49:56,134 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:49:56,249 - INFO - --- [Random_Forest] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_4\Random_Forest_group_4_platt.joblib ---
2025-05-06 20:49:56,249 - INFO - --- [Random_Forest] Calibration with platt finished in 2.78 seconds ---
2025-05-06 20:49:56,249 - INFO - --- [Random_Forest] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:49:56,382 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:49:56,382 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:49:56,382 - INFO - --- [Random_Forest] Mondrian CP calibration finished in 0.13 seconds ---
2025-05-06 20:49:56,382 - INFO - --- [Random_Forest] Final Evaluation on Test Set ---
2025-05-06 20:49:56,519 - INFO - --- Random_Forest Metrics ---
2025-05-06 20:49:56,519 - INFO - Accuracy: 0.9628
2025-05-06 20:49:56,519 - INFO - Precision: 0.8549
2025-05-06 20:49:56,519 - INFO - Recall (TPR): 0.5662
2025-05-06 20:49:56,519 - INFO - Specificity (TNR): 0.9927
2025-05-06 20:49:56,519 - INFO - F1-Score: 0.6813
2025-05-06 20:49:56,519 - INFO - G-Mean: 0.7497
2025-05-06 20:49:56,519 - INFO - ROC AUC: 0.9207
2025-05-06 20:49:56,519 - INFO - PR AUC: 0.7274
2025-05-06 20:49:56,519 - INFO - Brier Score: 0.0313
2025-05-06 20:49:56,519 - INFO - Confusion Matrix (TN, FP, FN, TP): (5056, 37, 167, 218)
2025-05-06 20:49:56,519 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:49:56,653 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:49:56,653 - INFO - Mondrian CP Coverage for class 1: 0.6468
2025-05-06 20:49:56,653 - INFO - Mondrian CP Coverage: 0.9752
2025-05-06 20:49:56,653 - INFO - Mondrian CP Avg Set Size: 1.1835
2025-05-06 20:49:56,653 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:49:56,653 - INFO - --- [Random_Forest] Mondrian CP evaluation finished in 0.13 seconds ---
2025-05-06 20:49:56,653 - INFO - --- [Random_Forest] Total Evaluation finished in 0.27 seconds ---
2025-05-06 20:49:56,653 - INFO - ===== Finished Workflow for Random_Forest (group_4) =====
2025-05-06 20:49:56,656 - INFO - --- [group_4] Running XGBoost Workflow ---
2025-05-06 20:49:56,656 - INFO - 

===== Starting Workflow for XGBoost =====
2025-05-06 20:49:56,656 - INFO - --- [XGBoost] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:49:56,656 - INFO - --- [XGBoost] Determining best iteration and training calibrator ---
2025-05-06 20:49:56,656 - INFO - Training temporary XGBoost with early stopping to find best iteration...
2025-05-06 20:49:56,830 - INFO - Best iteration found: 51
2025-05-06 20:49:56,830 - INFO - --- [XGBoost] Training final model (51 est.) and calibrator ---
2025-05-06 20:49:56,830 - INFO - --- Preparing Model Training & Calibration (platt) for XGBoost (group_4) ---
2025-05-06 20:49:56,830 - INFO - --- [XGBoost] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_4\XGBoost_group_4_platt.joblib. Proceeding with training. ---
2025-05-06 20:49:56,830 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:49:56,830 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:49:56,830 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:49:58,824 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:49:58,824 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:49:58,837 - INFO - --- [XGBoost] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_4\XGBoost_group_4_platt.joblib ---
2025-05-06 20:49:58,837 - INFO - --- [XGBoost] Calibration with platt finished in 2.18 seconds ---
2025-05-06 20:49:58,837 - INFO - --- [XGBoost] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:49:58,847 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:49:58,847 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:49:58,847 - INFO - --- [XGBoost] Mondrian CP calibration finished in 0.01 seconds ---
2025-05-06 20:49:58,848 - INFO - --- [XGBoost] Final Evaluation on Test Set ---
2025-05-06 20:49:58,866 - INFO - --- XGBoost Metrics ---
2025-05-06 20:49:58,866 - INFO - Accuracy: 0.9626
2025-05-06 20:49:58,866 - INFO - Precision: 0.8435
2025-05-06 20:49:58,866 - INFO - Recall (TPR): 0.5740
2025-05-06 20:49:58,866 - INFO - Specificity (TNR): 0.9919
2025-05-06 20:49:58,866 - INFO - F1-Score: 0.6832
2025-05-06 20:49:58,866 - INFO - G-Mean: 0.7546
2025-05-06 20:49:58,866 - INFO - ROC AUC: 0.9219
2025-05-06 20:49:58,866 - INFO - PR AUC: 0.7216
2025-05-06 20:49:58,866 - INFO - Brier Score: 0.0322
2025-05-06 20:49:58,866 - INFO - Confusion Matrix (TN, FP, FN, TP): (5052, 41, 164, 221)
2025-05-06 20:49:58,866 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:49:59,026 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:49:59,027 - INFO - Mondrian CP Coverage for class 1: 0.6545
2025-05-06 20:49:59,027 - INFO - Mondrian CP Coverage: 0.9757
2025-05-06 20:49:59,027 - INFO - Mondrian CP Avg Set Size: 1.1922
2025-05-06 20:49:59,027 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:49:59,027 - INFO - --- [XGBoost] Mondrian CP evaluation finished in 0.16 seconds ---
2025-05-06 20:49:59,027 - INFO - --- [XGBoost] Total Evaluation finished in 0.18 seconds ---
2025-05-06 20:49:59,027 - INFO - ===== Finished Workflow for XGBoost =====
2025-05-06 20:49:59,027 - INFO - --- [group_4] Running LightGBM Workflow ---
2025-05-06 20:49:59,027 - INFO - 

===== Starting Workflow for LightGBM =====
2025-05-06 20:49:59,027 - INFO - --- [LightGBM] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:49:59,027 - INFO - --- [LightGBM] Determining best iteration and training calibrator ---
2025-05-06 20:49:59,027 - INFO - Training temporary LightGBM with early stopping (monitoring 'logloss') to find best iteration...
2025-05-06 20:49:59,237 - INFO - Best iteration found: 98
2025-05-06 20:49:59,237 - INFO - --- [LightGBM] Training final model (98 est.) and calibrator ---
2025-05-06 20:49:59,237 - INFO - --- Preparing Model Training & Calibration (platt) for LightGBM (group_4) ---
2025-05-06 20:49:59,237 - INFO - --- [LightGBM] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_4\LightGBM_group_4_platt.joblib. Proceeding with training. ---
2025-05-06 20:49:59,237 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:49:59,237 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:49:59,237 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:50:01,158 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:50:01,158 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:50:01,204 - INFO - --- [LightGBM] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_4\LightGBM_group_4_platt.joblib ---
2025-05-06 20:50:01,205 - INFO - --- [LightGBM] Calibration finished in 2.18 seconds ---
2025-05-06 20:50:01,205 - INFO - --- [LightGBM] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:50:01,220 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:50:01,220 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:50:01,220 - INFO - --- [LightGBM] Mondrian CP calibration finished in 0.02 seconds ---
2025-05-06 20:50:01,220 - INFO - --- [LightGBM] Final Evaluation on Test Set ---
2025-05-06 20:50:01,249 - INFO - --- LightGBM Metrics ---
2025-05-06 20:50:01,249 - INFO - Accuracy: 0.9639
2025-05-06 20:50:01,249 - INFO - Precision: 0.8502
2025-05-06 20:50:01,249 - INFO - Recall (TPR): 0.5896
2025-05-06 20:50:01,249 - INFO - Specificity (TNR): 0.9921
2025-05-06 20:50:01,249 - INFO - F1-Score: 0.6963
2025-05-06 20:50:01,249 - INFO - G-Mean: 0.7648
2025-05-06 20:50:01,249 - INFO - ROC AUC: 0.9197
2025-05-06 20:50:01,250 - INFO - PR AUC: 0.7251
2025-05-06 20:50:01,250 - INFO - Brier Score: 0.0319
2025-05-06 20:50:01,250 - INFO - Confusion Matrix (TN, FP, FN, TP): (5053, 40, 158, 227)
2025-05-06 20:50:01,250 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:50:01,412 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:50:01,412 - INFO - Mondrian CP Coverage for class 1: 0.6545
2025-05-06 20:50:01,412 - INFO - Mondrian CP Coverage: 0.9757
2025-05-06 20:50:01,412 - INFO - Mondrian CP Avg Set Size: 1.1811
2025-05-06 20:50:01,412 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:50:01,412 - INFO - --- [LightGBM] Mondrian CP evaluation finished in 0.16 seconds ---
2025-05-06 20:50:01,412 - INFO - --- [LightGBM] Total Evaluation finished in 0.19 seconds ---
2025-05-06 20:50:01,412 - INFO - ===== Finished Workflow for LightGBM =====
2025-05-06 20:50:01,412 - INFO - --- Finished processing Feature Group: group_4 in 23.14 seconds ---
2025-05-06 20:50:01,412 - INFO - 
============================== Processing Feature Group: group_5 ==============================
2025-05-06 20:50:01,582 - INFO - [group_5] Successfully loaded best parameters from best_params\group_5_best_params.json
2025-05-06 20:50:01,582 - INFO - [group_5] Cleaning data...
2025-05-06 20:50:01,582 - INFO - Original dataset size: (27388, 136)
2025-05-06 20:50:01,594 - INFO - Dataset size after dropping NaNs: (27388, 59)
2025-05-06 20:50:01,594 - INFO - Value counts for target:
1 (Star): 1926
0 (Galaxy): 25462
2025-05-06 20:50:01,601 - INFO - [group_5] Splitting data (Train/Val/Test/Cal)...
2025-05-06 20:50:01,601 - INFO - Splitting data using 'stratified' strategy...
2025-05-06 20:50:01,601 - INFO - Target split ratios: Train=0.60, Val=0.10, Test=0.20, Cal=0.10
2025-05-06 20:50:01,614 - INFO - Train set shape: (16432, 58)
2025-05-06 20:50:01,618 - INFO - Validation set shape: (2738, 58)
2025-05-06 20:50:01,622 - INFO - Test set shape: (5478, 58)
2025-05-06 20:50:01,622 - INFO - Calibration set shape: (2740, 58)
2025-05-06 20:50:01,622 - INFO - Split lengths verification successful.
2025-05-06 20:50:01,622 - INFO - Data splitting complete.
2025-05-06 20:50:01,623 - INFO - Train target distribution:
acs_mu_class
0    0.929649
1    0.070351
Name: count, dtype: float64
2025-05-06 20:50:01,623 - INFO - Train target counts:
acs_mu_class
0    15276
1     1156
Name: count, dtype: int64
2025-05-06 20:50:01,623 - INFO - Validation target distribution:
acs_mu_class
0    0.929876
1    0.070124
Name: count, dtype: float64
2025-05-06 20:50:01,623 - INFO - Validation target counts:
acs_mu_class
0    2546
1     192
Name: count, dtype: int64
2025-05-06 20:50:01,624 - INFO - Test target distribution:
acs_mu_class
0    0.929719
1    0.070281
Name: count, dtype: float64
2025-05-06 20:50:01,624 - INFO - Test target counts:
acs_mu_class
0    5093
1     385
Name: count, dtype: int64
2025-05-06 20:50:01,624 - INFO - Calibration target distribution:
acs_mu_class
0    0.929562
1    0.070438
Name: count, dtype: float64
2025-05-06 20:50:01,624 - INFO - Calibration target counts:
acs_mu_class
0    2547
1     193
Name: count, dtype: int64
2025-05-06 20:50:01,624 - INFO - [group_5] Applying feature scaling (for SVM)...
2025-05-06 20:50:01,627 - INFO - Scaler loaded from trained_models\scaler_group_5.joblib
2025-05-06 20:50:01,643 - INFO - Feature scaling complete.
2025-05-06 20:50:01,643 - INFO - --- [group_5] Running SVM Workflow ---
2025-05-06 20:50:01,644 - INFO - 

===== Starting Workflow for SVM (group_5) =====
2025-05-06 20:50:01,644 - INFO - --- [SVM] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:50:01,644 - INFO - --- [SVM] Training final model & calibrator (platt) ---
2025-05-06 20:50:01,644 - INFO - --- Preparing Model Training & Calibration (platt) for SVM (group_5) ---
2025-05-06 20:50:01,644 - INFO - --- [SVM] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_5\SVM_group_5_platt.joblib. Proceeding with training. ---
2025-05-06 20:50:01,644 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:50:01,644 - WARNING - Setting probability=True for SVC as required by calibration setup.
2025-05-06 20:50:01,644 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:50:01,644 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:51:28,373 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:51:28,373 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:51:28,381 - INFO - --- [SVM] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_5\SVM_group_5_platt.joblib ---
2025-05-06 20:51:28,381 - INFO - --- [SVM] Training & Calibration with platt finished in 86.74 seconds ---
2025-05-06 20:51:28,381 - INFO - --- [SVM] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:51:28,913 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:51:28,913 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:51:28,913 - INFO - --- [SVM] Mondrian CP calibration finished in 0.53 seconds ---
2025-05-06 20:51:28,913 - INFO - --- [SVM] Final Evaluation on Test Set ---
2025-05-06 20:51:29,968 - INFO - --- SVM Metrics ---
2025-05-06 20:51:29,969 - INFO - Accuracy: 0.9301
2025-05-06 20:51:29,969 - INFO - Precision: 0.5625
2025-05-06 20:51:29,969 - INFO - Recall (TPR): 0.0234
2025-05-06 20:51:29,969 - INFO - Specificity (TNR): 0.9986
2025-05-06 20:51:29,969 - INFO - F1-Score: 0.0449
2025-05-06 20:51:29,969 - INFO - G-Mean: 0.1528
2025-05-06 20:51:29,969 - INFO - ROC AUC: 0.8830
2025-05-06 20:51:29,969 - INFO - PR AUC: 0.5998
2025-05-06 20:51:29,969 - INFO - Brier Score: 0.0526
2025-05-06 20:51:29,969 - INFO - Confusion Matrix (TN, FP, FN, TP): (5086, 7, 376, 9)
2025-05-06 20:51:29,969 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:51:30,098 - INFO - Mondrian CP Coverage for class 0: 0.9998
2025-05-06 20:51:30,098 - INFO - Mondrian CP Coverage for class 1: 0.1429
2025-05-06 20:51:30,098 - INFO - Mondrian CP Coverage: 0.9396
2025-05-06 20:51:30,098 - INFO - Mondrian CP Avg Set Size: 1.1984
2025-05-06 20:51:30,098 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:51:30,098 - INFO - --- [SVM] Mondrian CP evaluation finished in 0.13 seconds ---
2025-05-06 20:51:30,098 - INFO - --- [SVM] Total Evaluation finished in 1.19 seconds ---
2025-05-06 20:51:30,098 - INFO - ===== Finished Workflow for SVM (group_5) =====
2025-05-06 20:51:30,098 - INFO - --- [group_5] Running CART Workflow ---
2025-05-06 20:51:30,098 - INFO - 

===== Starting Workflow for CART (group_5) =====
2025-05-06 20:51:30,098 - INFO - --- [CART] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:51:30,098 - INFO - --- [CART] Training final model & calibrator (platt) ---
2025-05-06 20:51:30,098 - INFO - --- Preparing Model Training & Calibration (platt) for CART (group_5) ---
2025-05-06 20:51:30,098 - INFO - --- [CART] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_5\CART_group_5_platt.joblib. Proceeding with training. ---
2025-05-06 20:51:30,098 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:51:30,102 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:51:30,102 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:51:30,329 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:51:30,330 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:51:30,332 - INFO - --- [CART] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_5\CART_group_5_platt.joblib ---
2025-05-06 20:51:30,333 - INFO - --- [CART] Training & Calibration with platt finished in 0.23 seconds ---
2025-05-06 20:51:30,333 - INFO - --- [CART] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:51:30,340 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:51:30,340 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:51:30,340 - INFO - --- [CART] Mondrian CP calibration finished in 0.01 seconds ---
2025-05-06 20:51:30,340 - INFO - --- [CART] Final Evaluation on Test Set ---
2025-05-06 20:51:30,350 - INFO - [CART] Calibrated test probabilities for class 1 (sample): [0.0184917  0.47101782 0.0184917  0.0184917  0.0184917  0.0184917
 0.11732342 0.0184917  0.0184917  0.19483508 0.0184917  0.08360261
 0.13758542 0.04225053 0.0184917  0.4922253  0.10280736 0.20745334
 0.10757408 0.0184917 ]
2025-05-06 20:51:30,350 - INFO - [CART] Calibrated test probabilities range: min=0.0185, max=0.4928, mean=0.0680
2025-05-06 20:51:30,350 - INFO - --- CART Metrics ---
2025-05-06 20:51:30,350 - INFO - Accuracy: 0.9297
2025-05-06 20:51:30,350 - INFO - Precision: 0.0000
2025-05-06 20:51:30,350 - INFO - Recall (TPR): 0.0000
2025-05-06 20:51:30,350 - INFO - Specificity (TNR): 1.0000
2025-05-06 20:51:30,350 - INFO - F1-Score: 0.0000
2025-05-06 20:51:30,350 - INFO - G-Mean: 0.0000
2025-05-06 20:51:30,350 - INFO - ROC AUC: 0.9115
2025-05-06 20:51:30,350 - INFO - PR AUC: 0.7399
2025-05-06 20:51:30,350 - INFO - Brier Score: 0.0395
2025-05-06 20:51:30,350 - INFO - Confusion Matrix (TN, FP, FN, TP): (5093, 0, 385, 0)
2025-05-06 20:51:30,350 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:51:30,490 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:51:30,490 - INFO - Mondrian CP Coverage for class 1: 0.2234
2025-05-06 20:51:30,490 - INFO - Mondrian CP Coverage: 0.9454
2025-05-06 20:51:30,490 - INFO - Mondrian CP Avg Set Size: 1.1953
2025-05-06 20:51:30,490 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:51:30,490 - INFO - --- [CART] Mondrian CP evaluation finished in 0.14 seconds ---
2025-05-06 20:51:30,490 - INFO - --- [CART] Total Evaluation finished in 0.15 seconds ---
2025-05-06 20:51:30,490 - INFO - ===== Finished Workflow for CART (group_5) =====
2025-05-06 20:51:30,490 - INFO - --- [group_5] Running Random Forest Workflow ---
2025-05-06 20:51:30,490 - INFO - 

===== Starting Workflow for Random_Forest (group_5) =====
2025-05-06 20:51:30,490 - INFO - --- [Random_Forest] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:51:30,490 - INFO - --- [Random_Forest] Training final model & calibrator (platt) ---
2025-05-06 20:51:30,490 - INFO - --- Preparing Model Training & Calibration (platt) for Random_Forest (group_5) ---
2025-05-06 20:51:30,490 - INFO - --- [Random_Forest] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_5\Random_Forest_group_5_platt.joblib. Proceeding with training. ---
2025-05-06 20:51:30,490 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:51:30,492 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:51:30,492 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:51:41,625 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:51:41,625 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:51:41,733 - INFO - --- [Random_Forest] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_5\Random_Forest_group_5_platt.joblib ---
2025-05-06 20:51:41,733 - INFO - --- [Random_Forest] Calibration with platt finished in 11.24 seconds ---
2025-05-06 20:51:41,733 - INFO - --- [Random_Forest] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:51:41,868 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:51:41,868 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:51:41,868 - INFO - --- [Random_Forest] Mondrian CP calibration finished in 0.13 seconds ---
2025-05-06 20:51:41,868 - INFO - --- [Random_Forest] Final Evaluation on Test Set ---
2025-05-06 20:51:42,011 - INFO - --- Random_Forest Metrics ---
2025-05-06 20:51:42,011 - INFO - Accuracy: 0.9699
2025-05-06 20:51:42,011 - INFO - Precision: 0.9297
2025-05-06 20:51:42,011 - INFO - Recall (TPR): 0.6182
2025-05-06 20:51:42,011 - INFO - Specificity (TNR): 0.9965
2025-05-06 20:51:42,011 - INFO - F1-Score: 0.7426
2025-05-06 20:51:42,011 - INFO - G-Mean: 0.7849
2025-05-06 20:51:42,011 - INFO - ROC AUC: 0.9460
2025-05-06 20:51:42,011 - INFO - PR AUC: 0.7961
2025-05-06 20:51:42,011 - INFO - Brier Score: 0.0260
2025-05-06 20:51:42,011 - INFO - Confusion Matrix (TN, FP, FN, TP): (5075, 18, 147, 238)
2025-05-06 20:51:42,011 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:51:42,150 - INFO - Mondrian CP Coverage for class 0: 0.9996
2025-05-06 20:51:42,150 - INFO - Mondrian CP Coverage for class 1: 0.6883
2025-05-06 20:51:42,150 - INFO - Mondrian CP Coverage: 0.9777
2025-05-06 20:51:42,150 - INFO - Mondrian CP Avg Set Size: 1.1888
2025-05-06 20:51:42,150 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:51:42,150 - INFO - --- [Random_Forest] Mondrian CP evaluation finished in 0.14 seconds ---
2025-05-06 20:51:42,150 - INFO - --- [Random_Forest] Total Evaluation finished in 0.28 seconds ---
2025-05-06 20:51:42,150 - INFO - ===== Finished Workflow for Random_Forest (group_5) =====
2025-05-06 20:51:42,150 - INFO - --- [group_5] Running XGBoost Workflow ---
2025-05-06 20:51:42,150 - INFO - 

===== Starting Workflow for XGBoost =====
2025-05-06 20:51:42,150 - INFO - --- [XGBoost] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:51:42,150 - INFO - --- [XGBoost] Determining best iteration and training calibrator ---
2025-05-06 20:51:42,150 - INFO - Training temporary XGBoost with early stopping to find best iteration...
2025-05-06 20:51:42,879 - INFO - Best iteration found: 96
2025-05-06 20:51:42,879 - INFO - --- [XGBoost] Training final model (96 est.) and calibrator ---
2025-05-06 20:51:42,879 - INFO - --- Preparing Model Training & Calibration (platt) for XGBoost (group_5) ---
2025-05-06 20:51:42,881 - INFO - --- [XGBoost] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_5\XGBoost_group_5_platt.joblib. Proceeding with training. ---
2025-05-06 20:51:42,881 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:51:42,883 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:51:42,883 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:51:46,768 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:51:46,768 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:51:46,789 - INFO - --- [XGBoost] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_5\XGBoost_group_5_platt.joblib ---
2025-05-06 20:51:46,791 - INFO - --- [XGBoost] Calibration with platt finished in 4.64 seconds ---
2025-05-06 20:51:46,791 - INFO - --- [XGBoost] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:51:46,809 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:51:46,809 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:51:46,809 - INFO - --- [XGBoost] Mondrian CP calibration finished in 0.02 seconds ---
2025-05-06 20:51:46,809 - INFO - --- [XGBoost] Final Evaluation on Test Set ---
2025-05-06 20:51:46,835 - INFO - --- XGBoost Metrics ---
2025-05-06 20:51:46,835 - INFO - Accuracy: 0.9713
2025-05-06 20:51:46,835 - INFO - Precision: 0.9254
2025-05-06 20:51:46,835 - INFO - Recall (TPR): 0.6442
2025-05-06 20:51:46,835 - INFO - Specificity (TNR): 0.9961
2025-05-06 20:51:46,835 - INFO - F1-Score: 0.7596
2025-05-06 20:51:46,835 - INFO - G-Mean: 0.8010
2025-05-06 20:51:46,835 - INFO - ROC AUC: 0.9501
2025-05-06 20:51:46,835 - INFO - PR AUC: 0.8097
2025-05-06 20:51:46,835 - INFO - Brier Score: 0.0251
2025-05-06 20:51:46,835 - INFO - Confusion Matrix (TN, FP, FN, TP): (5073, 20, 137, 248)
2025-05-06 20:51:46,835 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:51:47,026 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:51:47,026 - INFO - Mondrian CP Coverage for class 1: 0.7273
2025-05-06 20:51:47,026 - INFO - Mondrian CP Coverage: 0.9808
2025-05-06 20:51:47,026 - INFO - Mondrian CP Avg Set Size: 1.2019
2025-05-06 20:51:47,026 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:51:47,026 - INFO - --- [XGBoost] Mondrian CP evaluation finished in 0.19 seconds ---
2025-05-06 20:51:47,026 - INFO - --- [XGBoost] Total Evaluation finished in 0.22 seconds ---
2025-05-06 20:51:47,026 - INFO - ===== Finished Workflow for XGBoost =====
2025-05-06 20:51:47,026 - INFO - --- [group_5] Running LightGBM Workflow ---
2025-05-06 20:51:47,027 - INFO - 

===== Starting Workflow for LightGBM =====
2025-05-06 20:51:47,027 - INFO - --- [LightGBM] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:51:47,027 - INFO - --- [LightGBM] Determining best iteration and training calibrator ---
2025-05-06 20:51:47,027 - INFO - Training temporary LightGBM with early stopping (monitoring 'logloss') to find best iteration...
2025-05-06 20:51:47,190 - INFO - Best iteration found: 100
2025-05-06 20:51:47,190 - INFO - --- [LightGBM] Training final model (100 est.) and calibrator ---
2025-05-06 20:51:47,190 - INFO - --- Preparing Model Training & Calibration (platt) for LightGBM (group_5) ---
2025-05-06 20:51:47,190 - INFO - --- [LightGBM] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_5\LightGBM_group_5_platt.joblib. Proceeding with training. ---
2025-05-06 20:51:47,191 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:51:47,192 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:51:47,193 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:51:48,340 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:51:48,340 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:51:48,362 - INFO - --- [LightGBM] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_5\LightGBM_group_5_platt.joblib ---
2025-05-06 20:51:48,362 - INFO - --- [LightGBM] Calibration finished in 1.34 seconds ---
2025-05-06 20:51:48,362 - INFO - --- [LightGBM] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:51:48,374 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:51:48,374 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:51:48,374 - INFO - --- [LightGBM] Mondrian CP calibration finished in 0.01 seconds ---
2025-05-06 20:51:48,374 - INFO - --- [LightGBM] Final Evaluation on Test Set ---
2025-05-06 20:51:48,411 - INFO - --- LightGBM Metrics ---
2025-05-06 20:51:48,411 - INFO - Accuracy: 0.9713
2025-05-06 20:51:48,411 - INFO - Precision: 0.8931
2025-05-06 20:51:48,411 - INFO - Recall (TPR): 0.6727
2025-05-06 20:51:48,411 - INFO - Specificity (TNR): 0.9939
2025-05-06 20:51:48,411 - INFO - F1-Score: 0.7674
2025-05-06 20:51:48,411 - INFO - G-Mean: 0.8177
2025-05-06 20:51:48,411 - INFO - ROC AUC: 0.9454
2025-05-06 20:51:48,411 - INFO - PR AUC: 0.8001
2025-05-06 20:51:48,411 - INFO - Brier Score: 0.0252
2025-05-06 20:51:48,411 - INFO - Confusion Matrix (TN, FP, FN, TP): (5062, 31, 126, 259)
2025-05-06 20:51:48,411 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:51:48,581 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:51:48,581 - INFO - Mondrian CP Coverage for class 1: 0.7429
2025-05-06 20:51:48,581 - INFO - Mondrian CP Coverage: 0.9819
2025-05-06 20:51:48,581 - INFO - Mondrian CP Avg Set Size: 1.2003
2025-05-06 20:51:48,581 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:51:48,581 - INFO - --- [LightGBM] Mondrian CP evaluation finished in 0.17 seconds ---
2025-05-06 20:51:48,581 - INFO - --- [LightGBM] Total Evaluation finished in 0.21 seconds ---
2025-05-06 20:51:48,581 - INFO - ===== Finished Workflow for LightGBM =====
2025-05-06 20:51:48,581 - INFO - --- Finished processing Feature Group: group_5 in 107.17 seconds ---
2025-05-06 20:51:48,581 - INFO - 
============================== Processing Feature Group: group_6 ==============================
2025-05-06 20:51:48,581 - INFO - [group_6] Successfully loaded best parameters from best_params\group_6_best_params.json
2025-05-06 20:51:48,581 - INFO - [group_6] Cleaning data...
2025-05-06 20:51:48,581 - INFO - Original dataset size: (27388, 136)
2025-05-06 20:51:48,593 - INFO - Dataset size after dropping NaNs: (27388, 70)
2025-05-06 20:51:48,593 - INFO - Value counts for target:
1 (Star): 1926
0 (Galaxy): 25462
2025-05-06 20:51:48,601 - INFO - [group_6] Splitting data (Train/Val/Test/Cal)...
2025-05-06 20:51:48,601 - INFO - Splitting data using 'stratified' strategy...
2025-05-06 20:51:48,601 - INFO - Target split ratios: Train=0.60, Val=0.10, Test=0.20, Cal=0.10
2025-05-06 20:51:48,617 - INFO - Train set shape: (16432, 69)
2025-05-06 20:51:48,617 - INFO - Validation set shape: (2738, 69)
2025-05-06 20:51:48,626 - INFO - Test set shape: (5478, 69)
2025-05-06 20:51:48,626 - INFO - Calibration set shape: (2740, 69)
2025-05-06 20:51:48,626 - INFO - Split lengths verification successful.
2025-05-06 20:51:48,626 - INFO - Data splitting complete.
2025-05-06 20:51:48,626 - INFO - Train target distribution:
acs_mu_class
0    0.929649
1    0.070351
Name: count, dtype: float64
2025-05-06 20:51:48,627 - INFO - Train target counts:
acs_mu_class
0    15276
1     1156
Name: count, dtype: int64
2025-05-06 20:51:48,627 - INFO - Validation target distribution:
acs_mu_class
0    0.929876
1    0.070124
Name: count, dtype: float64
2025-05-06 20:51:48,627 - INFO - Validation target counts:
acs_mu_class
0    2546
1     192
Name: count, dtype: int64
2025-05-06 20:51:48,627 - INFO - Test target distribution:
acs_mu_class
0    0.929719
1    0.070281
Name: count, dtype: float64
2025-05-06 20:51:48,627 - INFO - Test target counts:
acs_mu_class
0    5093
1     385
Name: count, dtype: int64
2025-05-06 20:51:48,628 - INFO - Calibration target distribution:
acs_mu_class
0    0.929562
1    0.070438
Name: count, dtype: float64
2025-05-06 20:51:48,628 - INFO - Calibration target counts:
acs_mu_class
0    2547
1     193
Name: count, dtype: int64
2025-05-06 20:51:48,629 - INFO - [group_6] Applying feature scaling (for SVM)...
2025-05-06 20:51:48,645 - INFO - Scaler loaded from trained_models\scaler_group_6.joblib
2025-05-06 20:51:48,655 - INFO - Feature scaling complete.
2025-05-06 20:51:48,655 - INFO - --- [group_6] Running SVM Workflow ---
2025-05-06 20:51:48,655 - INFO - 

===== Starting Workflow for SVM (group_6) =====
2025-05-06 20:51:48,655 - INFO - --- [SVM] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:51:48,655 - INFO - --- [SVM] Training final model & calibrator (platt) ---
2025-05-06 20:51:48,655 - INFO - --- Preparing Model Training & Calibration (platt) for SVM (group_6) ---
2025-05-06 20:51:48,655 - INFO - --- [SVM] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_6\SVM_group_6_platt.joblib. Proceeding with training. ---
2025-05-06 20:51:48,655 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:51:48,655 - WARNING - Setting probability=True for SVC as required by calibration setup.
2025-05-06 20:51:48,655 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:51:48,655 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:51:57,556 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:51:57,556 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:51:57,568 - INFO - --- [SVM] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_6\SVM_group_6_platt.joblib ---
2025-05-06 20:51:57,568 - INFO - --- [SVM] Training & Calibration with platt finished in 8.91 seconds ---
2025-05-06 20:51:57,569 - INFO - --- [SVM] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:51:57,874 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:51:57,874 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:51:57,874 - INFO - --- [SVM] Mondrian CP calibration finished in 0.31 seconds ---
2025-05-06 20:51:57,874 - INFO - --- [SVM] Final Evaluation on Test Set ---
2025-05-06 20:51:58,482 - INFO - --- SVM Metrics ---
2025-05-06 20:51:58,483 - INFO - Accuracy: 0.9356
2025-05-06 20:51:58,483 - INFO - Precision: 0.9444
2025-05-06 20:51:58,483 - INFO - Recall (TPR): 0.0883
2025-05-06 20:51:58,483 - INFO - Specificity (TNR): 0.9996
2025-05-06 20:51:58,483 - INFO - F1-Score: 0.1615
2025-05-06 20:51:58,483 - INFO - G-Mean: 0.2971
2025-05-06 20:51:58,483 - INFO - ROC AUC: 0.8292
2025-05-06 20:51:58,483 - INFO - PR AUC: 0.5915
2025-05-06 20:51:58,483 - INFO - Brier Score: 0.0573
2025-05-06 20:51:58,483 - INFO - Confusion Matrix (TN, FP, FN, TP): (5091, 2, 351, 34)
2025-05-06 20:51:58,483 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:51:58,611 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:51:58,611 - INFO - Mondrian CP Coverage for class 1: 0.2909
2025-05-06 20:51:58,611 - INFO - Mondrian CP Coverage: 0.9502
2025-05-06 20:51:58,611 - INFO - Mondrian CP Avg Set Size: 1.2099
2025-05-06 20:51:58,611 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:51:58,611 - INFO - --- [SVM] Mondrian CP evaluation finished in 0.13 seconds ---
2025-05-06 20:51:58,611 - INFO - --- [SVM] Total Evaluation finished in 0.74 seconds ---
2025-05-06 20:51:58,611 - INFO - ===== Finished Workflow for SVM (group_6) =====
2025-05-06 20:51:58,611 - INFO - --- [group_6] Running CART Workflow ---
2025-05-06 20:51:58,611 - INFO - 

===== Starting Workflow for CART (group_6) =====
2025-05-06 20:51:58,611 - INFO - --- [CART] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:51:58,611 - INFO - --- [CART] Training final model & calibrator (platt) ---
2025-05-06 20:51:58,611 - INFO - --- Preparing Model Training & Calibration (platt) for CART (group_6) ---
2025-05-06 20:51:58,611 - INFO - --- [CART] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_6\CART_group_6_platt.joblib. Proceeding with training. ---
2025-05-06 20:51:58,611 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:51:58,611 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:51:58,611 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:51:58,991 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:51:58,991 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:51:58,993 - INFO - --- [CART] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_6\CART_group_6_platt.joblib ---
2025-05-06 20:51:58,993 - INFO - --- [CART] Training & Calibration with platt finished in 0.38 seconds ---
2025-05-06 20:51:58,993 - INFO - --- [CART] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:51:59,002 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:51:59,002 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:51:59,002 - INFO - --- [CART] Mondrian CP calibration finished in 0.01 seconds ---
2025-05-06 20:51:59,002 - INFO - --- [CART] Final Evaluation on Test Set ---
2025-05-06 20:51:59,013 - INFO - [CART] Calibrated test probabilities for class 1 (sample): [0.01014226 0.65922877 0.01182445 0.2143777  0.00796995 0.17584577
 0.15317285 0.00573428 0.01182445 0.01406012 0.01182445 0.132736
 0.00796995 0.00573428 0.00573428 0.65922877 0.01014226 0.52965864
 0.12889579 0.01182445]
2025-05-06 20:51:59,013 - INFO - [CART] Calibrated test probabilities range: min=0.0050, max=0.6592, mean=0.0708
2025-05-06 20:51:59,013 - INFO - --- CART Metrics ---
2025-05-06 20:51:59,013 - INFO - Accuracy: 0.9664
2025-05-06 20:51:59,013 - INFO - Precision: 0.8821
2025-05-06 20:51:59,013 - INFO - Recall (TPR): 0.6026
2025-05-06 20:51:59,013 - INFO - Specificity (TNR): 0.9939
2025-05-06 20:51:59,013 - INFO - F1-Score: 0.7160
2025-05-06 20:51:59,013 - INFO - G-Mean: 0.7739
2025-05-06 20:51:59,013 - INFO - ROC AUC: 0.9309
2025-05-06 20:51:59,013 - INFO - PR AUC: 0.7464
2025-05-06 20:51:59,013 - INFO - Brier Score: 0.0333
2025-05-06 20:51:59,013 - INFO - Confusion Matrix (TN, FP, FN, TP): (5062, 31, 153, 232)
2025-05-06 20:51:59,013 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:51:59,150 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:51:59,150 - INFO - Mondrian CP Coverage for class 1: 0.6468
2025-05-06 20:51:59,150 - INFO - Mondrian CP Coverage: 0.9752
2025-05-06 20:51:59,150 - INFO - Mondrian CP Avg Set Size: 1.1888
2025-05-06 20:51:59,150 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:51:59,150 - INFO - --- [CART] Mondrian CP evaluation finished in 0.14 seconds ---
2025-05-06 20:51:59,150 - INFO - --- [CART] Total Evaluation finished in 0.15 seconds ---
2025-05-06 20:51:59,150 - INFO - ===== Finished Workflow for CART (group_6) =====
2025-05-06 20:51:59,150 - INFO - --- [group_6] Running Random Forest Workflow ---
2025-05-06 20:51:59,150 - INFO - 

===== Starting Workflow for Random_Forest (group_6) =====
2025-05-06 20:51:59,150 - INFO - --- [Random_Forest] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:51:59,150 - INFO - --- [Random_Forest] Training final model & calibrator (platt) ---
2025-05-06 20:51:59,150 - INFO - --- Preparing Model Training & Calibration (platt) for Random_Forest (group_6) ---
2025-05-06 20:51:59,150 - INFO - --- [Random_Forest] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_6\Random_Forest_group_6_platt.joblib. Proceeding with training. ---
2025-05-06 20:51:59,150 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:51:59,150 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:51:59,150 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:52:14,194 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:52:14,194 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:52:14,350 - INFO - --- [Random_Forest] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_6\Random_Forest_group_6_platt.joblib ---
2025-05-06 20:52:14,350 - INFO - --- [Random_Forest] Calibration with platt finished in 15.20 seconds ---
2025-05-06 20:52:14,350 - INFO - --- [Random_Forest] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:52:14,495 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:52:14,495 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:52:14,495 - INFO - --- [Random_Forest] Mondrian CP calibration finished in 0.15 seconds ---
2025-05-06 20:52:14,495 - INFO - --- [Random_Forest] Final Evaluation on Test Set ---
2025-05-06 20:52:14,635 - INFO - --- Random_Forest Metrics ---
2025-05-06 20:52:14,635 - INFO - Accuracy: 0.9723
2025-05-06 20:52:14,635 - INFO - Precision: 0.9299
2025-05-06 20:52:14,635 - INFO - Recall (TPR): 0.6545
2025-05-06 20:52:14,635 - INFO - Specificity (TNR): 0.9963
2025-05-06 20:52:14,635 - INFO - F1-Score: 0.7683
2025-05-06 20:52:14,635 - INFO - G-Mean: 0.8075
2025-05-06 20:52:14,635 - INFO - ROC AUC: 0.9540
2025-05-06 20:52:14,635 - INFO - PR AUC: 0.8224
2025-05-06 20:52:14,635 - INFO - Brier Score: 0.0237
2025-05-06 20:52:14,635 - INFO - Confusion Matrix (TN, FP, FN, TP): (5074, 19, 133, 252)
2025-05-06 20:52:14,635 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:52:14,813 - INFO - Mondrian CP Coverage for class 0: 0.9996
2025-05-06 20:52:14,813 - INFO - Mondrian CP Coverage for class 1: 0.7714
2025-05-06 20:52:14,813 - INFO - Mondrian CP Coverage: 0.9836
2025-05-06 20:52:14,813 - INFO - Mondrian CP Avg Set Size: 1.1908
2025-05-06 20:52:14,813 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:52:14,813 - INFO - --- [Random_Forest] Mondrian CP evaluation finished in 0.18 seconds ---
2025-05-06 20:52:14,813 - INFO - --- [Random_Forest] Total Evaluation finished in 0.32 seconds ---
2025-05-06 20:52:14,813 - INFO - ===== Finished Workflow for Random_Forest (group_6) =====
2025-05-06 20:52:14,817 - INFO - --- [group_6] Running XGBoost Workflow ---
2025-05-06 20:52:14,817 - INFO - 

===== Starting Workflow for XGBoost =====
2025-05-06 20:52:14,817 - INFO - --- [XGBoost] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:52:14,817 - INFO - --- [XGBoost] Determining best iteration and training calibrator ---
2025-05-06 20:52:14,817 - INFO - Training temporary XGBoost with early stopping to find best iteration...
2025-05-06 20:52:15,713 - INFO - Best iteration found: 88
2025-05-06 20:52:15,713 - INFO - --- [XGBoost] Training final model (88 est.) and calibrator ---
2025-05-06 20:52:15,713 - INFO - --- Preparing Model Training & Calibration (platt) for XGBoost (group_6) ---
2025-05-06 20:52:15,713 - INFO - --- [XGBoost] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_6\XGBoost_group_6_platt.joblib. Proceeding with training. ---
2025-05-06 20:52:15,713 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:52:15,720 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:52:15,720 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:52:19,531 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:52:19,531 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:52:19,549 - INFO - --- [XGBoost] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_6\XGBoost_group_6_platt.joblib ---
2025-05-06 20:52:19,549 - INFO - --- [XGBoost] Calibration with platt finished in 4.73 seconds ---
2025-05-06 20:52:19,549 - INFO - --- [XGBoost] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:52:19,572 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:52:19,573 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:52:19,573 - INFO - --- [XGBoost] Mondrian CP calibration finished in 0.02 seconds ---
2025-05-06 20:52:19,573 - INFO - --- [XGBoost] Final Evaluation on Test Set ---
2025-05-06 20:52:19,600 - INFO - --- XGBoost Metrics ---
2025-05-06 20:52:19,600 - INFO - Accuracy: 0.9737
2025-05-06 20:52:19,600 - INFO - Precision: 0.9350
2025-05-06 20:52:19,600 - INFO - Recall (TPR): 0.6727
2025-05-06 20:52:19,600 - INFO - Specificity (TNR): 0.9965
2025-05-06 20:52:19,600 - INFO - F1-Score: 0.7825
2025-05-06 20:52:19,600 - INFO - G-Mean: 0.8187
2025-05-06 20:52:19,600 - INFO - ROC AUC: 0.9570
2025-05-06 20:52:19,600 - INFO - PR AUC: 0.8279
2025-05-06 20:52:19,600 - INFO - Brier Score: 0.0230
2025-05-06 20:52:19,600 - INFO - Confusion Matrix (TN, FP, FN, TP): (5075, 18, 126, 259)
2025-05-06 20:52:19,600 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:52:19,764 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:52:19,764 - INFO - Mondrian CP Coverage for class 1: 0.7844
2025-05-06 20:52:19,764 - INFO - Mondrian CP Coverage: 0.9848
2025-05-06 20:52:19,764 - INFO - Mondrian CP Avg Set Size: 1.2004
2025-05-06 20:52:19,764 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:52:19,764 - INFO - --- [XGBoost] Mondrian CP evaluation finished in 0.16 seconds ---
2025-05-06 20:52:19,764 - INFO - --- [XGBoost] Total Evaluation finished in 0.19 seconds ---
2025-05-06 20:52:19,764 - INFO - ===== Finished Workflow for XGBoost =====
2025-05-06 20:52:19,764 - INFO - --- [group_6] Running LightGBM Workflow ---
2025-05-06 20:52:19,764 - INFO - 

===== Starting Workflow for LightGBM =====
2025-05-06 20:52:19,764 - INFO - --- [LightGBM] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:52:19,764 - INFO - --- [LightGBM] Determining best iteration and training calibrator ---
2025-05-06 20:52:19,764 - INFO - Training temporary LightGBM with early stopping (monitoring 'logloss') to find best iteration...
2025-05-06 20:52:19,926 - INFO - Best iteration found: 100
2025-05-06 20:52:19,926 - INFO - --- [LightGBM] Training final model (100 est.) and calibrator ---
2025-05-06 20:52:19,926 - INFO - --- Preparing Model Training & Calibration (platt) for LightGBM (group_6) ---
2025-05-06 20:52:19,926 - INFO - --- [LightGBM] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_6\LightGBM_group_6_platt.joblib. Proceeding with training. ---
2025-05-06 20:52:19,926 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:52:19,929 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:52:19,929 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:52:20,978 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:52:20,978 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:52:20,998 - INFO - --- [LightGBM] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_6\LightGBM_group_6_platt.joblib ---
2025-05-06 20:52:20,998 - INFO - --- [LightGBM] Calibration finished in 1.23 seconds ---
2025-05-06 20:52:20,998 - INFO - --- [LightGBM] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:52:21,010 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:52:21,010 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:52:21,010 - INFO - --- [LightGBM] Mondrian CP calibration finished in 0.01 seconds ---
2025-05-06 20:52:21,010 - INFO - --- [LightGBM] Final Evaluation on Test Set ---
2025-05-06 20:52:21,052 - INFO - --- LightGBM Metrics ---
2025-05-06 20:52:21,052 - INFO - Accuracy: 0.9741
2025-05-06 20:52:21,052 - INFO - Precision: 0.9175
2025-05-06 20:52:21,052 - INFO - Recall (TPR): 0.6935
2025-05-06 20:52:21,052 - INFO - Specificity (TNR): 0.9953
2025-05-06 20:52:21,052 - INFO - F1-Score: 0.7899
2025-05-06 20:52:21,052 - INFO - G-Mean: 0.8308
2025-05-06 20:52:21,052 - INFO - ROC AUC: 0.9566
2025-05-06 20:52:21,052 - INFO - PR AUC: 0.8288
2025-05-06 20:52:21,052 - INFO - Brier Score: 0.0228
2025-05-06 20:52:21,052 - INFO - Confusion Matrix (TN, FP, FN, TP): (5069, 24, 118, 267)
2025-05-06 20:52:21,052 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:52:21,223 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:52:21,223 - INFO - Mondrian CP Coverage for class 1: 0.7740
2025-05-06 20:52:21,223 - INFO - Mondrian CP Coverage: 0.9841
2025-05-06 20:52:21,223 - INFO - Mondrian CP Avg Set Size: 1.1975
2025-05-06 20:52:21,223 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:52:21,223 - INFO - --- [LightGBM] Mondrian CP evaluation finished in 0.17 seconds ---
2025-05-06 20:52:21,223 - INFO - --- [LightGBM] Total Evaluation finished in 0.21 seconds ---
2025-05-06 20:52:21,223 - INFO - ===== Finished Workflow for LightGBM =====
2025-05-06 20:52:21,224 - INFO - --- Finished processing Feature Group: group_6 in 32.64 seconds ---
2025-05-06 20:52:21,224 - INFO - 
============================== Processing Feature Group: group_7 ==============================
2025-05-06 20:52:21,235 - INFO - [group_7] Successfully loaded best parameters from best_params\group_7_best_params.json
2025-05-06 20:52:21,235 - INFO - [group_7] Cleaning data...
2025-05-06 20:52:21,235 - INFO - Original dataset size: (27388, 136)
2025-05-06 20:52:21,260 - INFO - Dataset size after dropping NaNs: (27388, 95)
2025-05-06 20:52:21,260 - INFO - Value counts for target:
1 (Star): 1926
0 (Galaxy): 25462
2025-05-06 20:52:21,265 - INFO - [group_7] Splitting data (Train/Val/Test/Cal)...
2025-05-06 20:52:21,265 - INFO - Splitting data using 'stratified' strategy...
2025-05-06 20:52:21,266 - INFO - Target split ratios: Train=0.60, Val=0.10, Test=0.20, Cal=0.10
2025-05-06 20:52:21,281 - INFO - Train set shape: (16432, 94)
2025-05-06 20:52:21,284 - INFO - Validation set shape: (2738, 94)
2025-05-06 20:52:21,293 - INFO - Test set shape: (5478, 94)
2025-05-06 20:52:21,293 - INFO - Calibration set shape: (2740, 94)
2025-05-06 20:52:21,293 - INFO - Split lengths verification successful.
2025-05-06 20:52:21,293 - INFO - Data splitting complete.
2025-05-06 20:52:21,293 - INFO - Train target distribution:
acs_mu_class
0    0.929649
1    0.070351
Name: count, dtype: float64
2025-05-06 20:52:21,294 - INFO - Train target counts:
acs_mu_class
0    15276
1     1156
Name: count, dtype: int64
2025-05-06 20:52:21,294 - INFO - Validation target distribution:
acs_mu_class
0    0.929876
1    0.070124
Name: count, dtype: float64
2025-05-06 20:52:21,294 - INFO - Validation target counts:
acs_mu_class
0    2546
1     192
Name: count, dtype: int64
2025-05-06 20:52:21,294 - INFO - Test target distribution:
acs_mu_class
0    0.929719
1    0.070281
Name: count, dtype: float64
2025-05-06 20:52:21,294 - INFO - Test target counts:
acs_mu_class
0    5093
1     385
Name: count, dtype: int64
2025-05-06 20:52:21,295 - INFO - Calibration target distribution:
acs_mu_class
0    0.929562
1    0.070438
Name: count, dtype: float64
2025-05-06 20:52:21,295 - INFO - Calibration target counts:
acs_mu_class
0    2547
1     193
Name: count, dtype: int64
2025-05-06 20:52:21,296 - INFO - [group_7] Applying feature scaling (for SVM)...
2025-05-06 20:52:21,313 - INFO - Scaler loaded from trained_models\scaler_group_7.joblib
2025-05-06 20:52:21,332 - INFO - Feature scaling complete.
2025-05-06 20:52:21,332 - INFO - --- [group_7] Running SVM Workflow ---
2025-05-06 20:52:21,332 - INFO - 

===== Starting Workflow for SVM (group_7) =====
2025-05-06 20:52:21,332 - INFO - --- [SVM] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:52:21,332 - INFO - --- [SVM] Training final model & calibrator (platt) ---
2025-05-06 20:52:21,332 - INFO - --- Preparing Model Training & Calibration (platt) for SVM (group_7) ---
2025-05-06 20:52:21,332 - INFO - --- [SVM] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_7\SVM_group_7_platt.joblib. Proceeding with training. ---
2025-05-06 20:52:21,332 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:52:21,332 - WARNING - Setting probability=True for SVC as required by calibration setup.
2025-05-06 20:52:21,332 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:52:21,332 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:52:41,095 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:52:41,095 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:52:41,101 - INFO - --- [SVM] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_7\SVM_group_7_platt.joblib ---
2025-05-06 20:52:41,101 - INFO - --- [SVM] Training & Calibration with platt finished in 19.77 seconds ---
2025-05-06 20:52:41,101 - INFO - --- [SVM] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:52:41,404 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:52:41,404 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:52:41,404 - INFO - --- [SVM] Mondrian CP calibration finished in 0.30 seconds ---
2025-05-06 20:52:41,404 - INFO - --- [SVM] Final Evaluation on Test Set ---
2025-05-06 20:52:41,999 - INFO - --- SVM Metrics ---
2025-05-06 20:52:41,999 - INFO - Accuracy: 0.9476
2025-05-06 20:52:41,999 - INFO - Precision: 0.9298
2025-05-06 20:52:41,999 - INFO - Recall (TPR): 0.2753
2025-05-06 20:52:41,999 - INFO - Specificity (TNR): 0.9984
2025-05-06 20:52:41,999 - INFO - F1-Score: 0.4248
2025-05-06 20:52:41,999 - INFO - G-Mean: 0.5243
2025-05-06 20:52:41,999 - INFO - ROC AUC: 0.8732
2025-05-06 20:52:41,999 - INFO - PR AUC: 0.6677
2025-05-06 20:52:41,999 - INFO - Brier Score: 0.0411
2025-05-06 20:52:41,999 - INFO - Confusion Matrix (TN, FP, FN, TP): (5085, 8, 279, 106)
2025-05-06 20:52:41,999 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:52:42,133 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:52:42,133 - INFO - Mondrian CP Coverage for class 1: 0.3818
2025-05-06 20:52:42,133 - INFO - Mondrian CP Coverage: 0.9566
2025-05-06 20:52:42,133 - INFO - Mondrian CP Avg Set Size: 1.1944
2025-05-06 20:52:42,133 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:52:42,133 - INFO - --- [SVM] Mondrian CP evaluation finished in 0.13 seconds ---
2025-05-06 20:52:42,133 - INFO - --- [SVM] Total Evaluation finished in 0.73 seconds ---
2025-05-06 20:52:42,133 - INFO - ===== Finished Workflow for SVM (group_7) =====
2025-05-06 20:52:42,133 - INFO - --- [group_7] Running CART Workflow ---
2025-05-06 20:52:42,133 - INFO - 

===== Starting Workflow for CART (group_7) =====
2025-05-06 20:52:42,133 - INFO - --- [CART] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:52:42,133 - INFO - --- [CART] Training final model & calibrator (platt) ---
2025-05-06 20:52:42,133 - INFO - --- Preparing Model Training & Calibration (platt) for CART (group_7) ---
2025-05-06 20:52:42,133 - INFO - --- [CART] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_7\CART_group_7_platt.joblib. Proceeding with training. ---
2025-05-06 20:52:42,133 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:52:42,137 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:52:42,137 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:52:42,544 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:52:42,544 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:52:42,547 - INFO - --- [CART] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_7\CART_group_7_platt.joblib ---
2025-05-06 20:52:42,548 - INFO - --- [CART] Training & Calibration with platt finished in 0.42 seconds ---
2025-05-06 20:52:42,548 - INFO - --- [CART] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:52:42,550 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:52:42,550 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:52:42,550 - INFO - --- [CART] Mondrian CP calibration finished in 0.00 seconds ---
2025-05-06 20:52:42,550 - INFO - --- [CART] Final Evaluation on Test Set ---
2025-05-06 20:52:42,570 - INFO - [CART] Calibrated test probabilities for class 1 (sample): [0.01014114 0.65834683 0.01181764 0.21441699 0.0079819  0.17554011
 0.15291513 0.00573846 0.01181764 0.01406108 0.01181764 0.13252515
 0.0079819  0.00573846 0.00573846 0.65834683 0.01014114 0.52880583
 0.12863807 0.01181764]
2025-05-06 20:52:42,570 - INFO - [CART] Calibrated test probabilities range: min=0.0050, max=0.6583, mean=0.0708
2025-05-06 20:52:42,574 - INFO - --- CART Metrics ---
2025-05-06 20:52:42,574 - INFO - Accuracy: 0.9664
2025-05-06 20:52:42,574 - INFO - Precision: 0.8821
2025-05-06 20:52:42,574 - INFO - Recall (TPR): 0.6026
2025-05-06 20:52:42,574 - INFO - Specificity (TNR): 0.9939
2025-05-06 20:52:42,574 - INFO - F1-Score: 0.7160
2025-05-06 20:52:42,574 - INFO - G-Mean: 0.7739
2025-05-06 20:52:42,574 - INFO - ROC AUC: 0.9318
2025-05-06 20:52:42,574 - INFO - PR AUC: 0.7469
2025-05-06 20:52:42,574 - INFO - Brier Score: 0.0333
2025-05-06 20:52:42,574 - INFO - Confusion Matrix (TN, FP, FN, TP): (5062, 31, 153, 232)
2025-05-06 20:52:42,574 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:52:42,707 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:52:42,707 - INFO - Mondrian CP Coverage for class 1: 0.6468
2025-05-06 20:52:42,707 - INFO - Mondrian CP Coverage: 0.9752
2025-05-06 20:52:42,707 - INFO - Mondrian CP Avg Set Size: 1.1884
2025-05-06 20:52:42,707 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:52:42,707 - INFO - --- [CART] Mondrian CP evaluation finished in 0.13 seconds ---
2025-05-06 20:52:42,707 - INFO - --- [CART] Total Evaluation finished in 0.16 seconds ---
2025-05-06 20:52:42,707 - INFO - ===== Finished Workflow for CART (group_7) =====
2025-05-06 20:52:42,707 - INFO - --- [group_7] Running Random Forest Workflow ---
2025-05-06 20:52:42,707 - INFO - 

===== Starting Workflow for Random_Forest (group_7) =====
2025-05-06 20:52:42,707 - INFO - --- [Random_Forest] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:52:42,707 - INFO - --- [Random_Forest] Training final model & calibrator (platt) ---
2025-05-06 20:52:42,707 - INFO - --- Preparing Model Training & Calibration (platt) for Random_Forest (group_7) ---
2025-05-06 20:52:42,707 - INFO - --- [Random_Forest] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_7\Random_Forest_group_7_platt.joblib. Proceeding with training. ---
2025-05-06 20:52:42,707 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:52:42,710 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:52:42,710 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:52:58,673 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:52:58,673 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:52:58,780 - INFO - --- [Random_Forest] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_7\Random_Forest_group_7_platt.joblib ---
2025-05-06 20:52:58,780 - INFO - --- [Random_Forest] Calibration with platt finished in 16.07 seconds ---
2025-05-06 20:52:58,780 - INFO - --- [Random_Forest] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:52:58,922 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:52:58,922 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:52:58,922 - INFO - --- [Random_Forest] Mondrian CP calibration finished in 0.14 seconds ---
2025-05-06 20:52:58,923 - INFO - --- [Random_Forest] Final Evaluation on Test Set ---
2025-05-06 20:52:59,070 - INFO - --- Random_Forest Metrics ---
2025-05-06 20:52:59,070 - INFO - Accuracy: 0.9728
2025-05-06 20:52:59,070 - INFO - Precision: 0.9338
2025-05-06 20:52:59,070 - INFO - Recall (TPR): 0.6597
2025-05-06 20:52:59,070 - INFO - Specificity (TNR): 0.9965
2025-05-06 20:52:59,070 - INFO - F1-Score: 0.7732
2025-05-06 20:52:59,070 - INFO - G-Mean: 0.8108
2025-05-06 20:52:59,070 - INFO - ROC AUC: 0.9526
2025-05-06 20:52:59,070 - INFO - PR AUC: 0.8191
2025-05-06 20:52:59,070 - INFO - Brier Score: 0.0238
2025-05-06 20:52:59,070 - INFO - Confusion Matrix (TN, FP, FN, TP): (5075, 18, 131, 254)
2025-05-06 20:52:59,070 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:52:59,250 - INFO - Mondrian CP Coverage for class 0: 0.9996
2025-05-06 20:52:59,250 - INFO - Mondrian CP Coverage for class 1: 0.7688
2025-05-06 20:52:59,250 - INFO - Mondrian CP Coverage: 0.9834
2025-05-06 20:52:59,250 - INFO - Mondrian CP Avg Set Size: 1.1946
2025-05-06 20:52:59,250 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:52:59,250 - INFO - --- [Random_Forest] Mondrian CP evaluation finished in 0.18 seconds ---
2025-05-06 20:52:59,250 - INFO - --- [Random_Forest] Total Evaluation finished in 0.33 seconds ---
2025-05-06 20:52:59,250 - INFO - ===== Finished Workflow for Random_Forest (group_7) =====
2025-05-06 20:52:59,254 - INFO - --- [group_7] Running XGBoost Workflow ---
2025-05-06 20:52:59,254 - INFO - 

===== Starting Workflow for XGBoost =====
2025-05-06 20:52:59,254 - INFO - --- [XGBoost] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:52:59,254 - INFO - --- [XGBoost] Determining best iteration and training calibrator ---
2025-05-06 20:52:59,254 - INFO - Training temporary XGBoost with early stopping to find best iteration...
2025-05-06 20:52:59,852 - INFO - Best iteration found: 99
2025-05-06 20:52:59,852 - INFO - --- [XGBoost] Training final model (99 est.) and calibrator ---
2025-05-06 20:52:59,852 - INFO - --- Preparing Model Training & Calibration (platt) for XGBoost (group_7) ---
2025-05-06 20:52:59,852 - INFO - --- [XGBoost] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_7\XGBoost_group_7_platt.joblib. Proceeding with training. ---
2025-05-06 20:52:59,852 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:52:59,858 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:52:59,858 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:53:01,774 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:53:01,774 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:53:01,790 - INFO - --- [XGBoost] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_7\XGBoost_group_7_platt.joblib ---
2025-05-06 20:53:01,791 - INFO - --- [XGBoost] Calibration with platt finished in 2.54 seconds ---
2025-05-06 20:53:01,791 - INFO - --- [XGBoost] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:53:01,809 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:53:01,809 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:53:01,809 - INFO - --- [XGBoost] Mondrian CP calibration finished in 0.02 seconds ---
2025-05-06 20:53:01,809 - INFO - --- [XGBoost] Final Evaluation on Test Set ---
2025-05-06 20:53:01,849 - INFO - --- XGBoost Metrics ---
2025-05-06 20:53:01,849 - INFO - Accuracy: 0.9730
2025-05-06 20:53:01,849 - INFO - Precision: 0.9017
2025-05-06 20:53:01,849 - INFO - Recall (TPR): 0.6909
2025-05-06 20:53:01,849 - INFO - Specificity (TNR): 0.9943
2025-05-06 20:53:01,849 - INFO - F1-Score: 0.7824
2025-05-06 20:53:01,849 - INFO - G-Mean: 0.8288
2025-05-06 20:53:01,849 - INFO - ROC AUC: 0.9578
2025-05-06 20:53:01,849 - INFO - PR AUC: 0.8295
2025-05-06 20:53:01,849 - INFO - Brier Score: 0.0228
2025-05-06 20:53:01,849 - INFO - Confusion Matrix (TN, FP, FN, TP): (5064, 29, 119, 266)
2025-05-06 20:53:01,849 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:53:02,010 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:53:02,010 - INFO - Mondrian CP Coverage for class 1: 0.7948
2025-05-06 20:53:02,010 - INFO - Mondrian CP Coverage: 0.9856
2025-05-06 20:53:02,010 - INFO - Mondrian CP Avg Set Size: 1.1990
2025-05-06 20:53:02,010 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:53:02,010 - INFO - --- [XGBoost] Mondrian CP evaluation finished in 0.16 seconds ---
2025-05-06 20:53:02,010 - INFO - --- [XGBoost] Total Evaluation finished in 0.20 seconds ---
2025-05-06 20:53:02,010 - INFO - ===== Finished Workflow for XGBoost =====
2025-05-06 20:53:02,010 - INFO - --- [group_7] Running LightGBM Workflow ---
2025-05-06 20:53:02,010 - INFO - 

===== Starting Workflow for LightGBM =====
2025-05-06 20:53:02,010 - INFO - --- [LightGBM] Using provided hyperparameters, skipping HPO. ---
2025-05-06 20:53:02,010 - INFO - --- [LightGBM] Determining best iteration and training calibrator ---
2025-05-06 20:53:02,010 - INFO - Training temporary LightGBM with early stopping (monitoring 'logloss') to find best iteration...
2025-05-06 20:53:02,483 - INFO - Best iteration found: 46
2025-05-06 20:53:02,483 - INFO - --- [LightGBM] Training final model (46 est.) and calibrator ---
2025-05-06 20:53:02,483 - INFO - --- Preparing Model Training & Calibration (platt) for LightGBM (group_7) ---
2025-05-06 20:53:02,483 - INFO - --- [LightGBM] Predictor save file not found at c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_7\LightGBM_group_7_platt.joblib. Proceeding with training. ---
2025-05-06 20:53:02,483 - INFO - --- Starting Model Training & Calibration (platt) ---
2025-05-06 20:53:02,483 - INFO - Using CalibratedClassifierCV with method='sigmoid'
2025-05-06 20:53:02,483 - INFO - Fitting CalibratedClassifierCV...
2025-05-06 20:53:04,205 - INFO - CalibratedClassifierCV fitting complete.
2025-05-06 20:53:04,205 - INFO - --- Platt Calibration Training Complete ---
2025-05-06 20:53:04,223 - INFO - --- [LightGBM] Model with calibrator saved successfully to c:\Users\javym\Documents\Github\TFGs\Fisica\ML-for-star-galaxy-classification\trained_models\group_7\LightGBM_group_7_platt.joblib ---
2025-05-06 20:53:04,224 - INFO - --- [LightGBM] Calibration finished in 2.21 seconds ---
2025-05-06 20:53:04,224 - INFO - --- [LightGBM] Calibrating Mondrian Conformal Prediction ---
2025-05-06 20:53:04,242 - INFO - --- Fitting Mondrian Conformal Classifier ---
2025-05-06 20:53:04,242 - INFO - --- Mondrian Conformal Classifier Fitted ---
2025-05-06 20:53:04,242 - INFO - --- [LightGBM] Mondrian CP calibration finished in 0.02 seconds ---
2025-05-06 20:53:04,242 - INFO - --- [LightGBM] Final Evaluation on Test Set ---
2025-05-06 20:53:04,270 - INFO - --- LightGBM Metrics ---
2025-05-06 20:53:04,270 - INFO - Accuracy: 0.9728
2025-05-06 20:53:04,270 - INFO - Precision: 0.9436
2025-05-06 20:53:04,270 - INFO - Recall (TPR): 0.6519
2025-05-06 20:53:04,270 - INFO - Specificity (TNR): 0.9971
2025-05-06 20:53:04,270 - INFO - F1-Score: 0.7711
2025-05-06 20:53:04,270 - INFO - G-Mean: 0.8062
2025-05-06 20:53:04,270 - INFO - ROC AUC: 0.9539
2025-05-06 20:53:04,270 - INFO - PR AUC: 0.8188
2025-05-06 20:53:04,270 - INFO - Brier Score: 0.0236
2025-05-06 20:53:04,270 - INFO - Confusion Matrix (TN, FP, FN, TP): (5078, 15, 134, 251)
2025-05-06 20:53:04,270 - INFO - --- Evaluating Mondrian Prediction (alpha=0.8) ---
2025-05-06 20:53:04,444 - INFO - Mondrian CP Coverage for class 0: 1.0000
2025-05-06 20:53:04,444 - INFO - Mondrian CP Coverage for class 1: 0.7610
2025-05-06 20:53:04,444 - INFO - Mondrian CP Coverage: 0.9832
2025-05-06 20:53:04,444 - INFO - Mondrian CP Avg Set Size: 1.1979
2025-05-06 20:53:04,444 - INFO - --- Mondrian Prediction Evaluation Complete ---
2025-05-06 20:53:04,444 - INFO - --- [LightGBM] Mondrian CP evaluation finished in 0.17 seconds ---
2025-05-06 20:53:04,444 - INFO - --- [LightGBM] Total Evaluation finished in 0.20 seconds ---
2025-05-06 20:53:04,444 - INFO - ===== Finished Workflow for LightGBM =====
2025-05-06 20:53:04,444 - INFO - --- Finished processing Feature Group: group_7 in 43.22 seconds ---
2025-05-06 20:53:04,445 - INFO - 
============================== Finished processing all groups in 3289.61 seconds ==============================
2025-05-06 20:53:04,470 - INFO - Successfully saved all group results to results\all_group_results_20250506_195814.json
2025-05-06 20:54:21,312 - INFO - Results summary DataFrame saved to .\model_comparison_summary_all_groups_20250506_205421.csv
2025-05-06 20:54:21,312 - WARNING - Plotting code for CP set types is commented out and may need adaptation for multi-group data.
